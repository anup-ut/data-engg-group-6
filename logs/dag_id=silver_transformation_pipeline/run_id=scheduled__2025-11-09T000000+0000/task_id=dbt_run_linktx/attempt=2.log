[2025-11-28T13:47:37.030+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_linktx scheduled__2025-11-09T00:00:00+00:00 [queued]>
[2025-11-28T13:47:37.288+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_linktx scheduled__2025-11-09T00:00:00+00:00 [queued]>
[2025-11-28T13:47:37.290+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-11-28T13:47:37.569+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): dbt_run_linktx> on 2025-11-09 00:00:00+00:00
[2025-11-28T13:47:37.608+0000] {standard_task_runner.py:60} INFO - Started process 301 to run task
[2025-11-28T13:47:37.681+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'silver_transformation_pipeline', 'dbt_run_linktx', 'scheduled__2025-11-09T00:00:00+00:00', '--job-id', '601', '--raw', '--subdir', 'DAGS_FOLDER/silver_dag.py', '--cfg-path', '/tmp/tmpjslcapla']
[2025-11-28T13:47:37.731+0000] {standard_task_runner.py:88} INFO - Job 601: Subtask dbt_run_linktx
[2025-11-28T13:47:38.322+0000] {task_command.py:423} INFO - Running <TaskInstance: silver_transformation_pipeline.dbt_run_linktx scheduled__2025-11-09T00:00:00+00:00 [running]> on host b34d3694f5a7
[2025-11-28T13:47:38.738+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='silver_transformation_pipeline' AIRFLOW_CTX_TASK_ID='dbt_run_linktx' AIRFLOW_CTX_EXECUTION_DATE='2025-11-09T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-11-09T00:00:00+00:00'
[2025-11-28T13:48:11.317+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/silver_dag.py", line 150, in _run_dbt
    raise RuntimeError(f"dbt failed ({proc.returncode}).\nSTDOUT:\n{proc.stdout}\n\nSTDERR:\n{proc.stderr}")
RuntimeError: dbt failed (2).
STDOUT:
13:48:04  Running with dbt=1.5.9
13:48:04  Registered adapter: clickhouse=1.5.2
13:48:04  Unable to do partial parsing because config vars, config profile, or config target have changed
13:48:09  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
13:48:09  Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
13:48:09  
13:48:09  
13:48:09  Finished running  in 0 hours 0 minutes and 0.67 seconds (0.67s).
13:48:09  Encountered an error:
Database Error
  Code: 516.
  DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.
  
  If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
  on the settings page for the corresponding service.
  
  If you have installed ClickHouse and forgot password you can reset it in the configuration file.
  The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
  and deleting this file will reset the password.
  See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.
  
  . Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ClientInfo const&) const @ 0x0000000016c5c123
  4. DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000184732f2
  5. DB::Session::authenticate(String const&, String const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000184727b2
  6. DB::TCPHandler::receiveHello() @ 0x0000000019e38ff9
  7. DB::TCPHandler::runImpl() @ 0x0000000019e29a13
  8. DB::TCPHandler::run() @ 0x0000000019e4f119
  9. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  10. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  11. Poco::PooledThread::run() @ 0x000000001ef15b87
  12. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
  13. ? @ 0x0000000000094ac3
  14. ? @ 0x0000000000125a74
  


STDERR:

[2025-11-28T13:48:11.360+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=silver_transformation_pipeline, task_id=dbt_run_linktx, execution_date=20251109T000000, start_date=20251128T134737, end_date=20251128T134811
[2025-11-28T13:48:11.413+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 601 for task dbt_run_linktx (dbt failed (2).
STDOUT:
13:48:04  Running with dbt=1.5.9
13:48:04  Registered adapter: clickhouse=1.5.2
13:48:04  Unable to do partial parsing because config vars, config profile, or config target have changed
13:48:09  [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
13:48:09  Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
13:48:09  
13:48:09  
13:48:09  Finished running  in 0 hours 0 minutes and 0.67 seconds (0.67s).
13:48:09  Encountered an error:
Database Error
  Code: 516.
  DB::Exception: default: Authentication failed: password is incorrect, or there is no user with such name.
  
  If you use ClickHouse Cloud, the password can be reset at https://clickhouse.cloud/
  on the settings page for the corresponding service.
  
  If you have installed ClickHouse and forgot password you can reset it in the configuration file.
  The password for default user is typically located at /etc/clickhouse-server/users.d/default-password.xml
  and deleting this file will reset the password.
  See also /etc/clickhouse-server/users.xml on the server where ClickHouse is installed.
  
  . Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::AccessControl::authenticate(DB::Credentials const&, Poco::Net::IPAddress const&, DB::ClientInfo const&) const @ 0x0000000016c5c123
  4. DB::Session::authenticate(DB::Credentials const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000184732f2
  5. DB::Session::authenticate(String const&, String const&, Poco::Net::SocketAddress const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000184727b2
  6. DB::TCPHandler::receiveHello() @ 0x0000000019e38ff9
  7. DB::TCPHandler::runImpl() @ 0x0000000019e29a13
  8. DB::TCPHandler::run() @ 0x0000000019e4f119
  9. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  10. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  11. Poco::PooledThread::run() @ 0x000000001ef15b87
  12. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
  13. ? @ 0x0000000000094ac3
  14. ? @ 0x0000000000125a74
  


STDERR:
; 301)
[2025-11-28T13:48:11.460+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-11-28T13:48:11.521+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
