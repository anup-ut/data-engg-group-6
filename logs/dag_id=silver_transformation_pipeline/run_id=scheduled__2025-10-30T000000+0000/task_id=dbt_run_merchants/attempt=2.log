[2025-10-31T18:59:31.729+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T18:59:31.741+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T18:59:31.743+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-10-31T18:59:31.757+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T18:59:31.763+0000] {standard_task_runner.py:60} INFO - Started process 1312 to run task
[2025-10-31T18:59:31.766+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'silver_transformation_pipeline', 'dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '33', '--raw', '--subdir', 'DAGS_FOLDER/silver_dag.py', '--cfg-path', '/tmp/tmpeqwp3z95']
[2025-10-31T18:59:31.768+0000] {standard_task_runner.py:88} INFO - Job 33: Subtask dbt_run_merchants
[2025-10-31T18:59:31.847+0000] {task_command.py:423} INFO - Running <TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host 516a89ff7ea8
[2025-10-31T18:59:31.930+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='silver_transformation_pipeline' AIRFLOW_CTX_TASK_ID='dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T18:59:31.931+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T18:59:31.933+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T18:59:31.945+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T18:59:33.487+0000] {subprocess.py:93} INFO - 18:59:33  Running with dbt=1.10.13
[2025-10-31T18:59:33.757+0000] {subprocess.py:93} INFO - 18:59:33  Registered adapter: clickhouse=1.9.5
[2025-10-31T18:59:34.218+0000] {subprocess.py:93} INFO - 18:59:34  Found 3 models, 3 sources, 488 macros
[2025-10-31T18:59:34.223+0000] {subprocess.py:93} INFO - 18:59:34
[2025-10-31T18:59:34.226+0000] {subprocess.py:93} INFO - 18:59:34  Concurrency: 4 threads (target='dev')
[2025-10-31T18:59:34.227+0000] {subprocess.py:93} INFO - 18:59:34
[2025-10-31T18:59:34.484+0000] {subprocess.py:93} INFO - 18:59:34  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T18:59:34.638+0000] {subprocess.py:93} INFO - 18:59:34  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.15s]
[2025-10-31T18:59:34.646+0000] {subprocess.py:93} INFO - 18:59:34
[2025-10-31T18:59:34.647+0000] {subprocess.py:93} INFO - 18:59:34  Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[2025-10-31T18:59:34.698+0000] {subprocess.py:93} INFO - 18:59:34
[2025-10-31T18:59:34.699+0000] {subprocess.py:93} INFO - 18:59:34  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T18:59:34.700+0000] {subprocess.py:93} INFO - 18:59:34
[2025-10-31T18:59:34.702+0000] {subprocess.py:93} INFO - 18:59:34  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T18:59:34.704+0000] {subprocess.py:93} INFO - 18:59:34    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T18:59:34.704+0000] {subprocess.py:93} INFO -   Code: 62.
[2025-10-31T18:59:34.705+0000] {subprocess.py:93} INFO -   DB::Exception: Syntax error: failed at position 1187 (end of query) (line 42, col 30): ;
[2025-10-31T18:59:34.705+0000] {subprocess.py:93} INFO -             )
[2025-10-31T18:59:34.706+0000] {subprocess.py:93} INFO - 
[2025-10-31T18:59:34.706+0000] {subprocess.py:93} INFO -           . Expected one of: OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
[2025-10-31T18:59:34.707+0000] {subprocess.py:93} INFO - 
[2025-10-31T18:59:34.707+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T18:59:34.708+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String const&, int, String, bool) @ 0x0000000012423c8e
[2025-10-31T18:59:34.708+0000] {subprocess.py:93} INFO -   2. DB::Exception::createDeprecated(String const&, int, bool) @ 0x0000000013a54f9f
[2025-10-31T18:59:34.709+0000] {subprocess.py:93} INFO -   3. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x000000001aace132
[2025-10-31T18:59:34.709+0000] {subprocess.py:93} INFO -   4. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018779652
[2025-10-31T18:59:34.710+0000] {subprocess.py:93} INFO -   5. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T18:59:34.711+0000] {subprocess.py:93} INFO -   6. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T18:59:34.711+0000] {subprocess.py:93} INFO -   7. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T18:59:34.712+0000] {subprocess.py:93} INFO -   8. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T18:59:34.712+0000] {subprocess.py:93} INFO -   9. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T18:59:34.712+0000] {subprocess.py:93} INFO -   10. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T18:59:34.713+0000] {subprocess.py:93} INFO -   11. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T18:59:34.714+0000] {subprocess.py:93} INFO -   12. ? @ 0x0000000000094ac3
[2025-10-31T18:59:34.714+0000] {subprocess.py:93} INFO -   13. ? @ 0x0000000000125a74
[2025-10-31T18:59:34.714+0000] {subprocess.py:93} INFO - 18:59:34
[2025-10-31T18:59:34.715+0000] {subprocess.py:93} INFO - 18:59:34    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T18:59:34.715+0000] {subprocess.py:93} INFO - 18:59:34
[2025-10-31T18:59:34.716+0000] {subprocess.py:93} INFO - 18:59:34  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T18:59:35.612+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T18:59:35.627+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T18:59:35.630+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=silver_transformation_pipeline, task_id=dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T185931, end_date=20251031T185935
[2025-10-31T18:59:35.647+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 33 for task dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 1312)
[2025-10-31T18:59:35.680+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T18:59:35.700+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-11-01T11:46:37.372+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T11:46:37.385+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T11:46:37.386+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-11-01T11:46:37.409+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-11-01T11:46:37.416+0000] {standard_task_runner.py:60} INFO - Started process 1188 to run task
[2025-11-01T11:46:37.420+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'silver_transformation_pipeline', 'dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '50', '--raw', '--subdir', 'DAGS_FOLDER/silver_dag.py', '--cfg-path', '/tmp/tmpf06lb9y2']
[2025-11-01T11:46:37.425+0000] {standard_task_runner.py:88} INFO - Job 50: Subtask dbt_run_merchants
[2025-11-01T11:46:37.526+0000] {task_command.py:423} INFO - Running <TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host 6ac9b46937d1
[2025-11-01T11:46:37.642+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='silver_transformation_pipeline' AIRFLOW_CTX_TASK_ID='dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-11-01T11:46:37.644+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-01T11:46:37.646+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-11-01T11:46:37.670+0000] {subprocess.py:86} INFO - Output:
[2025-11-01T11:46:39.776+0000] {subprocess.py:93} INFO - 11:46:39  Running with dbt=1.10.13
[2025-11-01T11:46:40.338+0000] {subprocess.py:93} INFO - 11:46:40  Registered adapter: clickhouse=1.9.5
[2025-11-01T11:46:40.737+0000] {subprocess.py:93} INFO - 11:46:40  Unable to do partial parsing because config vars, config profile, or config target have changed
[2025-11-01T11:46:43.661+0000] {subprocess.py:93} INFO - 11:46:43  Found 3 models, 3 sources, 491 macros
[2025-11-01T11:46:43.668+0000] {subprocess.py:93} INFO - 11:46:43
[2025-11-01T11:46:43.674+0000] {subprocess.py:93} INFO - 11:46:43  Concurrency: 4 threads (target='dev')
[2025-11-01T11:46:43.681+0000] {subprocess.py:93} INFO - 11:46:43
[2025-11-01T11:46:44.229+0000] {subprocess.py:93} INFO - 11:46:44  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-11-01T11:46:44.358+0000] {subprocess.py:93} INFO - 11:46:44  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.12s]
[2025-11-01T11:46:44.393+0000] {subprocess.py:93} INFO - 11:46:44
[2025-11-01T11:46:44.396+0000] {subprocess.py:93} INFO - 11:46:44  Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[2025-11-01T11:46:44.636+0000] {subprocess.py:93} INFO - 11:46:44
[2025-11-01T11:46:44.640+0000] {subprocess.py:93} INFO - 11:46:44  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-11-01T11:46:44.641+0000] {subprocess.py:93} INFO - 11:46:44
[2025-11-01T11:46:44.642+0000] {subprocess.py:93} INFO - 11:46:44  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-11-01T11:46:44.644+0000] {subprocess.py:93} INFO - 11:46:44    Compilation Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-11-01T11:46:44.645+0000] {subprocess.py:93} INFO -   macro 'dbt_macro__clickhouse__create_table_as' takes not more than 2 argument(s)
[2025-11-01T11:46:44.646+0000] {subprocess.py:93} INFO - 
[2025-11-01T11:46:44.647+0000] {subprocess.py:93} INFO -   > in macro create_table_as (macros/relations/table/create.sql)
[2025-11-01T11:46:44.648+0000] {subprocess.py:93} INFO -   > called by macro default__get_create_table_as_sql (macros/relations/table/create.sql)
[2025-11-01T11:46:44.648+0000] {subprocess.py:93} INFO -   > called by macro get_create_table_as_sql (macros/relations/table/create.sql)
[2025-11-01T11:46:44.649+0000] {subprocess.py:93} INFO -   > called by macro statement (macros/etc/statement.sql)
[2025-11-01T11:46:44.650+0000] {subprocess.py:93} INFO -   > called by macro materialization_table_clickhouse (macros/materializations/table.sql)
[2025-11-01T11:46:44.651+0000] {subprocess.py:93} INFO -   > called by model silver_merchants (models/silver/silver_merchants.sql)
[2025-11-01T11:46:44.652+0000] {subprocess.py:93} INFO - 11:46:44
[2025-11-01T11:46:44.653+0000] {subprocess.py:93} INFO - 11:46:44    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-11-01T11:46:44.653+0000] {subprocess.py:93} INFO - 11:46:44
[2025-11-01T11:46:44.656+0000] {subprocess.py:93} INFO - 11:46:44  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-11-01T11:46:45.820+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-11-01T11:46:45.850+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-11-01T11:46:45.860+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=silver_transformation_pipeline, task_id=dbt_run_merchants, execution_date=20251030T000000, start_date=20251101T114637, end_date=20251101T114645
[2025-11-01T11:46:45.890+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 50 for task dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 1188)
[2025-11-01T11:46:45.938+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-11-01T11:46:45.964+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-11-01T14:16:27.241+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T14:16:27.263+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T14:16:27.264+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-11-01T14:16:27.283+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-11-01T14:16:27.291+0000] {standard_task_runner.py:60} INFO - Started process 695 to run task
[2025-11-01T14:16:27.295+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'silver_transformation_pipeline', 'dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/silver_dag.py', '--cfg-path', '/tmp/tmpfcp3krvm']
[2025-11-01T14:16:27.300+0000] {standard_task_runner.py:88} INFO - Job 22: Subtask dbt_run_merchants
[2025-11-01T14:16:27.412+0000] {task_command.py:423} INFO - Running <TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host b977057f5fed
[2025-11-01T14:16:27.514+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='silver_transformation_pipeline' AIRFLOW_CTX_TASK_ID='dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-11-01T14:16:27.517+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-01T14:16:27.518+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'dbt --no-use-colors run --project-dir /opt/***/dbt_project --profiles-dir /opt/***/dbt_project --select silver_merchants --full-refresh']
[2025-11-01T14:16:27.532+0000] {subprocess.py:86} INFO - Output:
[2025-11-01T14:16:29.095+0000] {subprocess.py:93} INFO - 14:16:29  Running with dbt=1.8.6
[2025-11-01T14:16:29.122+0000] {subprocess.py:93} INFO - 14:16:29  Encountered an error:
[2025-11-01T14:16:29.133+0000] {subprocess.py:93} INFO - 'type' object is not subscriptable
[2025-11-01T14:16:29.139+0000] {subprocess.py:93} INFO - 14:16:29  Traceback (most recent call last):
[2025-11-01T14:16:29.140+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
[2025-11-01T14:16:29.140+0000] {subprocess.py:93} INFO -     result, success = func(*args, **kwargs)
[2025-11-01T14:16:29.141+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
[2025-11-01T14:16:29.141+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-11-01T14:16:29.142+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
[2025-11-01T14:16:29.142+0000] {subprocess.py:93} INFO -     profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
[2025-11-01T14:16:29.143+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 71, in load_profile
[2025-11-01T14:16:29.144+0000] {subprocess.py:93} INFO -     profile = Profile.render(
[2025-11-01T14:16:29.144+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 403, in render
[2025-11-01T14:16:29.145+0000] {subprocess.py:93} INFO -     return cls.from_raw_profiles(
[2025-11-01T14:16:29.145+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 369, in from_raw_profiles
[2025-11-01T14:16:29.146+0000] {subprocess.py:93} INFO -     return cls.from_raw_profile_info(
[2025-11-01T14:16:29.147+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 325, in from_raw_profile_info
[2025-11-01T14:16:29.147+0000] {subprocess.py:93} INFO -     credentials: Credentials = cls._credentials_from_profile(
[2025-11-01T14:16:29.152+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 149, in _credentials_from_profile
[2025-11-01T14:16:29.153+0000] {subprocess.py:93} INFO -     cls = load_plugin(typename)
[2025-11-01T14:16:29.154+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 239, in load_plugin
[2025-11-01T14:16:29.155+0000] {subprocess.py:93} INFO -     return FACTORY.load_plugin(name)
[2025-11-01T14:16:29.156+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 68, in load_plugin
[2025-11-01T14:16:29.156+0000] {subprocess.py:93} INFO -     mod: Any = import_module("." + name, "dbt.adapters")
[2025-11-01T14:16:29.157+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/importlib/__init__.py", line 127, in import_module
[2025-11-01T14:16:29.157+0000] {subprocess.py:93} INFO -     return _bootstrap._gcd_import(name[level:], package, level)
[2025-11-01T14:16:29.158+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
[2025-11-01T14:16:29.158+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 991, in _find_and_load
[2025-11-01T14:16:29.159+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
[2025-11-01T14:16:29.159+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
[2025-11-01T14:16:29.160+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap_external>", line 843, in exec_module
[2025-11-01T14:16:29.160+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
[2025-11-01T14:16:29.161+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/__init__.py", line 4, in <module>
[2025-11-01T14:16:29.161+0000] {subprocess.py:93} INFO -     from dbt.adapters.clickhouse.connections import ClickHouseConnectionManager  # noqa
[2025-11-01T14:16:29.162+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 10, in <module>
[2025-11-01T14:16:29.162+0000] {subprocess.py:93} INFO -     from dbt.adapters.clickhouse.dbclient import ChRetryableException, get_db_client
[2025-11-01T14:16:29.163+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/dbclient.py", line 9, in <module>
[2025-11-01T14:16:29.163+0000] {subprocess.py:93} INFO -     from dbt.adapters.clickhouse.credentials import ClickHouseCredentials
[2025-11-01T14:16:29.164+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/credentials.py", line 9, in <module>
[2025-11-01T14:16:29.164+0000] {subprocess.py:93} INFO -     class ClickHouseCredentials(Credentials):
[2025-11-01T14:16:29.164+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/credentials.py", line 38, in ClickHouseCredentials
[2025-11-01T14:16:29.165+0000] {subprocess.py:93} INFO -     tcp_keepalive: Union[bool, tuple[int, int, int], list[int]] = False
[2025-11-01T14:16:29.165+0000] {subprocess.py:93} INFO - TypeError: 'type' object is not subscriptable
[2025-11-01T14:16:29.165+0000] {subprocess.py:93} INFO - 
[2025-11-01T14:16:29.825+0000] {subprocess.py:97} INFO - Command exited with return code 2
[2025-11-01T14:16:29.838+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 2.
[2025-11-01T14:16:29.841+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=silver_transformation_pipeline, task_id=dbt_run_merchants, execution_date=20251030T000000, start_date=20251101T141627, end_date=20251101T141629
[2025-11-01T14:16:29.856+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 22 for task dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 2.; 695)
[2025-11-01T14:16:29.884+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-11-01T14:16:29.903+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-11-01T14:26:33.620+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T14:26:33.636+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T14:26:33.637+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-11-01T14:26:33.655+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-11-01T14:26:33.660+0000] {standard_task_runner.py:60} INFO - Started process 656 to run task
[2025-11-01T14:26:33.667+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'silver_transformation_pipeline', 'dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '22', '--raw', '--subdir', 'DAGS_FOLDER/silver_dag.py', '--cfg-path', '/tmp/tmpgm6_is9w']
[2025-11-01T14:26:33.671+0000] {standard_task_runner.py:88} INFO - Job 22: Subtask dbt_run_merchants
[2025-11-01T14:26:33.791+0000] {task_command.py:423} INFO - Running <TaskInstance: silver_transformation_pipeline.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host 8c60c1c29b68
[2025-11-01T14:26:33.940+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='silver_transformation_pipeline' AIRFLOW_CTX_TASK_ID='dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-11-01T14:26:33.942+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-01T14:26:33.945+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'dbt --no-use-colors run --project-dir /opt/***/dbt_project --profiles-dir /opt/***/dbt_project --select silver_merchants --full-refresh']
[2025-11-01T14:26:33.957+0000] {subprocess.py:86} INFO - Output:
[2025-11-01T14:26:36.021+0000] {subprocess.py:93} INFO - 14:26:36  Running with dbt=1.8.6
[2025-11-01T14:26:36.041+0000] {subprocess.py:93} INFO - 14:26:36  Encountered an error:
[2025-11-01T14:26:36.041+0000] {subprocess.py:93} INFO - 'type' object is not subscriptable
[2025-11-01T14:26:36.043+0000] {subprocess.py:93} INFO - 14:26:36  Traceback (most recent call last):
[2025-11-01T14:26:36.043+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 138, in wrapper
[2025-11-01T14:26:36.044+0000] {subprocess.py:93} INFO -     result, success = func(*args, **kwargs)
[2025-11-01T14:26:36.044+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 101, in wrapper
[2025-11-01T14:26:36.044+0000] {subprocess.py:93} INFO -     return func(*args, **kwargs)
[2025-11-01T14:26:36.045+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
[2025-11-01T14:26:36.045+0000] {subprocess.py:93} INFO -     profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
[2025-11-01T14:26:36.046+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 71, in load_profile
[2025-11-01T14:26:36.046+0000] {subprocess.py:93} INFO -     profile = Profile.render(
[2025-11-01T14:26:36.046+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 403, in render
[2025-11-01T14:26:36.047+0000] {subprocess.py:93} INFO -     return cls.from_raw_profiles(
[2025-11-01T14:26:36.047+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 369, in from_raw_profiles
[2025-11-01T14:26:36.048+0000] {subprocess.py:93} INFO -     return cls.from_raw_profile_info(
[2025-11-01T14:26:36.048+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 325, in from_raw_profile_info
[2025-11-01T14:26:36.048+0000] {subprocess.py:93} INFO -     credentials: Credentials = cls._credentials_from_profile(
[2025-11-01T14:26:36.049+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 149, in _credentials_from_profile
[2025-11-01T14:26:36.049+0000] {subprocess.py:93} INFO -     cls = load_plugin(typename)
[2025-11-01T14:26:36.049+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 239, in load_plugin
[2025-11-01T14:26:36.050+0000] {subprocess.py:93} INFO -     return FACTORY.load_plugin(name)
[2025-11-01T14:26:36.050+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 68, in load_plugin
[2025-11-01T14:26:36.050+0000] {subprocess.py:93} INFO -     mod: Any = import_module("." + name, "dbt.adapters")
[2025-11-01T14:26:36.050+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.8/importlib/__init__.py", line 127, in import_module
[2025-11-01T14:26:36.051+0000] {subprocess.py:93} INFO -     return _bootstrap._gcd_import(name[level:], package, level)
[2025-11-01T14:26:36.051+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
[2025-11-01T14:26:36.051+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 991, in _find_and_load
[2025-11-01T14:26:36.052+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
[2025-11-01T14:26:36.052+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
[2025-11-01T14:26:36.053+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap_external>", line 843, in exec_module
[2025-11-01T14:26:36.054+0000] {subprocess.py:93} INFO -   File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
[2025-11-01T14:26:36.054+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/__init__.py", line 4, in <module>
[2025-11-01T14:26:36.054+0000] {subprocess.py:93} INFO -     from dbt.adapters.clickhouse.connections import ClickHouseConnectionManager  # noqa
[2025-11-01T14:26:36.055+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 10, in <module>
[2025-11-01T14:26:36.055+0000] {subprocess.py:93} INFO -     from dbt.adapters.clickhouse.dbclient import ChRetryableException, get_db_client
[2025-11-01T14:26:36.055+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/dbclient.py", line 9, in <module>
[2025-11-01T14:26:36.055+0000] {subprocess.py:93} INFO -     from dbt.adapters.clickhouse.credentials import ClickHouseCredentials
[2025-11-01T14:26:36.056+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/credentials.py", line 9, in <module>
[2025-11-01T14:26:36.056+0000] {subprocess.py:93} INFO -     class ClickHouseCredentials(Credentials):
[2025-11-01T14:26:36.056+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.8/site-packages/dbt/adapters/clickhouse/credentials.py", line 38, in ClickHouseCredentials
[2025-11-01T14:26:36.057+0000] {subprocess.py:93} INFO -     tcp_keepalive: Union[bool, tuple[int, int, int], list[int]] = False
[2025-11-01T14:26:36.057+0000] {subprocess.py:93} INFO - TypeError: 'type' object is not subscriptable
[2025-11-01T14:26:36.057+0000] {subprocess.py:93} INFO - 
[2025-11-01T14:26:36.750+0000] {subprocess.py:97} INFO - Command exited with return code 2
[2025-11-01T14:26:36.766+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 2.
[2025-11-01T14:26:36.770+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=silver_transformation_pipeline, task_id=dbt_run_merchants, execution_date=20251030T000000, start_date=20251101T142633, end_date=20251101T142636
[2025-11-01T14:26:36.785+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 22 for task dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 2.; 656)
[2025-11-01T14:26:36.824+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-11-01T14:26:36.844+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
