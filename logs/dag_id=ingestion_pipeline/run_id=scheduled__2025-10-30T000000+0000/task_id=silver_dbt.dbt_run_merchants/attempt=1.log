[2025-10-31T19:06:51.862+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T19:06:51.874+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T19:06:51.874+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T19:06:51.889+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T19:06:51.894+0000] {standard_task_runner.py:60} INFO - Started process 843 to run task
[2025-10-31T19:06:51.899+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpatozb5dl']
[2025-10-31T19:06:51.902+0000] {standard_task_runner.py:88} INFO - Job 35: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T19:06:51.977+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host fe1087a1e328
[2025-10-31T19:06:52.062+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T19:06:52.064+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T19:06:52.065+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T19:06:52.076+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T19:06:53.664+0000] {subprocess.py:93} INFO - 19:06:53  Running with dbt=1.10.13
[2025-10-31T19:06:53.900+0000] {subprocess.py:93} INFO - 19:06:53  Registered adapter: clickhouse=1.9.5
[2025-10-31T19:06:54.342+0000] {subprocess.py:93} INFO - 19:06:54  Found 3 models, 3 sources, 488 macros
[2025-10-31T19:06:54.346+0000] {subprocess.py:93} INFO - 19:06:54
[2025-10-31T19:06:54.348+0000] {subprocess.py:93} INFO - 19:06:54  Concurrency: 4 threads (target='dev')
[2025-10-31T19:06:54.350+0000] {subprocess.py:93} INFO - 19:06:54
[2025-10-31T19:06:54.611+0000] {subprocess.py:93} INFO - 19:06:54  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T19:06:54.783+0000] {subprocess.py:93} INFO - 19:06:54  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.17s]
[2025-10-31T19:06:54.794+0000] {subprocess.py:93} INFO - 19:06:54
[2025-10-31T19:06:54.795+0000] {subprocess.py:93} INFO - 19:06:54  Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[2025-10-31T19:06:54.859+0000] {subprocess.py:93} INFO - 19:06:54
[2025-10-31T19:06:54.860+0000] {subprocess.py:93} INFO - 19:06:54  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T19:06:54.861+0000] {subprocess.py:93} INFO - 19:06:54
[2025-10-31T19:06:54.863+0000] {subprocess.py:93} INFO - 19:06:54  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T19:06:54.865+0000] {subprocess.py:93} INFO - 19:06:54    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T19:06:54.866+0000] {subprocess.py:93} INFO -   Code: 62.
[2025-10-31T19:06:54.867+0000] {subprocess.py:93} INFO -   DB::Exception: Syntax error: failed at position 1187 (end of query) (line 42, col 30): ;
[2025-10-31T19:06:54.867+0000] {subprocess.py:93} INFO -             )
[2025-10-31T19:06:54.868+0000] {subprocess.py:93} INFO - 
[2025-10-31T19:06:54.869+0000] {subprocess.py:93} INFO -           . Expected one of: OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
[2025-10-31T19:06:54.869+0000] {subprocess.py:93} INFO - 
[2025-10-31T19:06:54.870+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T19:06:54.871+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String const&, int, String, bool) @ 0x0000000012423c8e
[2025-10-31T19:06:54.871+0000] {subprocess.py:93} INFO -   2. DB::Exception::createDeprecated(String const&, int, bool) @ 0x0000000013a54f9f
[2025-10-31T19:06:54.872+0000] {subprocess.py:93} INFO -   3. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x000000001aace132
[2025-10-31T19:06:54.872+0000] {subprocess.py:93} INFO -   4. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018779652
[2025-10-31T19:06:54.873+0000] {subprocess.py:93} INFO -   5. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T19:06:54.873+0000] {subprocess.py:93} INFO -   6. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T19:06:54.874+0000] {subprocess.py:93} INFO -   7. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T19:06:54.874+0000] {subprocess.py:93} INFO -   8. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T19:06:54.875+0000] {subprocess.py:93} INFO -   9. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T19:06:54.875+0000] {subprocess.py:93} INFO -   10. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T19:06:54.876+0000] {subprocess.py:93} INFO -   11. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T19:06:54.877+0000] {subprocess.py:93} INFO -   12. ? @ 0x0000000000094ac3
[2025-10-31T19:06:54.878+0000] {subprocess.py:93} INFO -   13. ? @ 0x0000000000125a74
[2025-10-31T19:06:54.878+0000] {subprocess.py:93} INFO - 19:06:54
[2025-10-31T19:06:54.879+0000] {subprocess.py:93} INFO - 19:06:54    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T19:06:54.880+0000] {subprocess.py:93} INFO - 19:06:54
[2025-10-31T19:06:54.880+0000] {subprocess.py:93} INFO - 19:06:54  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T19:06:55.695+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T19:06:55.711+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T19:06:55.715+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T190651, end_date=20251031T190655
[2025-10-31T19:06:55.732+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 35 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 843)
[2025-10-31T19:06:55.768+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T19:06:55.811+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T19:39:42.385+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T19:39:42.395+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T19:39:42.396+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T19:39:42.412+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T19:39:42.418+0000] {standard_task_runner.py:60} INFO - Started process 855 to run task
[2025-10-31T19:39:42.422+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '18', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpi075se1d']
[2025-10-31T19:39:42.424+0000] {standard_task_runner.py:88} INFO - Job 18: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T19:39:42.518+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host 3ff65ab69399
[2025-10-31T19:39:42.616+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T19:39:42.618+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T19:39:42.620+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T19:39:42.629+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T19:39:44.641+0000] {subprocess.py:93} INFO - 19:39:44  Running with dbt=1.10.13
[2025-10-31T19:39:44.912+0000] {subprocess.py:93} INFO - 19:39:44  Registered adapter: clickhouse=1.9.5
[2025-10-31T19:39:45.119+0000] {subprocess.py:93} INFO - 19:39:45  Unable to do partial parsing because config vars, config profile, or config target have changed
[2025-10-31T19:39:46.852+0000] {subprocess.py:93} INFO - 19:39:46  Found 3 models, 3 sources, 488 macros
[2025-10-31T19:39:46.857+0000] {subprocess.py:93} INFO - 19:39:46
[2025-10-31T19:39:46.859+0000] {subprocess.py:93} INFO - 19:39:46  Concurrency: 4 threads (target='dev')
[2025-10-31T19:39:46.861+0000] {subprocess.py:93} INFO - 19:39:46
[2025-10-31T19:39:47.214+0000] {subprocess.py:93} INFO - 19:39:47  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T19:39:47.319+0000] {subprocess.py:93} INFO - 19:39:47  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.10s]
[2025-10-31T19:39:47.327+0000] {subprocess.py:93} INFO - 19:39:47
[2025-10-31T19:39:47.328+0000] {subprocess.py:93} INFO - 19:39:47  Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[2025-10-31T19:39:47.463+0000] {subprocess.py:93} INFO - 19:39:47
[2025-10-31T19:39:47.464+0000] {subprocess.py:93} INFO - 19:39:47  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T19:39:47.468+0000] {subprocess.py:93} INFO - 19:39:47
[2025-10-31T19:39:47.474+0000] {subprocess.py:93} INFO - 19:39:47  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T19:39:47.476+0000] {subprocess.py:93} INFO - 19:39:47    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T19:39:47.477+0000] {subprocess.py:93} INFO -   Code: 62.
[2025-10-31T19:39:47.478+0000] {subprocess.py:93} INFO -   DB::Exception: Syntax error: failed at position 1187 (end of query) (line 42, col 30): ;
[2025-10-31T19:39:47.479+0000] {subprocess.py:93} INFO -             )
[2025-10-31T19:39:47.481+0000] {subprocess.py:93} INFO - 
[2025-10-31T19:39:47.483+0000] {subprocess.py:93} INFO -           . Expected one of: OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
[2025-10-31T19:39:47.484+0000] {subprocess.py:93} INFO - 
[2025-10-31T19:39:47.485+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T19:39:47.487+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String const&, int, String, bool) @ 0x0000000012423c8e
[2025-10-31T19:39:47.488+0000] {subprocess.py:93} INFO -   2. DB::Exception::createDeprecated(String const&, int, bool) @ 0x0000000013a54f9f
[2025-10-31T19:39:47.489+0000] {subprocess.py:93} INFO -   3. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x000000001aace132
[2025-10-31T19:39:47.490+0000] {subprocess.py:93} INFO -   4. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018779652
[2025-10-31T19:39:47.493+0000] {subprocess.py:93} INFO -   5. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T19:39:47.494+0000] {subprocess.py:93} INFO -   6. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T19:39:47.495+0000] {subprocess.py:93} INFO -   7. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T19:39:47.496+0000] {subprocess.py:93} INFO -   8. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T19:39:47.496+0000] {subprocess.py:93} INFO -   9. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T19:39:47.497+0000] {subprocess.py:93} INFO -   10. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T19:39:47.499+0000] {subprocess.py:93} INFO -   11. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T19:39:47.502+0000] {subprocess.py:93} INFO -   12. ? @ 0x0000000000094ac3
[2025-10-31T19:39:47.504+0000] {subprocess.py:93} INFO -   13. ? @ 0x0000000000125a74
[2025-10-31T19:39:47.505+0000] {subprocess.py:93} INFO - 19:39:47
[2025-10-31T19:39:47.505+0000] {subprocess.py:93} INFO - 19:39:47    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T19:39:47.506+0000] {subprocess.py:93} INFO - 19:39:47
[2025-10-31T19:39:47.506+0000] {subprocess.py:93} INFO - 19:39:47  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T19:39:48.477+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T19:39:48.494+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T19:39:48.498+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T193942, end_date=20251031T193948
[2025-10-31T19:39:48.515+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 18 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 855)
[2025-10-31T19:39:48.533+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T19:39:48.563+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T20:06:30.186+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T20:06:30.197+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T20:06:30.198+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T20:06:30.215+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T20:06:30.221+0000] {standard_task_runner.py:60} INFO - Started process 439 to run task
[2025-10-31T20:06:30.225+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmprqva9rm9']
[2025-10-31T20:06:30.228+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T20:06:30.317+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host c2d20b09a38d
[2025-10-31T20:06:30.419+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T20:06:30.422+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T20:06:30.423+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T20:06:30.434+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T20:06:32.025+0000] {subprocess.py:93} INFO - 20:06:32  Running with dbt=1.10.13
[2025-10-31T20:06:32.287+0000] {subprocess.py:93} INFO - 20:06:32  Registered adapter: clickhouse=1.9.5
[2025-10-31T20:06:32.683+0000] {subprocess.py:93} INFO - 20:06:32  Found 3 models, 3 sources, 488 macros
[2025-10-31T20:06:32.687+0000] {subprocess.py:93} INFO - 20:06:32
[2025-10-31T20:06:32.689+0000] {subprocess.py:93} INFO - 20:06:32  Concurrency: 4 threads (target='dev')
[2025-10-31T20:06:32.690+0000] {subprocess.py:93} INFO - 20:06:32
[2025-10-31T20:06:32.961+0000] {subprocess.py:93} INFO - 20:06:32  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T20:06:33.118+0000] {subprocess.py:93} INFO - 20:06:33  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.15s]
[2025-10-31T20:06:33.128+0000] {subprocess.py:93} INFO - 20:06:33
[2025-10-31T20:06:33.129+0000] {subprocess.py:93} INFO - 20:06:33  Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[2025-10-31T20:06:33.187+0000] {subprocess.py:93} INFO - 20:06:33
[2025-10-31T20:06:33.188+0000] {subprocess.py:93} INFO - 20:06:33  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T20:06:33.190+0000] {subprocess.py:93} INFO - 20:06:33
[2025-10-31T20:06:33.191+0000] {subprocess.py:93} INFO - 20:06:33  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T20:06:33.193+0000] {subprocess.py:93} INFO - 20:06:33    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T20:06:33.194+0000] {subprocess.py:93} INFO -   Code: 62.
[2025-10-31T20:06:33.195+0000] {subprocess.py:93} INFO -   DB::Exception: Syntax error: failed at position 1187 (end of query) (line 42, col 30): ;
[2025-10-31T20:06:33.196+0000] {subprocess.py:93} INFO -             )
[2025-10-31T20:06:33.197+0000] {subprocess.py:93} INFO - 
[2025-10-31T20:06:33.197+0000] {subprocess.py:93} INFO -           . Expected one of: OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
[2025-10-31T20:06:33.198+0000] {subprocess.py:93} INFO - 
[2025-10-31T20:06:33.199+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T20:06:33.199+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String const&, int, String, bool) @ 0x0000000012423c8e
[2025-10-31T20:06:33.200+0000] {subprocess.py:93} INFO -   2. DB::Exception::createDeprecated(String const&, int, bool) @ 0x0000000013a54f9f
[2025-10-31T20:06:33.201+0000] {subprocess.py:93} INFO -   3. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x000000001aace132
[2025-10-31T20:06:33.202+0000] {subprocess.py:93} INFO -   4. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018779652
[2025-10-31T20:06:33.202+0000] {subprocess.py:93} INFO -   5. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T20:06:33.203+0000] {subprocess.py:93} INFO -   6. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T20:06:33.203+0000] {subprocess.py:93} INFO -   7. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T20:06:33.204+0000] {subprocess.py:93} INFO -   8. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T20:06:33.205+0000] {subprocess.py:93} INFO -   9. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T20:06:33.205+0000] {subprocess.py:93} INFO -   10. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T20:06:33.206+0000] {subprocess.py:93} INFO -   11. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T20:06:33.207+0000] {subprocess.py:93} INFO -   12. ? @ 0x0000000000094ac3
[2025-10-31T20:06:33.207+0000] {subprocess.py:93} INFO -   13. ? @ 0x0000000000125a74
[2025-10-31T20:06:33.208+0000] {subprocess.py:93} INFO - 20:06:33
[2025-10-31T20:06:33.208+0000] {subprocess.py:93} INFO - 20:06:33    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T20:06:33.209+0000] {subprocess.py:93} INFO - 20:06:33
[2025-10-31T20:06:33.209+0000] {subprocess.py:93} INFO - 20:06:33  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T20:06:34.129+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T20:06:34.144+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T20:06:34.150+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T200630, end_date=20251031T200634
[2025-10-31T20:06:34.166+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 14 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 439)
[2025-10-31T20:06:34.176+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T20:06:34.207+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T20:14:14.190+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T20:14:14.202+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T20:14:14.203+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T20:14:14.221+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T20:14:14.227+0000] {standard_task_runner.py:60} INFO - Started process 333 to run task
[2025-10-31T20:14:14.233+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpy34_6jhi']
[2025-10-31T20:14:14.236+0000] {standard_task_runner.py:88} INFO - Job 8: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T20:14:14.330+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host ee75c7088485
[2025-10-31T20:14:14.451+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T20:14:14.453+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T20:14:14.454+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T20:14:14.464+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T20:14:16.261+0000] {subprocess.py:93} INFO - 20:14:16  Running with dbt=1.10.13
[2025-10-31T20:14:16.531+0000] {subprocess.py:93} INFO - 20:14:16  Registered adapter: clickhouse=1.9.5
[2025-10-31T20:14:16.879+0000] {subprocess.py:93} INFO - 20:14:16  Unable to do partial parsing because config vars, config profile, or config target have changed
[2025-10-31T20:14:18.634+0000] {subprocess.py:93} INFO - 20:14:18  Found 3 models, 3 sources, 488 macros
[2025-10-31T20:14:18.639+0000] {subprocess.py:93} INFO - 20:14:18
[2025-10-31T20:14:18.641+0000] {subprocess.py:93} INFO - 20:14:18  Concurrency: 4 threads (target='dev')
[2025-10-31T20:14:18.642+0000] {subprocess.py:93} INFO - 20:14:18
[2025-10-31T20:14:19.074+0000] {subprocess.py:93} INFO - 20:14:19  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T20:14:19.230+0000] {subprocess.py:93} INFO - 20:14:19  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.15s]
[2025-10-31T20:14:19.245+0000] {subprocess.py:93} INFO - 20:14:19
[2025-10-31T20:14:19.250+0000] {subprocess.py:93} INFO - 20:14:19  Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[2025-10-31T20:14:19.420+0000] {subprocess.py:93} INFO - 20:14:19
[2025-10-31T20:14:19.423+0000] {subprocess.py:93} INFO - 20:14:19  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T20:14:19.425+0000] {subprocess.py:93} INFO - 20:14:19
[2025-10-31T20:14:19.427+0000] {subprocess.py:93} INFO - 20:14:19  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T20:14:19.429+0000] {subprocess.py:93} INFO - 20:14:19    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T20:14:19.430+0000] {subprocess.py:93} INFO -   Code: 62.
[2025-10-31T20:14:19.433+0000] {subprocess.py:93} INFO -   DB::Exception: Syntax error: failed at position 1187 (end of query) (line 42, col 30): ;
[2025-10-31T20:14:19.434+0000] {subprocess.py:93} INFO -             )
[2025-10-31T20:14:19.436+0000] {subprocess.py:93} INFO - 
[2025-10-31T20:14:19.437+0000] {subprocess.py:93} INFO -           . Expected one of: OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
[2025-10-31T20:14:19.438+0000] {subprocess.py:93} INFO - 
[2025-10-31T20:14:19.438+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T20:14:19.439+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String const&, int, String, bool) @ 0x0000000012423c8e
[2025-10-31T20:14:19.440+0000] {subprocess.py:93} INFO -   2. DB::Exception::createDeprecated(String const&, int, bool) @ 0x0000000013a54f9f
[2025-10-31T20:14:19.441+0000] {subprocess.py:93} INFO -   3. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x000000001aace132
[2025-10-31T20:14:19.441+0000] {subprocess.py:93} INFO -   4. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018779652
[2025-10-31T20:14:19.441+0000] {subprocess.py:93} INFO -   5. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T20:14:19.442+0000] {subprocess.py:93} INFO -   6. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T20:14:19.442+0000] {subprocess.py:93} INFO -   7. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T20:14:19.443+0000] {subprocess.py:93} INFO -   8. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T20:14:19.443+0000] {subprocess.py:93} INFO -   9. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T20:14:19.444+0000] {subprocess.py:93} INFO -   10. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T20:14:19.444+0000] {subprocess.py:93} INFO -   11. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T20:14:19.445+0000] {subprocess.py:93} INFO -   12. ? @ 0x0000000000094ac3
[2025-10-31T20:14:19.445+0000] {subprocess.py:93} INFO -   13. ? @ 0x0000000000125a74
[2025-10-31T20:14:19.446+0000] {subprocess.py:93} INFO - 20:14:19
[2025-10-31T20:14:19.446+0000] {subprocess.py:93} INFO - 20:14:19    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T20:14:19.446+0000] {subprocess.py:93} INFO - 20:14:19
[2025-10-31T20:14:19.447+0000] {subprocess.py:93} INFO - 20:14:19  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T20:14:20.344+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T20:14:20.360+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T20:14:20.365+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T201414, end_date=20251031T201420
[2025-10-31T20:14:20.396+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 8 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 333)
[2025-10-31T20:14:20.428+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T20:14:20.456+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T20:32:01.040+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T20:32:01.053+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T20:32:01.054+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T20:32:01.068+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T20:32:01.073+0000] {standard_task_runner.py:60} INFO - Started process 297 to run task
[2025-10-31T20:32:01.078+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '8', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmp_ygrmdvu']
[2025-10-31T20:32:01.080+0000] {standard_task_runner.py:88} INFO - Job 8: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T20:32:01.159+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host f865f80ec1e7
[2025-10-31T20:32:01.246+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T20:32:01.248+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T20:32:01.250+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T20:32:01.267+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T20:32:03.091+0000] {subprocess.py:93} INFO - 20:32:03  Running with dbt=1.10.13
[2025-10-31T20:32:03.343+0000] {subprocess.py:93} INFO - 20:32:03  Registered adapter: clickhouse=1.9.5
[2025-10-31T20:32:04.006+0000] {subprocess.py:93} INFO - 20:32:04  Found 3 models, 3 sources, 488 macros
[2025-10-31T20:32:04.010+0000] {subprocess.py:93} INFO - 20:32:04
[2025-10-31T20:32:04.011+0000] {subprocess.py:93} INFO - 20:32:04  Concurrency: 4 threads (target='dev')
[2025-10-31T20:32:04.013+0000] {subprocess.py:93} INFO - 20:32:04
[2025-10-31T20:32:04.359+0000] {subprocess.py:93} INFO - 20:32:04  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T20:32:04.445+0000] {subprocess.py:93} INFO - 20:32:04  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.08s]
[2025-10-31T20:32:04.454+0000] {subprocess.py:93} INFO - 20:32:04
[2025-10-31T20:32:04.456+0000] {subprocess.py:93} INFO - 20:32:04  Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[2025-10-31T20:32:04.519+0000] {subprocess.py:93} INFO - 20:32:04
[2025-10-31T20:32:04.520+0000] {subprocess.py:93} INFO - 20:32:04  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T20:32:04.521+0000] {subprocess.py:93} INFO - 20:32:04
[2025-10-31T20:32:04.523+0000] {subprocess.py:93} INFO - 20:32:04  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T20:32:04.524+0000] {subprocess.py:93} INFO - 20:32:04    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T20:32:04.525+0000] {subprocess.py:93} INFO -   Code: 62.
[2025-10-31T20:32:04.526+0000] {subprocess.py:93} INFO -   DB::Exception: Syntax error: failed at position 1187 (end of query) (line 42, col 30): ;
[2025-10-31T20:32:04.527+0000] {subprocess.py:93} INFO -             )
[2025-10-31T20:32:04.528+0000] {subprocess.py:93} INFO - 
[2025-10-31T20:32:04.528+0000] {subprocess.py:93} INFO -           . Expected one of: OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
[2025-10-31T20:32:04.529+0000] {subprocess.py:93} INFO - 
[2025-10-31T20:32:04.530+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T20:32:04.530+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String const&, int, String, bool) @ 0x0000000012423c8e
[2025-10-31T20:32:04.531+0000] {subprocess.py:93} INFO -   2. DB::Exception::createDeprecated(String const&, int, bool) @ 0x0000000013a54f9f
[2025-10-31T20:32:04.531+0000] {subprocess.py:93} INFO -   3. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x000000001aace132
[2025-10-31T20:32:04.532+0000] {subprocess.py:93} INFO -   4. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018779652
[2025-10-31T20:32:04.532+0000] {subprocess.py:93} INFO -   5. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T20:32:04.533+0000] {subprocess.py:93} INFO -   6. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T20:32:04.533+0000] {subprocess.py:93} INFO -   7. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T20:32:04.534+0000] {subprocess.py:93} INFO -   8. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T20:32:04.535+0000] {subprocess.py:93} INFO -   9. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T20:32:04.535+0000] {subprocess.py:93} INFO -   10. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T20:32:04.536+0000] {subprocess.py:93} INFO -   11. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T20:32:04.537+0000] {subprocess.py:93} INFO -   12. ? @ 0x0000000000094ac3
[2025-10-31T20:32:04.537+0000] {subprocess.py:93} INFO -   13. ? @ 0x0000000000125a74
[2025-10-31T20:32:04.538+0000] {subprocess.py:93} INFO - 20:32:04
[2025-10-31T20:32:04.538+0000] {subprocess.py:93} INFO - 20:32:04    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T20:32:04.539+0000] {subprocess.py:93} INFO - 20:32:04
[2025-10-31T20:32:04.540+0000] {subprocess.py:93} INFO - 20:32:04  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T20:32:05.402+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T20:32:05.418+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T20:32:05.422+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T203201, end_date=20251031T203205
[2025-10-31T20:32:05.437+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 8 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 297)
[2025-10-31T20:32:05.471+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T20:32:05.498+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T21:11:02.515+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T21:11:02.525+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T21:11:02.526+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T21:11:02.540+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T21:11:02.546+0000] {standard_task_runner.py:60} INFO - Started process 804 to run task
[2025-10-31T21:11:02.550+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpz7hw1_ym']
[2025-10-31T21:11:02.554+0000] {standard_task_runner.py:88} INFO - Job 26: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T21:11:02.642+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host c45a3ec2f76e
[2025-10-31T21:11:02.741+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T21:11:02.744+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T21:11:02.746+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T21:11:02.760+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T21:11:04.366+0000] {subprocess.py:93} INFO - 21:11:04  Running with dbt=1.10.13
[2025-10-31T21:11:04.594+0000] {subprocess.py:93} INFO - 21:11:04  Registered adapter: clickhouse=1.9.5
[2025-10-31T21:11:04.770+0000] {subprocess.py:93} INFO - 21:11:04  Unable to do partial parsing because config vars, config profile, or config target have changed
[2025-10-31T21:11:06.437+0000] {subprocess.py:93} INFO - 21:11:06  Found 3 models, 3 sources, 488 macros
[2025-10-31T21:11:06.444+0000] {subprocess.py:93} INFO - 21:11:06
[2025-10-31T21:11:06.446+0000] {subprocess.py:93} INFO - 21:11:06  Concurrency: 4 threads (target='dev')
[2025-10-31T21:11:06.446+0000] {subprocess.py:93} INFO - 21:11:06
[2025-10-31T21:11:06.768+0000] {subprocess.py:93} INFO - 21:11:06  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T21:11:06.896+0000] {subprocess.py:93} INFO - 21:11:06  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.12s]
[2025-10-31T21:11:06.912+0000] {subprocess.py:93} INFO - 21:11:06
[2025-10-31T21:11:06.913+0000] {subprocess.py:93} INFO - 21:11:06  Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[2025-10-31T21:11:07.068+0000] {subprocess.py:93} INFO - 21:11:07
[2025-10-31T21:11:07.069+0000] {subprocess.py:93} INFO - 21:11:07  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T21:11:07.072+0000] {subprocess.py:93} INFO - 21:11:07
[2025-10-31T21:11:07.073+0000] {subprocess.py:93} INFO - 21:11:07  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T21:11:07.075+0000] {subprocess.py:93} INFO - 21:11:07    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T21:11:07.076+0000] {subprocess.py:93} INFO -   Code: 62.
[2025-10-31T21:11:07.076+0000] {subprocess.py:93} INFO -   DB::Exception: Syntax error: failed at position 1187 (end of query) (line 42, col 30): ;
[2025-10-31T21:11:07.077+0000] {subprocess.py:93} INFO -             )
[2025-10-31T21:11:07.078+0000] {subprocess.py:93} INFO - 
[2025-10-31T21:11:07.078+0000] {subprocess.py:93} INFO -           . Expected one of: OR, AND, IS NOT DISTINCT FROM, IS NULL, IS NOT NULL, BETWEEN, NOT BETWEEN, LIKE, ILIKE, NOT LIKE, NOT ILIKE, REGEXP, IN, NOT IN, GLOBAL IN, GLOBAL NOT IN, MOD, DIV, alias, AS, GROUP BY, WITH, HAVING, WINDOW, QUALIFY, ORDER BY, LIMIT, OFFSET, FETCH, SETTINGS, UNION, EXCEPT, INTERSECT. Stack trace:
[2025-10-31T21:11:07.079+0000] {subprocess.py:93} INFO - 
[2025-10-31T21:11:07.079+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T21:11:07.080+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String const&, int, String, bool) @ 0x0000000012423c8e
[2025-10-31T21:11:07.080+0000] {subprocess.py:93} INFO -   2. DB::Exception::createDeprecated(String const&, int, bool) @ 0x0000000013a54f9f
[2025-10-31T21:11:07.081+0000] {subprocess.py:93} INFO -   3. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, String const&, bool, unsigned long, unsigned long, unsigned long) @ 0x000000001aace132
[2025-10-31T21:11:07.081+0000] {subprocess.py:93} INFO -   4. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018779652
[2025-10-31T21:11:07.082+0000] {subprocess.py:93} INFO -   5. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T21:11:07.082+0000] {subprocess.py:93} INFO -   6. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T21:11:07.082+0000] {subprocess.py:93} INFO -   7. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T21:11:07.083+0000] {subprocess.py:93} INFO -   8. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T21:11:07.084+0000] {subprocess.py:93} INFO -   9. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T21:11:07.086+0000] {subprocess.py:93} INFO -   10. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T21:11:07.086+0000] {subprocess.py:93} INFO -   11. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T21:11:07.087+0000] {subprocess.py:93} INFO -   12. ? @ 0x0000000000094ac3
[2025-10-31T21:11:07.088+0000] {subprocess.py:93} INFO -   13. ? @ 0x0000000000125a74
[2025-10-31T21:11:07.089+0000] {subprocess.py:93} INFO - 21:11:07
[2025-10-31T21:11:07.090+0000] {subprocess.py:93} INFO - 21:11:07    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T21:11:07.090+0000] {subprocess.py:93} INFO - 21:11:07
[2025-10-31T21:11:07.090+0000] {subprocess.py:93} INFO - 21:11:07  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T21:11:08.003+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T21:11:08.020+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T21:11:08.025+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T211102, end_date=20251031T211108
[2025-10-31T21:11:08.045+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 26 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 804)
[2025-10-31T21:11:08.092+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T21:11:08.122+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T22:00:24.380+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:00:24.395+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:00:24.396+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T22:00:24.416+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T22:00:24.434+0000] {standard_task_runner.py:60} INFO - Started process 365 to run task
[2025-10-31T22:00:24.429+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpapdbl112']
[2025-10-31T22:00:24.443+0000] {standard_task_runner.py:88} INFO - Job 15: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T22:00:24.613+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host 9dbfb6fb81d8
[2025-10-31T22:00:24.757+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T22:00:24.759+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T22:00:24.761+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T22:00:24.777+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T22:00:26.536+0000] {subprocess.py:93} INFO - 22:00:26  Running with dbt=1.10.13
[2025-10-31T22:00:26.816+0000] {subprocess.py:93} INFO - 22:00:26  Registered adapter: clickhouse=1.9.5
[2025-10-31T22:00:27.559+0000] {subprocess.py:93} INFO - 22:00:27  Found 3 models, 3 sources, 488 macros
[2025-10-31T22:00:27.564+0000] {subprocess.py:93} INFO - 22:00:27
[2025-10-31T22:00:27.565+0000] {subprocess.py:93} INFO - 22:00:27  Concurrency: 4 threads (target='dev')
[2025-10-31T22:00:27.567+0000] {subprocess.py:93} INFO - 22:00:27
[2025-10-31T22:00:28.211+0000] {subprocess.py:93} INFO - 22:00:28  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T22:00:28.355+0000] {subprocess.py:93} INFO - 22:00:28  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.14s]
[2025-10-31T22:00:28.366+0000] {subprocess.py:93} INFO - 22:00:28
[2025-10-31T22:00:28.367+0000] {subprocess.py:93} INFO - 22:00:28  Finished running 1 table model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[2025-10-31T22:00:28.439+0000] {subprocess.py:93} INFO - 22:00:28
[2025-10-31T22:00:28.440+0000] {subprocess.py:93} INFO - 22:00:28  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T22:00:28.442+0000] {subprocess.py:93} INFO - 22:00:28
[2025-10-31T22:00:28.444+0000] {subprocess.py:93} INFO - 22:00:28  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T22:00:28.446+0000] {subprocess.py:93} INFO - 22:00:28    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T22:00:28.447+0000] {subprocess.py:93} INFO -   Code: 60.
[2025-10-31T22:00:28.448+0000] {subprocess.py:93} INFO -   DB::Exception: Unknown table expression identifier 'bronze.merchants' in scope  src. Stack trace:
[2025-10-31T22:00:28.449+0000] {subprocess.py:93} INFO - 
[2025-10-31T22:00:28.449+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T22:00:28.450+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[2025-10-31T22:00:28.451+0000] {subprocess.py:93} INFO -   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[2025-10-31T22:00:28.453+0000] {subprocess.py:93} INFO -   3. DB::Exception::Exception<String const&, String>(int, FormatStringHelperImpl<std::type_identity<String const&>::type, std::type_identity<String>::type>, String const&, String&&) @ 0x000000000db773ab
[2025-10-31T22:00:28.453+0000] {subprocess.py:93} INFO -   4. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x0000000017830745
[2025-10-31T22:00:28.454+0000] {subprocess.py:93} INFO -   5. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[2025-10-31T22:00:28.455+0000] {subprocess.py:93} INFO -   6. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[2025-10-31T22:00:28.455+0000] {subprocess.py:93} INFO -   7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[2025-10-31T22:00:28.456+0000] {subprocess.py:93} INFO -   8. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[2025-10-31T22:00:28.456+0000] {subprocess.py:93} INFO -   9. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[2025-10-31T22:00:28.457+0000] {subprocess.py:93} INFO -   10. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[2025-10-31T22:00:28.457+0000] {subprocess.py:93} INFO -   11. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[2025-10-31T22:00:28.458+0000] {subprocess.py:93} INFO -   12. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[2025-10-31T22:00:28.458+0000] {subprocess.py:93} INFO -   13. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[2025-10-31T22:00:28.459+0000] {subprocess.py:93} INFO -   14. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[2025-10-31T22:00:28.459+0000] {subprocess.py:93} INFO -   15. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[2025-10-31T22:00:28.460+0000] {subprocess.py:93} INFO -   16. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[2025-10-31T22:00:28.460+0000] {subprocess.py:93} INFO -   17. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[2025-10-31T22:00:28.461+0000] {subprocess.py:93} INFO -   18. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T22:00:28.462+0000] {subprocess.py:93} INFO -   19. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T22:00:28.462+0000] {subprocess.py:93} INFO -   20. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T22:00:28.463+0000] {subprocess.py:93} INFO -   21. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T22:00:28.464+0000] {subprocess.py:93} INFO -   22. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T22:00:28.465+0000] {subprocess.py:93} INFO -   23. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T22:00:28.465+0000] {subprocess.py:93} INFO -   24. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T22:00:28.466+0000] {subprocess.py:93} INFO -   25. ? @ 0x0000000000094ac3
[2025-10-31T22:00:28.467+0000] {subprocess.py:93} INFO -   26. ? @ 0x0000000000125a74
[2025-10-31T22:00:28.469+0000] {subprocess.py:93} INFO - 22:00:28
[2025-10-31T22:00:28.469+0000] {subprocess.py:93} INFO - 22:00:28    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T22:00:28.470+0000] {subprocess.py:93} INFO - 22:00:28
[2025-10-31T22:00:28.471+0000] {subprocess.py:93} INFO - 22:00:28  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T22:00:29.347+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T22:00:29.363+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T22:00:29.367+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T220024, end_date=20251031T220029
[2025-10-31T22:00:29.383+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 15 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 365)
[2025-10-31T22:00:29.397+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T22:00:29.427+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T22:13:40.843+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:13:40.856+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:13:40.858+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T22:13:40.881+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T22:13:40.890+0000] {standard_task_runner.py:60} INFO - Started process 312 to run task
[2025-10-31T22:13:40.896+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmp31earxo8']
[2025-10-31T22:13:40.900+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T22:13:41.006+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host 68d81e27198f
[2025-10-31T22:13:41.139+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T22:13:41.145+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T22:13:41.147+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T22:13:41.163+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T22:13:43.872+0000] {subprocess.py:93} INFO - 22:13:43  Running with dbt=1.10.13
[2025-10-31T22:13:44.300+0000] {subprocess.py:93} INFO - 22:13:44  Registered adapter: clickhouse=1.9.5
[2025-10-31T22:13:44.546+0000] {subprocess.py:93} INFO - 22:13:44  Unable to do partial parsing because config vars, config profile, or config target have changed
[2025-10-31T22:13:47.112+0000] {subprocess.py:93} INFO - 22:13:47  Found 3 models, 3 sources, 488 macros
[2025-10-31T22:13:47.119+0000] {subprocess.py:93} INFO - 22:13:47
[2025-10-31T22:13:47.120+0000] {subprocess.py:93} INFO - 22:13:47  Concurrency: 4 threads (target='dev')
[2025-10-31T22:13:47.122+0000] {subprocess.py:93} INFO - 22:13:47
[2025-10-31T22:13:47.649+0000] {subprocess.py:93} INFO - 22:13:47  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T22:13:47.814+0000] {subprocess.py:93} INFO - 22:13:47  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.16s]
[2025-10-31T22:13:47.834+0000] {subprocess.py:93} INFO - 22:13:47
[2025-10-31T22:13:47.835+0000] {subprocess.py:93} INFO - 22:13:47  Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[2025-10-31T22:13:47.925+0000] {subprocess.py:93} INFO - 22:13:47
[2025-10-31T22:13:47.927+0000] {subprocess.py:93} INFO - 22:13:47  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T22:13:47.931+0000] {subprocess.py:93} INFO - 22:13:47
[2025-10-31T22:13:47.932+0000] {subprocess.py:93} INFO - 22:13:47  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T22:13:47.935+0000] {subprocess.py:93} INFO - 22:13:47    Database Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T22:13:47.935+0000] {subprocess.py:93} INFO -   Code: 60.
[2025-10-31T22:13:47.936+0000] {subprocess.py:93} INFO -   DB::Exception: Unknown table expression identifier 'bronze.merchants' in scope  src. Stack trace:
[2025-10-31T22:13:47.937+0000] {subprocess.py:93} INFO - 
[2025-10-31T22:13:47.937+0000] {subprocess.py:93} INFO -   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[2025-10-31T22:13:47.938+0000] {subprocess.py:93} INFO -   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[2025-10-31T22:13:47.939+0000] {subprocess.py:93} INFO -   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[2025-10-31T22:13:47.939+0000] {subprocess.py:93} INFO -   3. DB::Exception::Exception<String const&, String>(int, FormatStringHelperImpl<std::type_identity<String const&>::type, std::type_identity<String>::type>, String const&, String&&) @ 0x000000000db773ab
[2025-10-31T22:13:47.944+0000] {subprocess.py:93} INFO -   4. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x0000000017830745
[2025-10-31T22:13:47.945+0000] {subprocess.py:93} INFO -   5. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[2025-10-31T22:13:47.946+0000] {subprocess.py:93} INFO -   6. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[2025-10-31T22:13:47.946+0000] {subprocess.py:93} INFO -   7. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[2025-10-31T22:13:47.947+0000] {subprocess.py:93} INFO -   8. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[2025-10-31T22:13:47.948+0000] {subprocess.py:93} INFO -   9. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[2025-10-31T22:13:47.949+0000] {subprocess.py:93} INFO -   10. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[2025-10-31T22:13:47.950+0000] {subprocess.py:93} INFO -   11. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[2025-10-31T22:13:47.956+0000] {subprocess.py:93} INFO -   12. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[2025-10-31T22:13:47.956+0000] {subprocess.py:93} INFO -   13. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[2025-10-31T22:13:47.957+0000] {subprocess.py:93} INFO -   14. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[2025-10-31T22:13:47.958+0000] {subprocess.py:93} INFO -   15. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[2025-10-31T22:13:47.959+0000] {subprocess.py:93} INFO -   16. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[2025-10-31T22:13:47.960+0000] {subprocess.py:93} INFO -   17. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[2025-10-31T22:13:47.961+0000] {subprocess.py:93} INFO -   18. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[2025-10-31T22:13:47.966+0000] {subprocess.py:93} INFO -   19. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[2025-10-31T22:13:47.967+0000] {subprocess.py:93} INFO -   20. DB::TCPHandler::run() @ 0x0000000019e4f119
[2025-10-31T22:13:47.967+0000] {subprocess.py:93} INFO -   21. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[2025-10-31T22:13:47.968+0000] {subprocess.py:93} INFO -   22. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[2025-10-31T22:13:47.969+0000] {subprocess.py:93} INFO -   23. Poco::PooledThread::run() @ 0x000000001ef15b87
[2025-10-31T22:13:47.969+0000] {subprocess.py:93} INFO -   24. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[2025-10-31T22:13:47.970+0000] {subprocess.py:93} INFO -   25. ? @ 0x0000000000094ac3
[2025-10-31T22:13:47.971+0000] {subprocess.py:93} INFO -   26. ? @ 0x0000000000125a74
[2025-10-31T22:13:47.975+0000] {subprocess.py:93} INFO - 22:13:47
[2025-10-31T22:13:47.976+0000] {subprocess.py:93} INFO - 22:13:47    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T22:13:47.978+0000] {subprocess.py:93} INFO - 22:13:47
[2025-10-31T22:13:47.979+0000] {subprocess.py:93} INFO - 22:13:47  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T22:13:48.886+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T22:13:48.913+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T22:13:48.922+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T221340, end_date=20251031T221348
[2025-10-31T22:13:48.954+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 14 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 312)
[2025-10-31T22:13:49.001+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T22:13:49.042+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T22:47:08.538+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:47:08.553+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:47:08.554+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T22:47:08.584+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T22:47:08.593+0000] {standard_task_runner.py:60} INFO - Started process 423 to run task
[2025-10-31T22:47:08.601+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpqm2womj2']
[2025-10-31T22:47:08.605+0000] {standard_task_runner.py:88} INFO - Job 14: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T22:47:08.741+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host d335ca5d7801
[2025-10-31T22:47:08.888+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T22:47:08.891+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T22:47:08.893+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'docker exec -i dbt bash -lc \'set -e; docker exec -i clickhouse-server clickhouse-client -q "CREATE DATABASE IF NOT EXISTS silver;"; set +e; cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh; RC=$?; if [ $RC -ne 0 ]; then   echo "[silver/dbt] WARNING: silver_merchants failed (rc=$RC). Skipping this step and continuing the pipeline.";   # Optional: show compiled SQL path for quick debugging (if it exists)\n  test -d target/compiled &&   echo "[silver/dbt] See compiled SQL under target/compiled/";   exit 0; fi; exit 0;\'']
[2025-10-31T22:47:08.912+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T22:47:09.078+0000] {subprocess.py:93} INFO - bash: line 1: docker: command not found
[2025-10-31T22:47:09.086+0000] {subprocess.py:97} INFO - Command exited with return code 127
[2025-10-31T22:47:09.104+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 127.
[2025-10-31T22:47:09.110+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T224708, end_date=20251031T224709
[2025-10-31T22:47:09.134+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 14 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 127.; 423)
[2025-10-31T22:47:09.175+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T22:47:09.202+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-31T22:58:44.882+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:58:44.897+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-10-31T22:58:44.898+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-10-31T22:58:44.916+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-10-31T22:58:44.925+0000] {standard_task_runner.py:60} INFO - Started process 385 to run task
[2025-10-31T22:58:44.932+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpiyv7fqv8']
[2025-10-31T22:58:44.936+0000] {standard_task_runner.py:88} INFO - Job 13: Subtask silver_dbt.dbt_run_merchants
[2025-10-31T22:58:45.041+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host ad620feb6bee
[2025-10-31T22:58:45.172+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-10-31T22:58:45.175+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-31T22:58:45.177+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'set -e; cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-10-31T22:58:45.188+0000] {subprocess.py:86} INFO - Output:
[2025-10-31T22:58:47.928+0000] {subprocess.py:93} INFO - 22:58:47  Running with dbt=1.10.13
[2025-10-31T22:58:48.309+0000] {subprocess.py:93} INFO - 22:58:48  Registered adapter: clickhouse=1.9.5
[2025-10-31T22:58:48.640+0000] {subprocess.py:93} INFO - 22:58:48  Unable to do partial parsing because config vars, config profile, or config target have changed
[2025-10-31T22:58:50.668+0000] {subprocess.py:93} INFO - 22:58:50  Found 3 models, 3 sources, 491 macros
[2025-10-31T22:58:50.680+0000] {subprocess.py:93} INFO - 22:58:50
[2025-10-31T22:58:50.683+0000] {subprocess.py:93} INFO - 22:58:50  Concurrency: 4 threads (target='dev')
[2025-10-31T22:58:50.686+0000] {subprocess.py:93} INFO - 22:58:50
[2025-10-31T22:58:51.029+0000] {subprocess.py:93} INFO - 22:58:51  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-10-31T22:58:51.100+0000] {subprocess.py:93} INFO - 22:58:51  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.07s]
[2025-10-31T22:58:51.113+0000] {subprocess.py:93} INFO - 22:58:51
[2025-10-31T22:58:51.115+0000] {subprocess.py:93} INFO - 22:58:51  Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[2025-10-31T22:58:51.205+0000] {subprocess.py:93} INFO - 22:58:51
[2025-10-31T22:58:51.207+0000] {subprocess.py:93} INFO - 22:58:51  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-10-31T22:58:51.210+0000] {subprocess.py:93} INFO - 22:58:51
[2025-10-31T22:58:51.212+0000] {subprocess.py:93} INFO - 22:58:51  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T22:58:51.214+0000] {subprocess.py:93} INFO - 22:58:51    Compilation Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T22:58:51.215+0000] {subprocess.py:93} INFO -   macro 'dbt_macro__clickhouse__create_table_as' takes not more than 2 argument(s)
[2025-10-31T22:58:51.215+0000] {subprocess.py:93} INFO - 
[2025-10-31T22:58:51.216+0000] {subprocess.py:93} INFO -   > in macro create_table_as (macros/relations/table/create.sql)
[2025-10-31T22:58:51.217+0000] {subprocess.py:93} INFO -   > called by macro default__get_create_table_as_sql (macros/relations/table/create.sql)
[2025-10-31T22:58:51.218+0000] {subprocess.py:93} INFO -   > called by macro get_create_table_as_sql (macros/relations/table/create.sql)
[2025-10-31T22:58:51.219+0000] {subprocess.py:93} INFO -   > called by macro statement (macros/etc/statement.sql)
[2025-10-31T22:58:51.220+0000] {subprocess.py:93} INFO -   > called by macro materialization_table_clickhouse (macros/materializations/table.sql)
[2025-10-31T22:58:51.221+0000] {subprocess.py:93} INFO -   > called by model silver_merchants (models/silver/silver_merchants.sql)
[2025-10-31T22:58:51.222+0000] {subprocess.py:93} INFO - 22:58:51
[2025-10-31T22:58:51.222+0000] {subprocess.py:93} INFO - 22:58:51    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-10-31T22:58:51.223+0000] {subprocess.py:93} INFO - 22:58:51
[2025-10-31T22:58:51.224+0000] {subprocess.py:93} INFO - 22:58:51  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-10-31T22:58:52.310+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-31T22:58:52.338+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-31T22:58:52.345+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251031T225844, end_date=20251031T225852
[2025-10-31T22:58:52.372+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 13 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 385)
[2025-10-31T22:58:52.425+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-10-31T22:58:52.466+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-11-01T11:40:54.215+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T11:40:54.254+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [queued]>
[2025-11-01T11:40:54.256+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-11-01T11:40:54.303+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): silver_dbt.dbt_run_merchants> on 2025-10-30 00:00:00+00:00
[2025-11-01T11:40:54.320+0000] {standard_task_runner.py:60} INFO - Started process 533 to run task
[2025-11-01T11:40:54.324+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ingestion_pipeline', 'silver_dbt.dbt_run_merchants', 'scheduled__2025-10-30T00:00:00+00:00', '--job-id', '20', '--raw', '--subdir', 'DAGS_FOLDER/ingestion_dag.py', '--cfg-path', '/tmp/tmpg0hsuw8s']
[2025-11-01T11:40:54.338+0000] {standard_task_runner.py:88} INFO - Job 20: Subtask silver_dbt.dbt_run_merchants
[2025-11-01T11:40:54.629+0000] {task_command.py:423} INFO - Running <TaskInstance: ingestion_pipeline.silver_dbt.dbt_run_merchants scheduled__2025-10-30T00:00:00+00:00 [running]> on host 6ac9b46937d1
[2025-11-01T11:40:54.926+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='ingestion_pipeline' AIRFLOW_CTX_TASK_ID='silver_dbt.dbt_run_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-10-30T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-30T00:00:00+00:00'
[2025-11-01T11:40:54.933+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-01T11:40:54.936+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "docker exec -i dbt bash -lc 'cd /dbt && dbt --no-use-colors run --profiles-dir /dbt --select silver_merchants --full-refresh'"]
[2025-11-01T11:40:54.970+0000] {subprocess.py:86} INFO - Output:
[2025-11-01T11:41:00.294+0000] {subprocess.py:93} INFO - 11:41:00  Running with dbt=1.10.13
[2025-11-01T11:41:01.173+0000] {subprocess.py:93} INFO - 11:41:01  Registered adapter: clickhouse=1.9.5
[2025-11-01T11:41:01.688+0000] {subprocess.py:93} INFO - 11:41:01  Unable to do partial parsing because config vars, config profile, or config target have changed
[2025-11-01T11:41:05.891+0000] {subprocess.py:93} INFO - 11:41:05  Found 3 models, 3 sources, 491 macros
[2025-11-01T11:41:05.892+0000] {subprocess.py:93} INFO - 11:41:05
[2025-11-01T11:41:05.900+0000] {subprocess.py:93} INFO - 11:41:05  Concurrency: 4 threads (target='dev')
[2025-11-01T11:41:05.918+0000] {subprocess.py:93} INFO - 11:41:05
[2025-11-01T11:41:06.747+0000] {subprocess.py:93} INFO - 11:41:06  1 of 1 START sql table model `silver`.`silver_merchants` ....................... [RUN]
[2025-11-01T11:41:06.888+0000] {subprocess.py:93} INFO - 11:41:06  1 of 1 ERROR creating sql table model `silver`.`silver_merchants` .............. [ERROR in 0.13s]
[2025-11-01T11:41:06.910+0000] {subprocess.py:93} INFO - 11:41:06
[2025-11-01T11:41:06.914+0000] {subprocess.py:93} INFO - 11:41:06  Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[2025-11-01T11:41:07.189+0000] {subprocess.py:93} INFO - 11:41:07
[2025-11-01T11:41:07.207+0000] {subprocess.py:93} INFO - 11:41:07  Completed with 1 error, 0 partial successes, and 0 warnings:
[2025-11-01T11:41:07.208+0000] {subprocess.py:93} INFO - 11:41:07
[2025-11-01T11:41:07.215+0000] {subprocess.py:93} INFO - 11:41:07  Failure in model silver_merchants (models/silver/silver_merchants.sql)
[2025-11-01T11:41:07.224+0000] {subprocess.py:93} INFO - 11:41:07    Compilation Error in model silver_merchants (models/silver/silver_merchants.sql)
[2025-11-01T11:41:07.225+0000] {subprocess.py:93} INFO -   macro 'dbt_macro__clickhouse__create_table_as' takes not more than 2 argument(s)
[2025-11-01T11:41:07.227+0000] {subprocess.py:93} INFO - 
[2025-11-01T11:41:07.229+0000] {subprocess.py:93} INFO -   > in macro create_table_as (macros/relations/table/create.sql)
[2025-11-01T11:41:07.230+0000] {subprocess.py:93} INFO -   > called by macro default__get_create_table_as_sql (macros/relations/table/create.sql)
[2025-11-01T11:41:07.230+0000] {subprocess.py:93} INFO -   > called by macro get_create_table_as_sql (macros/relations/table/create.sql)
[2025-11-01T11:41:07.231+0000] {subprocess.py:93} INFO -   > called by macro statement (macros/etc/statement.sql)
[2025-11-01T11:41:07.233+0000] {subprocess.py:93} INFO -   > called by macro materialization_table_clickhouse (macros/materializations/table.sql)
[2025-11-01T11:41:07.234+0000] {subprocess.py:93} INFO -   > called by model silver_merchants (models/silver/silver_merchants.sql)
[2025-11-01T11:41:07.237+0000] {subprocess.py:93} INFO - 11:41:07
[2025-11-01T11:41:07.241+0000] {subprocess.py:93} INFO - 11:41:07    compiled code at target/compiled/ck_project/models/silver/silver_merchants.sql
[2025-11-01T11:41:07.245+0000] {subprocess.py:93} INFO - 11:41:07
[2025-11-01T11:41:07.250+0000] {subprocess.py:93} INFO - 11:41:07  Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[2025-11-01T11:41:08.514+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-11-01T11:41:08.546+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 212, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-11-01T11:41:08.555+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=ingestion_pipeline, task_id=silver_dbt.dbt_run_merchants, execution_date=20251030T000000, start_date=20251101T114054, end_date=20251101T114108
[2025-11-01T11:41:08.586+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 20 for task silver_dbt.dbt_run_merchants (Bash command failed. The command returned a non-zero exit code 1.; 533)
[2025-11-01T11:41:08.612+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-11-01T11:41:08.679+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
