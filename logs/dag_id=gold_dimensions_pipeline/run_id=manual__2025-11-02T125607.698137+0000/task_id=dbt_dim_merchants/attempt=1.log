[2025-11-02T12:56:09.149+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: gold_dimensions_pipeline.dbt_dim_merchants manual__2025-11-02T12:56:07.698137+00:00 [queued]>
[2025-11-02T12:56:09.179+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: gold_dimensions_pipeline.dbt_dim_merchants manual__2025-11-02T12:56:07.698137+00:00 [queued]>
[2025-11-02T12:56:09.184+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 3
[2025-11-02T12:56:09.222+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): dbt_dim_merchants> on 2025-11-02 12:56:07.698137+00:00
[2025-11-02T12:56:09.242+0000] {standard_task_runner.py:60} INFO - Started process 10695 to run task
[2025-11-02T12:56:09.240+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'gold_dimensions_pipeline', 'dbt_dim_merchants', 'manual__2025-11-02T12:56:07.698137+00:00', '--job-id', '403', '--raw', '--subdir', 'DAGS_FOLDER/gold_dag.py', '--cfg-path', '/tmp/tmpfm1qt4ub']
[2025-11-02T12:56:09.252+0000] {standard_task_runner.py:88} INFO - Job 403: Subtask dbt_dim_merchants
[2025-11-02T12:56:09.478+0000] {task_command.py:423} INFO - Running <TaskInstance: gold_dimensions_pipeline.dbt_dim_merchants manual__2025-11-02T12:56:07.698137+00:00 [running]> on host 0d39d4365eb9
[2025-11-02T12:56:09.719+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='gold_dimensions_pipeline' AIRFLOW_CTX_TASK_ID='dbt_dim_merchants' AIRFLOW_CTX_EXECUTION_DATE='2025-11-02T12:56:07.698137+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-02T12:56:07.698137+00:00'
[2025-11-02T12:56:19.423+0000] {logging_mixin.py:188} INFO - ==== DBT STDOUT ====
[2025-11-02T12:56:19.429+0000] {logging_mixin.py:188} INFO - 12:56:17  Running with dbt=1.5.9
12:56:17  Registered adapter: clickhouse=1.5.2
12:56:18  Encountered an error:
Field "files" of type Union[SchemaSourceFile, SourceFile] in Manifest has invalid value SchemaSourceFile(path=FilePath(searched_path='models', relative_path='gold/fact/_schema.yml', modification_time=1762087704.6880863, project_root='/opt/***/dbt_project'), checksum=FileHash(name='sha256', checksum='e2e3f595ee7565079c6d59a1b282b245fa3b477bcda17aa75ccf66bd7e405266'), project_name='ck_project', parse_file_type=<ParseFileType.Schema: 'schema'>, contents='- name: fact_transactions\r\n  description: "Transaction ↔ payment evaluation fact"\r\n  columns:\r\n    - name: surrogate_key\r\n      tests: [not_null, unique]\r\n    - name: transactions_id\r\n      tests: [not_null]\r\n    - name: payment_reference\r\n    - name: state_sk\r\n    - name: merchant_sk\r\n    - name: payment_method_sk\r\n    - name: IsSuccessfulFinalPayment\r\n    - name: TimeBetweenInitiationAndPaymentMinutes\r\n    - name: datekey\r\n      tests: [not_null]', dfy=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], tests={}, sources=[], exposures=[], metrics=[], groups=[], ndp=[], mcp={}, sop=[], env_vars={}, pp_dict=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], pp_test_index=None)
12:56:18  Traceback (most recent call last):
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 242, in wrapper
    manifest = ManifestLoader.get_full_manifest(
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 227, in get_full_manifest
    manifest = loader.load()
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 446, in load
    self.write_manifest_for_partial_parse()
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 593, in write_manifest_for_partial_parse
    manifest_msgpack = self.manifest.to_msgpack()
  File "<string>", line 12, in to_msgpack
  File "<string>", line 12, in <dictcomp>
  File "<string>", line 10, in __pack_union_Manifest_files__7b794a42fd7e4743847ab782a7fe91a4
mashumaro.exceptions.InvalidFieldValue: Field "files" of type Union[SchemaSourceFile, SourceFile] in Manifest has invalid value SchemaSourceFile(path=FilePath(searched_path='models', relative_path='gold/fact/_schema.yml', modification_time=1762087704.6880863, project_root='/opt/***/dbt_project'), checksum=FileHash(name='sha256', checksum='e2e3f595ee7565079c6d59a1b282b245fa3b477bcda17aa75ccf66bd7e405266'), project_name='ck_project', parse_file_type=<ParseFileType.Schema: 'schema'>, contents='- name: fact_transactions\r\n  description: "Transaction ↔ payment evaluation fact"\r\n  columns:\r\n    - name: surrogate_key\r\n      tests: [not_null, unique]\r\n    - name: transactions_id\r\n      tests: [not_null]\r\n    - name: payment_reference\r\n    - name: state_sk\r\n    - name: merchant_sk\r\n    - name: payment_method_sk\r\n    - name: IsSuccessfulFinalPayment\r\n    - name: TimeBetweenInitiationAndPaymentMinutes\r\n    - name: datekey\r\n      tests: [not_null]', dfy=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], tests={}, sources=[], exposures=[], metrics=[], groups=[], ndp=[], mcp={}, sop=[], env_vars={}, pp_dict=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], pp_test_index=None)
[2025-11-02T12:56:19.431+0000] {logging_mixin.py:188} INFO - ==== DBT STDERR ====
[2025-11-02T12:56:19.432+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/gold_dag.py", line 133, in <lambda>
    python_callable=lambda **_: _run_dbt("dim_merchants"),
  File "/opt/airflow/dags/gold_dag.py", line 85, in _run_dbt
    raise RuntimeError(
RuntimeError: dbt failed (2).
STDOUT:
12:56:17  Running with dbt=1.5.9
12:56:17  Registered adapter: clickhouse=1.5.2
12:56:18  Encountered an error:
Field "files" of type Union[SchemaSourceFile, SourceFile] in Manifest has invalid value SchemaSourceFile(path=FilePath(searched_path='models', relative_path='gold/fact/_schema.yml', modification_time=1762087704.6880863, project_root='/opt/***/dbt_project'), checksum=FileHash(name='sha256', checksum='e2e3f595ee7565079c6d59a1b282b245fa3b477bcda17aa75ccf66bd7e405266'), project_name='ck_project', parse_file_type=<ParseFileType.Schema: 'schema'>, contents='- name: fact_transactions\r\n  description: "Transaction ↔ payment evaluation fact"\r\n  columns:\r\n    - name: surrogate_key\r\n      tests: [not_null, unique]\r\n    - name: transactions_id\r\n      tests: [not_null]\r\n    - name: payment_reference\r\n    - name: state_sk\r\n    - name: merchant_sk\r\n    - name: payment_method_sk\r\n    - name: IsSuccessfulFinalPayment\r\n    - name: TimeBetweenInitiationAndPaymentMinutes\r\n    - name: datekey\r\n      tests: [not_null]', dfy=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], tests={}, sources=[], exposures=[], metrics=[], groups=[], ndp=[], mcp={}, sop=[], env_vars={}, pp_dict=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], pp_test_index=None)
12:56:18  Traceback (most recent call last):
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 242, in wrapper
    manifest = ManifestLoader.get_full_manifest(
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 227, in get_full_manifest
    manifest = loader.load()
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 446, in load
    self.write_manifest_for_partial_parse()
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 593, in write_manifest_for_partial_parse
    manifest_msgpack = self.manifest.to_msgpack()
  File "<string>", line 12, in to_msgpack
  File "<string>", line 12, in <dictcomp>
  File "<string>", line 10, in __pack_union_Manifest_files__7b794a42fd7e4743847ab782a7fe91a4
mashumaro.exceptions.InvalidFieldValue: Field "files" of type Union[SchemaSourceFile, SourceFile] in Manifest has invalid value SchemaSourceFile(path=FilePath(searched_path='models', relative_path='gold/fact/_schema.yml', modification_time=1762087704.6880863, project_root='/opt/***/dbt_project'), checksum=FileHash(name='sha256', checksum='e2e3f595ee7565079c6d59a1b282b245fa3b477bcda17aa75ccf66bd7e405266'), project_name='ck_project', parse_file_type=<ParseFileType.Schema: 'schema'>, contents='- name: fact_transactions\r\n  description: "Transaction ↔ payment evaluation fact"\r\n  columns:\r\n    - name: surrogate_key\r\n      tests: [not_null, unique]\r\n    - name: transactions_id\r\n      tests: [not_null]\r\n    - name: payment_reference\r\n    - name: state_sk\r\n    - name: merchant_sk\r\n    - name: payment_method_sk\r\n    - name: IsSuccessfulFinalPayment\r\n    - name: TimeBetweenInitiationAndPaymentMinutes\r\n    - name: datekey\r\n      tests: [not_null]', dfy=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], tests={}, sources=[], exposures=[], metrics=[], groups=[], ndp=[], mcp={}, sop=[], env_vars={}, pp_dict=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], pp_test_index=None)



STDERR:

[2025-11-02T12:56:19.460+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=gold_dimensions_pipeline, task_id=dbt_dim_merchants, execution_date=20251102T125607, start_date=20251102T125609, end_date=20251102T125619
[2025-11-02T12:56:19.510+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 403 for task dbt_dim_merchants (dbt failed (2).
STDOUT:
12:56:17  Running with dbt=1.5.9
12:56:17  Registered adapter: clickhouse=1.5.2
12:56:18  Encountered an error:
Field "files" of type Union[SchemaSourceFile, SourceFile] in Manifest has invalid value SchemaSourceFile(path=FilePath(searched_path='models', relative_path='gold/fact/_schema.yml', modification_time=1762087704.6880863, project_root='/opt/***/dbt_project'), checksum=FileHash(name='sha256', checksum='e2e3f595ee7565079c6d59a1b282b245fa3b477bcda17aa75ccf66bd7e405266'), project_name='ck_project', parse_file_type=<ParseFileType.Schema: 'schema'>, contents='- name: fact_transactions\r\n  description: "Transaction ↔ payment evaluation fact"\r\n  columns:\r\n    - name: surrogate_key\r\n      tests: [not_null, unique]\r\n    - name: transactions_id\r\n      tests: [not_null]\r\n    - name: payment_reference\r\n    - name: state_sk\r\n    - name: merchant_sk\r\n    - name: payment_method_sk\r\n    - name: IsSuccessfulFinalPayment\r\n    - name: TimeBetweenInitiationAndPaymentMinutes\r\n    - name: datekey\r\n      tests: [not_null]', dfy=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], tests={}, sources=[], exposures=[], metrics=[], groups=[], ndp=[], mcp={}, sop=[], env_vars={}, pp_dict=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], pp_test_index=None)
12:56:18  Traceback (most recent call last):
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/***/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 242, in wrapper
    manifest = ManifestLoader.get_full_manifest(
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 227, in get_full_manifest
    manifest = loader.load()
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 446, in load
    self.write_manifest_for_partial_parse()
  File "/home/***/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 593, in write_manifest_for_partial_parse
    manifest_msgpack = self.manifest.to_msgpack()
  File "<string>", line 12, in to_msgpack
  File "<string>", line 12, in <dictcomp>
  File "<string>", line 10, in __pack_union_Manifest_files__7b794a42fd7e4743847ab782a7fe91a4
mashumaro.exceptions.InvalidFieldValue: Field "files" of type Union[SchemaSourceFile, SourceFile] in Manifest has invalid value SchemaSourceFile(path=FilePath(searched_path='models', relative_path='gold/fact/_schema.yml', modification_time=1762087704.6880863, project_root='/opt/***/dbt_project'), checksum=FileHash(name='sha256', checksum='e2e3f595ee7565079c6d59a1b282b245fa3b477bcda17aa75ccf66bd7e405266'), project_name='ck_project', parse_file_type=<ParseFileType.Schema: 'schema'>, contents='- name: fact_transactions\r\n  description: "Transaction ↔ payment evaluation fact"\r\n  columns:\r\n    - name: surrogate_key\r\n      tests: [not_null, unique]\r\n    - name: transactions_id\r\n      tests: [not_null]\r\n    - name: payment_reference\r\n    - name: state_sk\r\n    - name: merchant_sk\r\n    - name: payment_method_sk\r\n    - name: IsSuccessfulFinalPayment\r\n    - name: TimeBetweenInitiationAndPaymentMinutes\r\n    - name: datekey\r\n      tests: [not_null]', dfy=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], tests={}, sources=[], exposures=[], metrics=[], groups=[], ndp=[], mcp={}, sop=[], env_vars={}, pp_dict=[{'name': 'fact_transactions', 'description': 'Transaction ↔ payment evaluation fact', 'columns': [{'name': 'surrogate_key', 'tests': ['not_null', 'unique']}, {'name': 'transactions_id', 'tests': ['not_null']}, {'name': 'payment_reference'}, {'name': 'state_sk'}, {'name': 'merchant_sk'}, {'name': 'payment_method_sk'}, {'name': 'IsSuccessfulFinalPayment'}, {'name': 'TimeBetweenInitiationAndPaymentMinutes'}, {'name': 'datekey', 'tests': ['not_null']}]}], pp_test_index=None)



STDERR:
; 10695)
[2025-11-02T12:56:19.550+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-11-02T12:56:19.600+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
