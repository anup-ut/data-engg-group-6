[0m11:38:34.889780 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 44.
  DB::Exception: Sorting key contains nullable columns, but merge tree setting `allow_nullable_key` is disabled. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String const&>(int, FormatStringHelperImpl<std::type_identity<String const&>::type>, String const&) @ 0x000000000de374eb
  4. DB::checkKeyExpression(DB::ExpressionActions const&, DB::Block const&, String const&, bool) @ 0x00000000195d4ae2
  5. DB::MergeTreeData::checkProperties(DB::StorageInMemoryMetadata const&, DB::StorageInMemoryMetadata const&, bool, bool, bool, bool, std::shared_ptr<DB::Context const>) const @ 0x00000000195d36f0
  6. DB::MergeTreeData::setProperties(DB::StorageInMemoryMetadata const&, DB::StorageInMemoryMetadata const&, bool, std::shared_ptr<DB::Context const>) @ 0x00000000195c8fb8
  7. DB::MergeTreeData::MergeTreeData(DB::StorageID const&, DB::StorageInMemoryMetadata const&, std::shared_ptr<DB::Context>, String const&, DB::MergeTreeData::MergingParams const&, std::unique_ptr<DB::MergeTreeSettings, std::default_delete<DB::MergeTreeSettings>>, bool, DB::LoadingStrictnessLevel, std::function<void (String const&)>) @ 0x00000000195c61d2
  8. DB::StorageMergeTree::StorageMergeTree(DB::StorageID const&, String const&, DB::StorageInMemoryMetadata const&, DB::LoadingStrictnessLevel, std::shared_ptr<DB::Context>, String const&, DB::MergeTreeData::MergingParams const&, std::unique_ptr<DB::MergeTreeSettings, std::default_delete<DB::MergeTreeSettings>>) @ 0x0000000019572e26
  9. DB::create(DB::StorageFactory::Arguments const&) @ 0x0000000019a60f2d
  10. DB::StorageFactory::get(DB::ASTCreateQuery const&, String const&, std::shared_ptr<DB::Context>, std::shared_ptr<DB::Context>, DB::ColumnsDescription const&, DB::ConstraintsDescription const&, DB::LoadingStrictnessLevel, bool) const @ 0x0000000018e40d7b
  11. DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&, DB::LoadingStrictnessLevel) @ 0x00000000182fb075
  12. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ef810
  13. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  14. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  15. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  16. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  17. DB::TCPHandler::run() @ 0x0000000019e4f119
  18. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  19. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  20. Poco::PooledThread::run() @ 0x000000001ef15b87
  21. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
  22. ? @ 0x0000000000094ac3
  23. ? @ 0x0000000000125a74
[0m11:38:34.901642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc2c700-2b84-44ea-a03c-b9dfb50561d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c938b17ac0>]}
[0m11:38:34.903437 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.17s]
[0m11:38:34.905507 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m11:38:34.909917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:34.911243 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m11:38:34.912566 [debug] [MainThread]: On list__silver: Close
[0m11:38:34.914269 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m11:38:34.917970 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m11:38:34.919758 [info ] [MainThread]: 
[0m11:38:34.921359 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m11:38:34.923978 [debug] [MainThread]: Command end result
[0m11:38:34.959635 [info ] [MainThread]: 
[0m11:38:34.961249 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m11:38:34.964979 [info ] [MainThread]: 
[0m11:38:34.967095 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m11:38:34.968883 [error] [MainThread]:   Code: 44.
[0m11:38:34.970295 [error] [MainThread]:   DB::Exception: Sorting key contains nullable columns, but merge tree setting `allow_nullable_key` is disabled. Stack trace:
[0m11:38:34.971638 [error] [MainThread]:   
[0m11:38:34.972878 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m11:38:34.974318 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m11:38:34.975679 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m11:38:34.976858 [error] [MainThread]:   3. DB::Exception::Exception<String const&>(int, FormatStringHelperImpl<std::type_identity<String const&>::type>, String const&) @ 0x000000000de374eb
[0m11:38:34.978659 [error] [MainThread]:   4. DB::checkKeyExpression(DB::ExpressionActions const&, DB::Block const&, String const&, bool) @ 0x00000000195d4ae2
[0m11:38:34.980312 [error] [MainThread]:   5. DB::MergeTreeData::checkProperties(DB::StorageInMemoryMetadata const&, DB::StorageInMemoryMetadata const&, bool, bool, bool, bool, std::shared_ptr<DB::Context const>) const @ 0x00000000195d36f0
[0m11:38:34.981681 [error] [MainThread]:   6. DB::MergeTreeData::setProperties(DB::StorageInMemoryMetadata const&, DB::StorageInMemoryMetadata const&, bool, std::shared_ptr<DB::Context const>) @ 0x00000000195c8fb8
[0m11:38:34.983085 [error] [MainThread]:   7. DB::MergeTreeData::MergeTreeData(DB::StorageID const&, DB::StorageInMemoryMetadata const&, std::shared_ptr<DB::Context>, String const&, DB::MergeTreeData::MergingParams const&, std::unique_ptr<DB::MergeTreeSettings, std::default_delete<DB::MergeTreeSettings>>, bool, DB::LoadingStrictnessLevel, std::function<void (String const&)>) @ 0x00000000195c61d2
[0m11:38:34.984403 [error] [MainThread]:   8. DB::StorageMergeTree::StorageMergeTree(DB::StorageID const&, String const&, DB::StorageInMemoryMetadata const&, DB::LoadingStrictnessLevel, std::shared_ptr<DB::Context>, String const&, DB::MergeTreeData::MergingParams const&, std::unique_ptr<DB::MergeTreeSettings, std::default_delete<DB::MergeTreeSettings>>) @ 0x0000000019572e26
[0m11:38:34.986217 [error] [MainThread]:   9. DB::create(DB::StorageFactory::Arguments const&) @ 0x0000000019a60f2d
[0m11:38:34.987491 [error] [MainThread]:   10. DB::StorageFactory::get(DB::ASTCreateQuery const&, String const&, std::shared_ptr<DB::Context>, std::shared_ptr<DB::Context>, DB::ColumnsDescription const&, DB::ConstraintsDescription const&, DB::LoadingStrictnessLevel, bool) const @ 0x0000000018e40d7b
[0m11:38:34.988552 [error] [MainThread]:   11. DB::InterpreterCreateQuery::doCreateTable(DB::ASTCreateQuery&, DB::InterpreterCreateQuery::TableProperties const&, std::unique_ptr<DB::DDLGuard, std::default_delete<DB::DDLGuard>>&, DB::LoadingStrictnessLevel) @ 0x00000000182fb075
[0m11:38:34.989703 [error] [MainThread]:   12. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ef810
[0m11:38:34.990857 [error] [MainThread]:   13. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m11:38:34.992001 [error] [MainThread]:   14. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m11:38:34.993334 [error] [MainThread]:   15. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m11:38:34.995557 [error] [MainThread]:   16. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m11:38:34.996963 [error] [MainThread]:   17. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m11:38:34.998151 [error] [MainThread]:   18. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m11:38:34.999517 [error] [MainThread]:   19. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m11:38:35.001064 [error] [MainThread]:   20. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m11:38:35.002505 [error] [MainThread]:   21. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m11:38:35.003972 [error] [MainThread]:   22. ? @ 0x0000000000094ac3
[0m11:38:35.005610 [error] [MainThread]:   23. ? @ 0x0000000000125a74
[0m11:38:35.007607 [info ] [MainThread]: 
[0m11:38:35.008929 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:38:35.011098 [debug] [MainThread]: Command `dbt run` failed at 11:38:35.010860 after 1.42 seconds
[0m11:38:35.012240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c93cfe7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c93b449760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c93b449580>]}
[0m11:38:35.013513 [debug] [MainThread]: Flushing usage events
