[0m18:04:56.603168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c232c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c2dbcdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c2dbce80>]}
[0m18:04:56.603217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713557cab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713558759d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713558759df0>]}
[0m18:04:56.603256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71736b8ec3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71736c32ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71736c32adc0>]}
[0m18:04:56.603184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b2eec3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b3963d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b3963df0>]}


============================== 18:04:56.661040 | 3d536dee-917c-4581-843a-1c30b6266757 ==============================
[0m18:04:56.661040 [info ] [MainThread]: Running with dbt=1.5.9


============================== 18:04:56.662044 | 262a77f0-997b-499f-b38c-af34a570b1f4 ==============================
[0m18:04:56.662044 [info ] [MainThread]: Running with dbt=1.5.9


============================== 18:04:56.662173 | 0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a ==============================
[0m18:04:56.662173 [info ] [MainThread]: Running with dbt=1.5.9


============================== 18:04:56.662189 | 29941e95-cf4e-4bf2-8fd8-12b2267b38e1 ==============================
[0m18:04:56.662189 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:04:56.664071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:04:56.664204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:04:56.664502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:04:56.664236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:04:56.820159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29941e95-cf4e-4bf2-8fd8-12b2267b38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713558759dc0>]}
[0m18:04:56.821663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '262a77f0-997b-499f-b38c-af34a570b1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71736c32ad90>]}
[0m18:04:56.824094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d536dee-917c-4581-843a-1c30b6266757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c2dbce50>]}
[0m18:04:56.824334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b3963dc0>]}
[0m18:04:56.856024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29941e95-cf4e-4bf2-8fd8-12b2267b38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71355622adf0>]}
[0m18:04:56.858947 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:04:56.859953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d536dee-917c-4581-843a-1c30b6266757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c2d10e50>]}
[0m18:04:56.860642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '262a77f0-997b-499f-b38c-af34a570b1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717369e29dc0>]}
[0m18:04:56.861570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b142adf0>]}
[0m18:04:56.862722 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:04:56.862819 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:04:56.863886 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:04:56.901247 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:04:56.901180 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:04:56.902730 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:04:56.902930 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:04:56.911752 [debug] [MainThread]: Partial parsing not enabled
[0m18:04:56.912120 [debug] [MainThread]: Partial parsing not enabled
[0m18:04:56.912730 [debug] [MainThread]: Partial parsing not enabled
[0m18:04:56.913822 [debug] [MainThread]: Partial parsing not enabled
[0m18:04:58.503986 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:04:58.504064 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:04:58.508885 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:04:58.520880 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:04:58.522079 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:04:58.524680 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:04:58.525715 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:04:58.527218 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:04:58.530185 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:04:58.534740 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:04:58.535238 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:04:58.536936 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:04:58.538104 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:04:58.539278 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:04:58.540065 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:04:58.541994 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:04:58.543267 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:04:58.544110 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:04:58.547004 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:04:58.548256 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:04:58.550160 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:04:58.555313 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:04:58.558421 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:04:58.561770 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:04:58.563644 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:04:58.565002 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:04:58.565894 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:04:58.568883 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:04:58.570939 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:04:58.573212 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:04:58.574819 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:04:58.576052 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:04:58.577804 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:04:58.583016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:04:58.583262 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:04:58.583811 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:04:58.586382 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:04:58.586716 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:04:58.589000 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:04:58.590870 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:04:58.603197 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:04:58.608693 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:04:58.609852 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:04:58.614176 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:04:58.620932 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:04:58.622169 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:04:58.622189 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:04:58.624978 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:04:58.625812 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:04:58.625877 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:04:58.626020 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:04:58.639275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:04:58.640059 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:04:58.656226 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:04:58.659970 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:04:58.671947 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:04:59.085503 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:04:59.088110 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:04:59.089013 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:04:59.092419 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:04:59.099598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b1205a30>]}
[0m18:04:59.101414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '262a77f0-997b-499f-b38c-af34a570b1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717369c09a00>]}
[0m18:04:59.101923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d536dee-917c-4581-843a-1c30b6266757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c0684a60>]}
[0m18:04:59.104177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29941e95-cf4e-4bf2-8fd8-12b2267b38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713556003a30>]}
[0m18:04:59.208040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29941e95-cf4e-4bf2-8fd8-12b2267b38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713556003b80>]}
[0m18:04:59.208373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d536dee-917c-4581-843a-1c30b6266757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c0684bb0>]}
[0m18:04:59.208732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '262a77f0-997b-499f-b38c-af34a570b1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717369c09b50>]}
[0m18:04:59.209732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b1205b80>]}
[0m18:04:59.209861 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:04:59.210373 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:04:59.210610 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:04:59.212003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29941e95-cf4e-4bf2-8fd8-12b2267b38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135562d9730>]}
[0m18:04:59.212206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '262a77f0-997b-499f-b38c-af34a570b1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717369edbfa0>]}
[0m18:04:59.212179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d536dee-917c-4581-843a-1c30b6266757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c2dbcd90>]}
[0m18:04:59.212294 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:04:59.213962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b14dae80>]}
[0m18:04:59.215363 [info ] [MainThread]: 
[0m18:04:59.216574 [info ] [MainThread]: 
[0m18:04:59.216574 [info ] [MainThread]: 
[0m18:04:59.218722 [info ] [MainThread]: 
[0m18:04:59.219303 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:04:59.219619 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:04:59.219907 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:04:59.221494 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:04:59.223125 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:04:59.223057 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:04:59.223744 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:04:59.225152 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:04:59.234225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:59.234952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:59.235287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:59.237232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:00.082918 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:05:00.083134 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:05:00.082920 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:05:00.087352 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:05:00.093920 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.094821 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.094439 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.096294 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.099648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__gold)
[0m18:05:00.101070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__gold)
[0m18:05:00.101331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__gold)
[0m18:05:00.101390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__gold)
[0m18:05:00.101844 [debug] [ThreadPool]: Creating schema "schema: "gold"
"
[0m18:05:00.103343 [debug] [ThreadPool]: Creating schema "schema: "gold"
"
[0m18:05:00.103951 [debug] [ThreadPool]: Creating schema "schema: "gold"
"
[0m18:05:00.104244 [debug] [ThreadPool]: Creating schema "schema: "gold"
"
[0m18:05:00.123443 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "create__gold"} */
create database if not exists gold
        
  
        
  ...
[0m18:05:00.127849 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "create__gold"} */
create database if not exists gold
        
  
        
  ...
[0m18:05:00.130167 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "create__gold"} */
create database if not exists gold
        
  
        
  ...
[0m18:05:00.136726 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "create__gold"} */
create database if not exists gold
        
  
        
  ...
[0m18:05:00.151982 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:05:00.152084 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.151967 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:05:00.152126 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:05:00.158425 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:05:00.159587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__gold, now list__silver)
[0m18:05:00.159776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__gold, now list__silver)
[0m18:05:00.161926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__gold, now list__gold)
[0m18:05:00.162054 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:05:00.161844 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:05:00.160874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__gold, now list__silver)
[0m18:05:00.167728 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:05:00.183095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:00.184622 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:05:00.192360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:00.192390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:00.193684 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:05:00.194122 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:05:00.199951 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:05:00.198800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:00.413913 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:05:00.416690 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:05:00.423781 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:05:00.432468 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m18:05:00.433638 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:05:00.443656 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m18:05:00.451256 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m18:05:00.458914 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:05:00.467021 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m18:05:00.467754 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:05:00.472551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d536dee-917c-4581-843a-1c30b6266757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c06256d0>]}
[0m18:05:00.472455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '262a77f0-997b-499f-b38c-af34a570b1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717369ba5670>]}
[0m18:05:00.475695 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:00.476872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:00.477626 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:05:00.477741 [info ] [MainThread]: 
[0m18:05:00.477725 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:05:00.478489 [info ] [MainThread]: 
[0m18:05:00.481616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b11a66a0>]}
[0m18:05:00.487017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:00.489273 [info ] [MainThread]: 
[0m18:05:00.490259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29941e95-cf4e-4bf2-8fd8-12b2267b38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713555fa66a0>]}
[0m18:05:00.491807 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:00.492870 [info ] [MainThread]: 
[0m18:05:00.520259 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_state
[0m18:05:00.522020 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_state ............................ [RUN]
[0m18:05:00.522194 [debug] [Thread-1  ]: Began running node model.ck_project.dim_date
[0m18:05:00.523908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_payment_state)
[0m18:05:00.523866 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_date ..................................... [RUN]
[0m18:05:00.524595 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_method
[0m18:05:00.525325 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_state
[0m18:05:00.525700 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:05:00.526159 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_date)
[0m18:05:00.526355 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_method ........................... [RUN]
[0m18:05:00.527396 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:05:00.527603 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_date
[0m18:05:00.528262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_payment_method)
[0m18:05:00.529554 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_method
[0m18:05:00.529943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:05:00.531403 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:05:00.542780 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_date"
[0m18:05:00.543899 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_state"
[0m18:05:00.548613 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_method"
[0m18:05:00.550158 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:05:00.587037 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (compile): 18:05:00.528539 => 18:05:00.586201
[0m18:05:00.589012 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_date
[0m18:05:00.590104 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (compile): 18:05:00.530693 => 18:05:00.589539
[0m18:05:00.590141 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (compile): 18:05:00.526278 => 18:05:00.589249
[0m18:05:00.591222 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_method
[0m18:05:00.591736 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:05:00.532297 => 18:05:00.591136
[0m18:05:00.591707 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_state
[0m18:05:00.592876 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:05:00.637941 [debug] [Thread-1  ]: Creating new relation dim_date
[0m18:05:00.637463 [debug] [Thread-1  ]: Creating new relation dim_payment_method
[0m18:05:00.639289 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:05:00.643867 [debug] [Thread-1  ]: Creating new relation dim_payment_state
[0m18:05:00.688619 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

            

    
        create table gold.dim_payment_method
        
  
        
  engine = MergeTree()
        order by (payment_method_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
          )
        ...
[0m18:05:00.688955 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:05:00.690855 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

            

    
        create table gold.dim_date
        
  
        
  engine = MergeTree()
        order by (date_key)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
          )
        ...
[0m18:05:00.692142 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

            

    
        create table gold.dim_payment_state
        
  
        
  engine = MergeTree()
        order by (payment_state_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
          )
        ...
[0m18:05:00.728903 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:05:00.729568 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:05:00.742076 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:05:00.744368 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:05:00.593925 => 18:05:00.743890
[0m18:05:00.746864 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:05:00.750463 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:05:00.750547 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:05:00.761621 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:05:00.764210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29941e95-cf4e-4bf2-8fd8-12b2267b38e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71354db5cfa0>]}
[0m18:05:00.766442 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.24s]
[0m18:05:00.768188 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:05:00.768514 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:05:00.770576 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:05:00.770830 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:05:00.773669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:00.775025 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:05:00.776414 [debug] [MainThread]: On list__silver: Close
[0m18:05:00.776405 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.777905 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:05:00.778391 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_method"
[0m18:05:00.778931 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:05:00.778775 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_state"
[0m18:05:00.780244 [info ] [MainThread]: 
[0m18:05:00.781808 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m18:05:00.784044 [debug] [MainThread]: Command end result
[0m18:05:00.786016 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_date"
[0m18:05:00.813614 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

  
    
    
    
        
        insert into gold.dim_payment_state
        ("payment_state_sk", "payment_state_name", "is_final_state", "is_payment_reached_provider")

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
  
  ...
[0m18:05:00.813976 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

  
    
    
    
        
        insert into gold.dim_payment_method
        ("payment_method_sk", "original_value", "payment_method_name")


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
  
  ...
[0m18:05:00.816697 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

  
    
    
    
        
        insert into gold.dim_date
        ("date_key", "full_date", "year", "month", "day", "day_of_week", "is_weekend", "is_holiday")

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
  
  ...
[0m18:05:00.840278 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:05:00.842302 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:05:00.846448 [info ] [MainThread]: 
[0m18:05:00.848604 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:05:00.849995 [info ] [MainThread]: 
[0m18:05:00.851409 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:05:00.853331 [error] [MainThread]:   Code: 81.
[0m18:05:00.854733 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:05:00.858069 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:05:00.857751 [error] [MainThread]:   
[0m18:05:00.859947 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:05:00.862225 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:05:00.864493 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:05:00.865670 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:05:00.867271 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:05:00.868802 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:05:00.869902 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:05:00.871574 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:05:00.872648 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:05:00.875221 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:05:00.876995 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:05:00.878812 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:05:00.880332 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:05:00.881588 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:05:00.882589 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:05:00.883526 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:05:00.884668 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:05:00.886375 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:05:00.887621 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:05:00.888954 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:05:00.889817 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:05:00.890463 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:05:00.891425 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:05:00.892611 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:05:00.894901 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:05:00.896772 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:05:00.896721 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:05:00.898654 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:05:00.899690 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.903371 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:05:00.905415 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:05:00.905821 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.906416 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:05:00.908267 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:05:00.908657 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (execute): 18:05:00.592817 => 18:05:00.907979
[0m18:05:00.910836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '262a77f0-997b-499f-b38c-af34a570b1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71734170e9d0>]}
[0m18:05:00.910114 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:05:00.912189 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:05:00.913433 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_state ....................... [OK in 0.39s]
[0m18:05:00.914761 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (execute): 18:05:00.592332 => 18:05:00.914284
[0m18:05:00.914546 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:05:00.915947 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_state
[0m18:05:00.916158 [info ] [MainThread]: 
[0m18:05:00.917026 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:00.917014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ecd6ee0-8eff-4600-9cf5-9afdbd3cc63a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714598b6ed30>]}
[0m18:05:00.917294 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:05:00.919115 [debug] [MainThread]: Command `dbt run` failed at 18:05:00.918899 after 4.37 seconds
[0m18:05:00.919084 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_method ...................... [OK in 0.39s]
[0m18:05:00.920235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713557cab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71355622adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713556033d30>]}
[0m18:05:00.921011 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_method
[0m18:05:00.921572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:00.921798 [debug] [MainThread]: Flushing usage events
[0m18:05:00.922370 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (execute): 18:05:00.590478 => 18:05:00.921679
[0m18:05:00.922998 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:05:00.924127 [debug] [MainThread]: On list__silver: Close
[0m18:05:00.925003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d536dee-917c-4581-843a-1c30b6266757', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2bc164d90>]}
[0m18:05:00.925525 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_state' was left open.
[0m18:05:00.926260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:00.926572 [debug] [MainThread]: On model.ck_project.dim_payment_state: Close
[0m18:05:00.926851 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_date ................................ [OK in 0.40s]
[0m18:05:00.927396 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:05:00.928442 [debug] [MainThread]: On list__silver: Close
[0m18:05:00.928049 [info ] [MainThread]: 
[0m18:05:00.928580 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_date
[0m18:05:00.929409 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m18:05:00.929556 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_method' was left open.
[0m18:05:00.930768 [debug] [MainThread]: On model.ck_project.dim_payment_method: Close
[0m18:05:00.931391 [debug] [MainThread]: Command end result
[0m18:05:00.932399 [info ] [MainThread]: 
[0m18:05:00.934078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:00.934019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m18:05:00.935519 [debug] [MainThread]: Connection 'model.ck_project.dim_date' was left open.
[0m18:05:00.936104 [debug] [MainThread]: Command end result
[0m18:05:00.936466 [debug] [MainThread]: On model.ck_project.dim_date: Close
[0m18:05:00.938101 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:05:00.939511 [debug] [MainThread]: On list__silver: Close
[0m18:05:00.940913 [info ] [MainThread]: 
[0m18:05:00.942319 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m18:05:00.944480 [debug] [MainThread]: Command end result
[0m18:05:00.963149 [info ] [MainThread]: 
[0m18:05:00.965172 [info ] [MainThread]: Completed successfully
[0m18:05:00.966397 [info ] [MainThread]: 
[0m18:05:00.967623 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:00.969528 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:00.969254 after 4.42 seconds
[0m18:05:00.970758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71736b8ec3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717369e29dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717369bc5a00>]}
[0m18:05:00.971880 [debug] [MainThread]: Flushing usage events
[0m18:05:01.033203 [info ] [MainThread]: 
[0m18:05:01.033830 [info ] [MainThread]: 
[0m18:05:01.034800 [info ] [MainThread]: Completed successfully
[0m18:05:01.035478 [info ] [MainThread]: Completed successfully
[0m18:05:01.036123 [info ] [MainThread]: 
[0m18:05:01.037046 [info ] [MainThread]: 
[0m18:05:01.037300 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:01.038769 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:01.039428 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:01.039173 after 4.49 seconds
[0m18:05:01.040720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b2eec3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b142adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7145b1233d30>]}
[0m18:05:01.041064 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:01.040886 after 4.49 seconds
[0m18:05:01.041764 [debug] [MainThread]: Flushing usage events
[0m18:05:01.042524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c232c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c06540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee2c07c1460>]}
[0m18:05:01.043865 [debug] [MainThread]: Flushing usage events
[0m18:10:08.458337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0fade490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d1047adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d1048d790>]}


============================== 18:10:08.473708 | 1482be91-aeec-4f7c-ab49-7370a5e038a6 ==============================
[0m18:10:08.473708 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:10:08.475360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:10:08.654853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1482be91-aeec-4f7c-ab49-7370a5e038a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d1047afd0>]}
[0m18:10:08.699879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1482be91-aeec-4f7c-ab49-7370a5e038a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0dfe7ee0>]}
[0m18:10:08.703319 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:10:08.730313 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:10:08.741533 [debug] [MainThread]: Partial parsing not enabled
[0m18:10:11.174853 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:10:11.199800 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:10:11.206163 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:10:11.220356 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:10:11.225847 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:10:11.236161 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:10:11.247306 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:10:11.270448 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:10:11.275751 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:10:11.297809 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:10:11.303227 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:10:11.349232 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:10:11.355873 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:10:11.374706 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:10:11.780838 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:10:11.796063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1482be91-aeec-4f7c-ab49-7370a5e038a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0dd75af0>]}
[0m18:10:11.870061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1482be91-aeec-4f7c-ab49-7370a5e038a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0dd75c40>]}
[0m18:10:11.873572 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:10:11.876042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1482be91-aeec-4f7c-ab49-7370a5e038a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0e05a7f0>]}
[0m18:10:11.881049 [info ] [MainThread]: 
[0m18:10:11.884782 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:10:11.889418 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:10:11.908301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:12.289358 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:10:12.296761 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:10:12.305248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:10:12.308616 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:10:12.330032 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:10:12.335516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:12.388857 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:10:12.445188 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:10:12.460876 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:10:12.467870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1482be91-aeec-4f7c-ab49-7370a5e038a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0dd24760>]}
[0m18:10:12.470028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:10:12.471945 [info ] [MainThread]: 
[0m18:10:12.501209 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:10:12.503491 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:10:12.505725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:10:12.506853 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:10:12.523426 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:10:12.547154 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:10:12.507591 => 18:10:12.545929
[0m18:10:12.549047 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:10:12.589745 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:10:12.664832 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:10:12.672710 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:10:12.675276 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:10:12.550430 => 18:10:12.674759
[0m18:10:12.681999 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:10:12.683913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1482be91-aeec-4f7c-ab49-7370a5e038a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7cdd792df0>]}
[0m18:10:12.685634 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.18s]
[0m18:10:12.687224 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:10:12.692056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:12.693202 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:10:12.694232 [debug] [MainThread]: On list__silver: Close
[0m18:10:12.695566 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:10:12.696654 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:10:12.697836 [info ] [MainThread]: 
[0m18:10:12.699329 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m18:10:12.701148 [debug] [MainThread]: Command end result
[0m18:10:12.744897 [info ] [MainThread]: 
[0m18:10:12.748100 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:10:12.749758 [info ] [MainThread]: 
[0m18:10:12.751353 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:10:12.752495 [error] [MainThread]:   Code: 81.
[0m18:10:12.753910 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:10:12.755336 [error] [MainThread]:   
[0m18:10:12.756562 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:10:12.758225 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:10:12.759656 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:10:12.761126 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:10:12.762689 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:10:12.763841 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:10:12.765419 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:10:12.766631 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:10:12.768713 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:10:12.771096 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:10:12.772661 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:10:12.774522 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:10:12.776056 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:10:12.777431 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:10:12.778920 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:10:12.780628 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:10:12.782144 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:10:12.783530 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:10:12.785238 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:10:12.787506 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:10:12.789158 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:10:12.790808 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:10:12.792050 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:10:12.793469 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:10:12.794720 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:10:12.796100 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:10:12.797949 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:10:12.800351 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:10:12.801920 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:10:12.803080 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:10:12.804494 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:10:12.806172 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:10:12.807716 [info ] [MainThread]: 
[0m18:10:12.809566 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:10:12.811812 [debug] [MainThread]: Command `dbt run` failed at 18:10:12.811541 after 4.40 seconds
[0m18:10:12.813128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0fade490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0dfe7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7d0dd47af0>]}
[0m18:10:12.814367 [debug] [MainThread]: Flushing usage events
[0m18:15:19.382765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f3821e7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f382c4ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f382c5e790>]}


============================== 18:15:19.397330 | 4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325 ==============================
[0m18:15:19.397330 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:15:19.399907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:15:19.580375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f382c4dfd0>]}
[0m18:15:19.621342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f3807a6ee0>]}
[0m18:15:19.623957 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:15:19.653995 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:15:19.663698 [debug] [MainThread]: Partial parsing not enabled
[0m18:15:21.912509 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:15:21.937938 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:15:21.942813 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:15:21.956117 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:15:21.961262 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:15:21.972038 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:15:21.981147 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:15:22.009302 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:15:22.014845 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:15:22.032116 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:15:22.039601 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:15:22.084304 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:15:22.089455 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:15:22.108092 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:15:22.523759 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:15:22.538305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f3804c0af0>]}
[0m18:15:22.586750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f3804c0c40>]}
[0m18:15:22.588132 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:15:22.589646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f38071b7f0>]}
[0m18:15:22.593781 [info ] [MainThread]: 
[0m18:15:22.605788 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:15:22.609045 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:15:22.622078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:23.024798 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:15:23.030935 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:23.038777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:15:23.040713 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:15:23.061339 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:15:23.066577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:23.080428 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:23.174037 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:15:23.214021 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:15:23.219358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f37c927ca0>]}
[0m18:15:23.221360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:23.222782 [info ] [MainThread]: 
[0m18:15:23.255808 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:15:23.258540 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:15:23.260992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_merchants)
[0m18:15:23.262187 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:15:23.279889 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:15:23.301935 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:15:23.262985 => 18:15:23.301133
[0m18:15:23.303597 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:15:23.356839 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:15:23.432720 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:15:23.441636 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:15:23.443587 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:15:23.304607 => 18:15:23.443100
[0m18:15:23.450126 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:15:23.453350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fff0c7d-52d8-425b-bb3e-ad0c5bc3d325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f367eaac10>]}
[0m18:15:23.455471 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.19s]
[0m18:15:23.458050 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:15:23.463168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:23.464485 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:15:23.466652 [debug] [MainThread]: On list__gold: Close
[0m18:15:23.468658 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:15:23.469812 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:15:23.470845 [info ] [MainThread]: 
[0m18:15:23.472328 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m18:15:23.474500 [debug] [MainThread]: Command end result
[0m18:15:23.520277 [info ] [MainThread]: 
[0m18:15:23.521859 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:15:23.523994 [info ] [MainThread]: 
[0m18:15:23.525901 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:15:23.527556 [error] [MainThread]:   Code: 81.
[0m18:15:23.528687 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:15:23.529973 [error] [MainThread]:   
[0m18:15:23.531169 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:15:23.532494 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:15:23.534819 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:15:23.536812 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:15:23.538230 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:15:23.539651 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:15:23.540931 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:15:23.542179 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:15:23.543718 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:15:23.545077 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:15:23.546316 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:15:23.547949 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:15:23.550947 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:15:23.552703 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:15:23.553868 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:15:23.554956 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:15:23.556053 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:15:23.557512 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:15:23.558768 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:15:23.560258 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:15:23.561592 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:15:23.562819 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:15:23.563986 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:15:23.567646 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:15:23.569481 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:15:23.570900 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:15:23.572290 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:15:23.573422 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:15:23.574594 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:15:23.575752 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:15:23.577047 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:15:23.578695 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:15:23.579999 [info ] [MainThread]: 
[0m18:15:23.581753 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:15:23.585220 [debug] [MainThread]: Command `dbt run` failed at 18:15:23.584890 after 4.26 seconds
[0m18:15:23.586504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f3821e7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f3807a6ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f380487af0>]}
[0m18:15:23.587833 [debug] [MainThread]: Flushing usage events
[0m18:15:31.485729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b1a9c74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b1b472e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b1b483790>]}


============================== 18:15:31.497672 | 4c63ab02-ff5a-4400-908c-dd67c298badb ==============================
[0m18:15:31.497672 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:15:31.500272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:15:31.494102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f25698460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f26111fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f26111df0>]}


============================== 18:15:31.507347 | 98a388f0-92e7-4b9a-a805-834953a3fbf9 ==============================
[0m18:15:31.507347 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:15:31.509052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:15:31.574256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207f85c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b20802b0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b20802b0fd0>]}


============================== 18:15:31.587977 | 06d9be2b-cd66-4be0-854a-bd83a782c112 ==============================
[0m18:15:31.587977 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:15:31.589678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:15:31.598927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fdb303490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fdbce7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fdbcf9790>]}


============================== 18:15:31.612845 | a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303 ==============================
[0m18:15:31.612845 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:15:31.614238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:15:31.659860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c63ab02-ff5a-4400-908c-dd67c298badb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b1b472dc0>]}
[0m18:15:31.668685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98a388f0-92e7-4b9a-a805-834953a3fbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f26111e50>]}
[0m18:15:31.702854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c63ab02-ff5a-4400-908c-dd67c298badb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b18f68f10>]}
[0m18:15:31.706275 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:15:31.707122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98a388f0-92e7-4b9a-a805-834953a3fbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f23ba4eb0>]}
[0m18:15:31.709280 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:15:31.731788 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:15:31.732015 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:15:31.739929 [debug] [MainThread]: Partial parsing not enabled
[0m18:15:31.739964 [debug] [MainThread]: Partial parsing not enabled
[0m18:15:31.743306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06d9be2b-cd66-4be0-854a-bd83a782c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b20802b0df0>]}
[0m18:15:31.782021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fdbce7e20>]}
[0m18:15:31.786356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06d9be2b-cd66-4be0-854a-bd83a782c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207dd60e50>]}
[0m18:15:31.788435 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:15:31.821239 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:15:31.833609 [debug] [MainThread]: Partial parsing not enabled
[0m18:15:31.835571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fd9865ee0>]}
[0m18:15:31.837708 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:15:31.876582 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:15:31.887010 [debug] [MainThread]: Partial parsing not enabled
[0m18:15:33.542912 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:15:33.564025 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:15:33.569815 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:15:33.579517 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:15:33.586222 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:15:33.593380 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:15:33.599081 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:15:33.620612 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:15:33.624950 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:15:33.636068 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:15:33.645237 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:15:33.651044 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:15:33.658673 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:15:33.663178 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:15:33.675812 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:15:33.680526 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:15:33.681780 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:15:33.686339 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:15:33.687990 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:15:33.695405 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:15:33.701906 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:15:33.702419 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:15:33.716265 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:15:33.721336 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:15:33.723785 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:15:33.728645 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:15:33.735530 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:15:33.738659 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:15:33.739780 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:15:33.742266 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:15:33.748938 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:15:33.756029 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:15:33.772752 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:15:33.772739 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:15:33.776647 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:15:33.777140 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:15:33.790984 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:15:33.792125 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:15:33.795050 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:15:33.804852 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:15:33.825327 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:15:33.829920 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:15:33.834371 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:15:33.839852 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:15:33.839895 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:15:33.843792 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:15:33.849842 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:15:33.856275 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:15:33.857112 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:15:33.874936 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:15:33.879048 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:15:33.894620 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:15:33.898979 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:15:33.947620 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:15:33.956027 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:15:33.971104 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:15:34.097311 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:15:34.108827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98a388f0-92e7-4b9a-a805-834953a3fbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f23936ac0>]}
[0m18:15:34.154410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98a388f0-92e7-4b9a-a805-834953a3fbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f23936c10>]}
[0m18:15:34.156126 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:15:34.158193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a388f0-92e7-4b9a-a805-834953a3fbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f2390f130>]}
[0m18:15:34.161496 [info ] [MainThread]: 
[0m18:15:34.163331 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:15:34.166358 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:15:34.175448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.180627 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:15:34.192309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c63ab02-ff5a-4400-908c-dd67c298badb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b18c76b20>]}
[0m18:15:34.234059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c63ab02-ff5a-4400-908c-dd67c298badb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b18c76c70>]}
[0m18:15:34.235697 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:15:34.237856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c63ab02-ff5a-4400-908c-dd67c298badb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b18c52190>]}
[0m18:15:34.241795 [info ] [MainThread]: 
[0m18:15:34.244467 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:15:34.248643 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:15:34.258929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.271588 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:15:34.280841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fd95f5af0>]}
[0m18:15:34.324037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fd95f5c40>]}
[0m18:15:34.325695 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:15:34.326862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fd98dc7f0>]}
[0m18:15:34.329582 [info ] [MainThread]: 
[0m18:15:34.331682 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:15:34.334235 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:15:34.349003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.387377 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:15:34.400062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06d9be2b-cd66-4be0-854a-bd83a782c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207daf5a60>]}
[0m18:15:34.438565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06d9be2b-cd66-4be0-854a-bd83a782c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207daf5bb0>]}
[0m18:15:34.440564 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:15:34.442281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d9be2b-cd66-4be0-854a-bd83a782c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207dacd0d0>]}
[0m18:15:34.445908 [info ] [MainThread]: 
[0m18:15:34.448555 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:15:34.453999 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:15:34.469168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.541395 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:15:34.547015 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:34.558036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:15:34.565133 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:15:34.565783 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:15:34.572267 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:34.579508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:15:34.582768 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:15:34.583601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.582099 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:15:34.592710 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:34.597538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.598899 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:15:34.611287 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:34.671784 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:15:34.673880 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:15:34.676897 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:15:34.707448 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:15:34.713901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:15:34.723779 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:15:34.726044 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m18:15:34.727739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98a388f0-92e7-4b9a-a805-834953a3fbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f202a8b50>]}
[0m18:15:34.715961 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:15:34.729568 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:34.730283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c63ab02-ff5a-4400-908c-dd67c298badb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b110abb80>]}
[0m18:15:34.730864 [info ] [MainThread]: 
[0m18:15:34.732176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:34.734248 [info ] [MainThread]: 
[0m18:15:34.732738 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:15:34.738405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.748692 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:34.761813 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:15:34.763562 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_method
[0m18:15:34.763655 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:15:34.765289 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_method ........................... [RUN]
[0m18:15:34.765552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_merchants)
[0m18:15:34.766829 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:15:34.767593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_payment_method)
[0m18:15:34.769284 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_method
[0m18:15:34.784320 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:15:34.784548 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_method"
[0m18:15:34.795216 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:15:34.767973 => 18:15:34.794257
[0m18:15:34.796529 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:15:34.796815 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (compile): 18:15:34.770278 => 18:15:34.796081
[0m18:15:34.797955 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_method
[0m18:15:34.816891 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:15:34.837352 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:15:34.838316 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:15:34.838135 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:15:34.842572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fb9a30af0>]}
[0m18:15:34.843073 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:34.844738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:34.845959 [info ] [MainThread]: 
[0m18:15:34.848873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:15:34.851759 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:15:34.868965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:34.864494 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:15:34.882111 [debug] [Thread-1  ]: Began running node model.ck_project.dim_date
[0m18:15:34.882227 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:34.885161 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_date ..................................... [RUN]
[0m18:15:34.888028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_date)
[0m18:15:34.889222 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_date
[0m18:15:34.898193 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:15:34.905194 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

            

    
        create table gold.dim_payment_method__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_method_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
          )
        ...
[0m18:15:34.905975 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:15:34.907514 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:15:34.797590 => 18:15:34.907109
[0m18:15:34.908467 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_date"
[0m18:15:34.912920 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:15:34.914747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98a388f0-92e7-4b9a-a805-834953a3fbf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f20064400>]}
[0m18:15:34.916846 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.15s]
[0m18:15:34.918999 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:15:34.923500 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:15:34.924683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:34.925850 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:15:34.926952 [debug] [MainThread]: On list__gold: Close
[0m18:15:34.928463 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:15:34.929181 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (compile): 18:15:34.889922 => 18:15:34.928505
[0m18:15:34.929714 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:15:34.930481 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_date
[0m18:15:34.930638 [info ] [MainThread]: 
[0m18:15:34.931809 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m18:15:34.934040 [debug] [MainThread]: Command end result
[0m18:15:34.943638 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:15:34.949211 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:15:34.952518 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:34.966938 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_method"
[0m18:15:34.975369 [info ] [MainThread]: 
[0m18:15:34.977635 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:15:34.979209 [info ] [MainThread]: 
[0m18:15:34.980059 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:15:34.980458 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:15:34.982113 [error] [MainThread]:   Code: 81.
[0m18:15:34.984556 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:15:34.986051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

  
    
    
    
        
        insert into gold.dim_payment_method__dbt_backup
        ("payment_method_sk", "original_value", "payment_method_name")


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
  
  ...
[0m18:15:34.987091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06d9be2b-cd66-4be0-854a-bd83a782c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2075f33af0>]}
[0m18:15:34.987090 [error] [MainThread]:   
[0m18:15:34.992527 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:15:34.993836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:34.994270 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:15:34.995577 [info ] [MainThread]: 
[0m18:15:34.995716 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:15:34.997168 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:15:34.998719 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:15:34.999934 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:15:35.000549 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:35.002510 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:15:35.004364 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:15:35.005388 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:15:35.006312 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:15:35.007321 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:15:35.008304 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:15:35.009253 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:15:35.010239 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:15:35.011236 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:15:35.011867 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */
EXCHANGE TABLES gold.dim_payment_method__dbt_backup AND gold.dim_payment_method 
  
  ...
[0m18:15:35.012091 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:15:35.013365 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:15:35.014557 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:15:35.015847 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:15:35.017486 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:15:35.017938 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:35.018933 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:15:35.020225 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:15:35.021192 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:15:35.022182 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:15:35.023076 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:15:35.024392 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:15:35.025935 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:15:35.027463 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:15:35.029006 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:15:35.029436 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_state
[0m18:15:35.029993 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:15:35.030863 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:15:35.031181 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_state ............................ [RUN]
[0m18:15:35.031661 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:15:35.032839 [info ] [MainThread]: 
[0m18:15:35.033925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_payment_state)
[0m18:15:35.035730 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_state
[0m18:15:35.035430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:15:35.038241 [debug] [MainThread]: Command `dbt run` failed at 18:15:35.037910 after 3.58 seconds
[0m18:15:35.039309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f25698460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f23ba4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6f23c1c370>]}
[0m18:15:35.040359 [debug] [MainThread]: Flushing usage events
[0m18:15:35.051224 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_state"
[0m18:15:35.053552 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

            

    
        create table gold.dim_date__dbt_backup
        
  
        
  engine = MergeTree()
        order by (date_key)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
          )
        ...
[0m18:15:35.069057 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (compile): 18:15:35.037281 => 18:15:35.067888
[0m18:15:35.070749 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_state
[0m18:15:35.073305 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:15:35.073581 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:15:35.079504 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:35.091087 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:15:35.095540 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    drop table if exists gold.dim_payment_method__dbt_backup 
  ...
[0m18:15:35.100130 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:35.100889 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:35.104544 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (execute): 18:15:34.798706 => 18:15:35.104078
[0m18:15:35.106410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c63ab02-ff5a-4400-908c-dd67c298badb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b1066c550>]}
[0m18:15:35.108016 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_method ...................... [OK in 0.34s]
[0m18:15:35.108664 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_date"
[0m18:15:35.110006 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_method
[0m18:15:35.115914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:35.117566 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:15:35.118983 [debug] [MainThread]: On list__gold: Close
[0m18:15:35.120660 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_method' was left open.
[0m18:15:35.121781 [debug] [MainThread]: On model.ck_project.dim_payment_method: Close
[0m18:15:35.123205 [info ] [MainThread]: 
[0m18:15:35.124859 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m18:15:35.126133 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

  
    
    
    
        
        insert into gold.dim_date__dbt_backup
        ("date_key", "full_date", "year", "month", "day", "day_of_week", "is_weekend", "is_holiday")

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
  
  ...
[0m18:15:35.126856 [debug] [MainThread]: Command end result
[0m18:15:35.147125 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:15:35.158855 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */
EXCHANGE TABLES gold.dim_date__dbt_backup AND gold.dim_date 
  
  ...
[0m18:15:35.163325 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:35.168835 [info ] [MainThread]: 
[0m18:15:35.170490 [info ] [MainThread]: Completed successfully
[0m18:15:35.171650 [info ] [MainThread]: 
[0m18:15:35.172802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:15:35.174429 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:35.174206 after 3.73 seconds
[0m18:15:35.175393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b1a9c74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b18d58070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749b18d8b400>]}
[0m18:15:35.176626 [debug] [MainThread]: Flushing usage events
[0m18:15:35.185330 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

            

    
        create table gold.dim_payment_state__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_state_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
          )
        ...
[0m18:15:35.206083 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:15:35.220393 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:15:35.227707 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:35.229859 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:15:35.237819 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:35.243345 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    drop table if exists gold.dim_date__dbt_backup 
  ...
[0m18:15:35.245176 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_state"
[0m18:15:35.248103 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:35.253037 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (execute): 18:15:34.931443 => 18:15:35.252362
[0m18:15:35.255088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a07c97b6-a4d3-46ce-a9d0-c71dc7eaa303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fb8fdd790>]}
[0m18:15:35.256687 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_date ................................ [OK in 0.37s]
[0m18:15:35.258578 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_date
[0m18:15:35.263304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:35.267185 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

  
    
    
    
        
        insert into gold.dim_payment_state__dbt_backup
        ("payment_state_sk", "payment_state_name", "is_final_state", "is_payment_reached_provider")

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
  
  ...
[0m18:15:35.265318 [debug] [MainThread]: Connection 'model.ck_project.dim_date' was left open.
[0m18:15:35.269143 [debug] [MainThread]: On model.ck_project.dim_date: Close
[0m18:15:35.276889 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:15:35.278702 [debug] [MainThread]: On list__silver: Close
[0m18:15:35.280293 [info ] [MainThread]: 
[0m18:15:35.281798 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m18:15:35.283668 [debug] [MainThread]: Command end result
[0m18:15:35.287372 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:15:35.297705 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */
EXCHANGE TABLES gold.dim_payment_state__dbt_backup AND gold.dim_payment_state 
  
  ...
[0m18:15:35.303576 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:35.321292 [info ] [MainThread]: 
[0m18:15:35.322784 [info ] [MainThread]: Completed successfully
[0m18:15:35.324031 [info ] [MainThread]: 
[0m18:15:35.325422 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:15:35.327109 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:35.326862 after 3.80 seconds
[0m18:15:35.328576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fdb303490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fd9865ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753fb90051f0>]}
[0m18:15:35.329853 [debug] [MainThread]: Flushing usage events
[0m18:15:35.356545 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:15:35.364950 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:15:35.380118 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    drop table if exists gold.dim_payment_state__dbt_backup 
  ...
[0m18:15:35.385600 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:15:35.389658 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (execute): 18:15:35.071696 => 18:15:35.389343
[0m18:15:35.391404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06d9be2b-cd66-4be0-854a-bd83a782c112', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b20754df700>]}
[0m18:15:35.392831 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_state ....................... [OK in 0.36s]
[0m18:15:35.394860 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_state
[0m18:15:35.399148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:35.400309 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:15:35.401433 [debug] [MainThread]: On list__gold: Close
[0m18:15:35.402952 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_state' was left open.
[0m18:15:35.404437 [debug] [MainThread]: On model.ck_project.dim_payment_state: Close
[0m18:15:35.405628 [info ] [MainThread]: 
[0m18:15:35.407273 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m18:15:35.409613 [debug] [MainThread]: Command end result
[0m18:15:35.444977 [info ] [MainThread]: 
[0m18:15:35.447508 [info ] [MainThread]: Completed successfully
[0m18:15:35.448969 [info ] [MainThread]: 
[0m18:15:35.450816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:15:35.453379 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:35.452979 after 3.98 seconds
[0m18:15:35.455171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207f85c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207dbc4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b207dcf9460>]}
[0m18:15:35.456511 [debug] [MainThread]: Flushing usage events
[0m18:20:43.036092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636e6af460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636f108d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636f108fd0>]}


============================== 18:20:43.048645 | 39921375-0556-4906-9cf5-43bb0f0c9022 ==============================
[0m18:20:43.048645 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:20:43.050544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:20:43.264607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39921375-0556-4906-9cf5-43bb0f0c9022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636f108df0>]}
[0m18:20:43.311495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39921375-0556-4906-9cf5-43bb0f0c9022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636cbe5e50>]}
[0m18:20:43.314764 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:20:43.346131 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:20:43.358878 [debug] [MainThread]: Partial parsing not enabled
[0m18:20:45.661080 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:20:45.680972 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:20:45.688333 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:20:45.700872 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:20:45.706227 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:20:45.714537 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:20:45.722300 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:20:45.742251 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:20:45.748491 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:20:45.766643 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:20:45.774255 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:20:45.815587 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:20:45.820564 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:20:45.837203 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:20:46.309352 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:20:46.327368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39921375-0556-4906-9cf5-43bb0f0c9022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636c976a60>]}
[0m18:20:46.373876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39921375-0556-4906-9cf5-43bb0f0c9022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636c976bb0>]}
[0m18:20:46.376105 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:20:46.377861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39921375-0556-4906-9cf5-43bb0f0c9022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636c94d0d0>]}
[0m18:20:46.381312 [info ] [MainThread]: 
[0m18:20:46.383597 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:20:46.387383 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:20:46.398416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:46.749439 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:20:46.757840 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:20:46.764487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:20:46.766497 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:20:46.793121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:46.794444 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:20:46.808892 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:20:46.887647 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:20:46.923313 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:20:46.927389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39921375-0556-4906-9cf5-43bb0f0c9022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636c92c280>]}
[0m18:20:46.929317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:20:46.930622 [info ] [MainThread]: 
[0m18:20:46.963168 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:20:46.965265 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:20:46.967451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_merchants)
[0m18:20:46.969442 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:20:46.987415 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:20:47.007861 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:20:46.970681 => 18:20:47.007186
[0m18:20:47.009373 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:20:47.049403 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:20:47.106569 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:20:47.115236 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:20:47.118041 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:20:47.010337 => 18:20:47.117308
[0m18:20:47.124793 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:20:47.126800 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39921375-0556-4906-9cf5-43bb0f0c9022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7463683663a0>]}
[0m18:20:47.128569 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.16s]
[0m18:20:47.130689 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:20:47.136972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:47.138679 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:20:47.139966 [debug] [MainThread]: On list__gold: Close
[0m18:20:47.141782 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:20:47.143353 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:20:47.144613 [info ] [MainThread]: 
[0m18:20:47.146158 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m18:20:47.148507 [debug] [MainThread]: Command end result
[0m18:20:47.193592 [info ] [MainThread]: 
[0m18:20:47.195530 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:20:47.197252 [info ] [MainThread]: 
[0m18:20:47.198910 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:20:47.200909 [error] [MainThread]:   Code: 81.
[0m18:20:47.202636 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:20:47.204223 [error] [MainThread]:   
[0m18:20:47.205675 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:20:47.207036 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:20:47.208496 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:20:47.210087 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:20:47.212335 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:20:47.214253 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:20:47.215774 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:20:47.217399 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:20:47.219256 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:20:47.221078 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:20:47.223068 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:20:47.224259 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:20:47.225431 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:20:47.226978 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:20:47.228263 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:20:47.229365 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:20:47.230756 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:20:47.232146 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:20:47.233426 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:20:47.234599 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:20:47.237648 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:20:47.239347 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:20:47.240942 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:20:47.242940 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:20:47.244076 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:20:47.245347 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:20:47.246540 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:20:47.248091 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:20:47.249287 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:20:47.250476 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:20:47.252035 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:20:47.253474 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:20:47.254769 [info ] [MainThread]: 
[0m18:20:47.256451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:20:47.257987 [debug] [MainThread]: Command `dbt run` failed at 18:20:47.257802 after 4.27 seconds
[0m18:20:47.259011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636e6af460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74636cbe5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746368351be0>]}
[0m18:20:47.260172 [debug] [MainThread]: Flushing usage events
[0m18:25:54.615808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf80d1e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8179adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf817ab790>]}


============================== 18:25:54.631339 | 9e06fcb2-d743-4809-8e4b-56ebe019da69 ==============================
[0m18:25:54.631339 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:25:54.633259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:25:54.822805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e06fcb2-d743-4809-8e4b-56ebe019da69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf8179afd0>]}
[0m18:25:54.866517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e06fcb2-d743-4809-8e4b-56ebe019da69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf7f262ee0>]}
[0m18:25:54.869406 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:25:54.895490 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:25:54.904467 [debug] [MainThread]: Partial parsing not enabled
[0m18:25:57.118435 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:25:57.141132 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:25:57.146553 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:25:57.157347 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:25:57.163093 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:25:57.169888 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:25:57.179649 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:25:57.199569 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:25:57.205952 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:25:57.225466 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:25:57.231105 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:25:57.268899 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:25:57.274276 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:25:57.293208 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:25:57.718123 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:25:57.730838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e06fcb2-d743-4809-8e4b-56ebe019da69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf7eff5af0>]}
[0m18:25:57.780286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e06fcb2-d743-4809-8e4b-56ebe019da69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf7eff5c40>]}
[0m18:25:57.782161 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:25:57.784315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e06fcb2-d743-4809-8e4b-56ebe019da69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf7f2d97f0>]}
[0m18:25:57.787287 [info ] [MainThread]: 
[0m18:25:57.790206 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:25:57.794559 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:25:57.810886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:58.185717 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:25:58.194122 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:25:58.201909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:25:58.204576 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:25:58.220536 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:25:58.226789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:58.268114 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:25:58.317374 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:25:58.327916 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:25:58.333601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e06fcb2-d743-4809-8e4b-56ebe019da69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf7efa4760>]}
[0m18:25:58.335827 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:25:58.337437 [info ] [MainThread]: 
[0m18:25:58.373127 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:25:58.375249 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:25:58.377612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:25:58.378805 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:25:58.396909 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:25:58.420838 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:25:58.379680 => 18:25:58.419827
[0m18:25:58.422536 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:25:58.464907 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:25:58.525376 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:25:58.534110 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:25:58.536485 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:25:58.424377 => 18:25:58.535871
[0m18:25:58.543841 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:25:58.546166 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e06fcb2-d743-4809-8e4b-56ebe019da69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf3ea11b80>]}
[0m18:25:58.547861 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.17s]
[0m18:25:58.550518 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:25:58.558164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:58.559716 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:25:58.561015 [debug] [MainThread]: On list__silver: Close
[0m18:25:58.562159 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:25:58.563180 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:25:58.564224 [info ] [MainThread]: 
[0m18:25:58.565710 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m18:25:58.567696 [debug] [MainThread]: Command end result
[0m18:25:58.614488 [info ] [MainThread]: 
[0m18:25:58.616816 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:25:58.618450 [info ] [MainThread]: 
[0m18:25:58.620004 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:25:58.621813 [error] [MainThread]:   Code: 81.
[0m18:25:58.623403 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:25:58.624931 [error] [MainThread]:   
[0m18:25:58.626893 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:25:58.628551 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:25:58.629798 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:25:58.631055 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:25:58.632641 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:25:58.633983 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:25:58.635287 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:25:58.636970 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:25:58.638408 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:25:58.640429 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:25:58.642518 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:25:58.644391 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:25:58.646022 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:25:58.647491 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:25:58.648909 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:25:58.650155 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:25:58.651451 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:25:58.652898 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:25:58.654367 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:25:58.655533 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:25:58.656978 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:25:58.658886 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:25:58.660224 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:25:58.661504 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:25:58.663092 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:25:58.664525 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:25:58.665923 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:25:58.667128 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:25:58.668422 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:25:58.669751 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:25:58.670955 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:25:58.672189 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:25:58.674363 [info ] [MainThread]: 
[0m18:25:58.676131 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:25:58.678301 [debug] [MainThread]: Command `dbt run` failed at 18:25:58.678041 after 4.11 seconds
[0m18:25:58.679423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf80d1e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf7f262ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bf7f035df0>]}
[0m18:25:58.680512 [debug] [MainThread]: Flushing usage events
[0m18:26:06.237882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c4aedf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c4b86ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c4b86fdf0>]}


============================== 18:26:06.251746 | cd91792f-0392-4c29-9def-7c4755cd3bcc ==============================
[0m18:26:06.251746 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:26:06.253813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:26:06.356408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757777f07430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7577789a8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7577789a8e50>]}


============================== 18:26:06.369901 | 80e81419-45ac-474a-83f5-c6f179eb7b71 ==============================
[0m18:26:06.369901 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:26:06.371279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:26:06.441696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd91792f-0392-4c29-9def-7c4755cd3bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c4b86fe50>]}
[0m18:26:06.448649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7419794c8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741979f63dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741979f74790>]}


============================== 18:26:06.461952 | 48ed3123-e518-4301-be8a-d9bb90594543 ==============================
[0m18:26:06.461952 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:26:06.463597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:26:06.486448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd91792f-0392-4c29-9def-7c4755cd3bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c493dfeb0>]}
[0m18:26:06.488413 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:26:06.478160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b9b1f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20ba5b3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20ba5b3df0>]}


============================== 18:26:06.491270 | 5e42b8ba-141b-479b-87b0-02d368c4fbc4 ==============================
[0m18:26:06.491270 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:26:06.494013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:26:06.518910 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:26:06.530315 [debug] [MainThread]: Partial parsing not enabled
[0m18:26:06.545155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80e81419-45ac-474a-83f5-c6f179eb7b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7577789a8ca0>]}
[0m18:26:06.598236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80e81419-45ac-474a-83f5-c6f179eb7b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757776470e80>]}
[0m18:26:06.600597 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:26:06.627987 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:26:06.636774 [debug] [MainThread]: Partial parsing not enabled
[0m18:26:06.653039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48ed3123-e518-4301-be8a-d9bb90594543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741979f63e20>]}
[0m18:26:06.694361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e42b8ba-141b-479b-87b0-02d368c4fbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20ba5b3e50>]}
[0m18:26:06.703467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48ed3123-e518-4301-be8a-d9bb90594543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741977a22ee0>]}
[0m18:26:06.705474 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:26:06.735004 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:26:06.744672 [debug] [MainThread]: Partial parsing not enabled
[0m18:26:06.751829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e42b8ba-141b-479b-87b0-02d368c4fbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b8067eb0>]}
[0m18:26:06.754210 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:26:06.783436 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:26:06.794094 [debug] [MainThread]: Partial parsing not enabled
[0m18:26:08.372109 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:26:08.389305 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:26:08.394864 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:26:08.406553 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:26:08.411103 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:26:08.416006 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:26:08.420835 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:26:08.436353 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:26:08.442024 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:26:08.445771 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:26:08.452846 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:26:08.456694 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:26:08.463241 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:26:08.466650 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:26:08.477134 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:26:08.480610 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:26:08.484812 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:26:08.486159 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:26:08.488239 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:26:08.491166 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:26:08.501982 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:26:08.507396 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:26:08.509337 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:26:08.511945 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:26:08.526739 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:26:08.526748 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:26:08.535051 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:26:08.535084 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:26:08.544157 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:26:08.547971 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:26:08.553796 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:26:08.561838 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:26:08.568018 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:26:08.571449 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:26:08.577378 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:26:08.580879 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:26:08.585711 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:26:08.591246 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:26:08.593675 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:26:08.599480 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:26:08.606394 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:26:08.613097 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:26:08.625341 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:26:08.629214 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:26:08.634680 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:26:08.638875 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:26:08.639141 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:26:08.643506 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:26:08.657328 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:26:08.659618 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:26:08.661067 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:26:08.675632 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:26:08.680167 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:26:08.715863 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:26:08.720866 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:26:08.735714 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:26:08.846830 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:26:08.860791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd91792f-0392-4c29-9def-7c4755cd3bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c4911bac0>]}
[0m18:26:08.901066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd91792f-0392-4c29-9def-7c4755cd3bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c4911bc10>]}
[0m18:26:08.903055 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:26:08.906815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd91792f-0392-4c29-9def-7c4755cd3bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c49155130>]}
[0m18:26:08.911119 [info ] [MainThread]: 
[0m18:26:08.913826 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:26:08.916837 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:26:08.929258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:08.998534 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:26:09.010317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e81419-45ac-474a-83f5-c6f179eb7b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7577761f5a90>]}
[0m18:26:09.053229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e81419-45ac-474a-83f5-c6f179eb7b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7577761f5be0>]}
[0m18:26:09.055356 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:26:09.057513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e81419-45ac-474a-83f5-c6f179eb7b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7577764db790>]}
[0m18:26:09.060915 [info ] [MainThread]: 
[0m18:26:09.063003 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:26:09.065930 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:26:09.079078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.098595 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:26:09.112113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48ed3123-e518-4301-be8a-d9bb90594543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7419777b6af0>]}
[0m18:26:09.158608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48ed3123-e518-4301-be8a-d9bb90594543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7419777b6c40>]}
[0m18:26:09.160666 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:26:09.162250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ed3123-e518-4301-be8a-d9bb90594543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741977a9a7f0>]}
[0m18:26:09.164467 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:26:09.165229 [info ] [MainThread]: 
[0m18:26:09.168646 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:26:09.172619 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:26:09.178372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e42b8ba-141b-479b-87b0-02d368c4fbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b7df5ac0>]}
[0m18:26:09.183228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.220981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e42b8ba-141b-479b-87b0-02d368c4fbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b7df5c10>]}
[0m18:26:09.222876 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:26:09.224761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e42b8ba-141b-479b-87b0-02d368c4fbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b7dd3130>]}
[0m18:26:09.227910 [info ] [MainThread]: 
[0m18:26:09.230230 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:26:09.233665 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:26:09.244960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.289237 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:26:09.296348 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:09.302284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:26:09.310054 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:26:09.329163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.326416 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:26:09.362455 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:26:09.407012 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:26:09.417690 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.425402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd91792f-0392-4c29-9def-7c4755cd3bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c491a2730>]}
[0m18:26:09.427538 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:09.428757 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:26:09.428725 [info ] [MainThread]: 
[0m18:26:09.433967 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:09.439849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:26:09.447635 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:26:09.455556 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_method
[0m18:26:09.457138 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_method ........................... [RUN]
[0m18:26:09.459003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_payment_method)
[0m18:26:09.460059 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_method
[0m18:26:09.462449 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:26:09.468188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.474285 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_method"
[0m18:26:09.477582 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.495114 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (compile): 18:26:09.460900 => 18:26:09.494486
[0m18:26:09.496490 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_method
[0m18:26:09.519417 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:26:09.526391 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.531668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:26:09.536282 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:26:09.533874 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:26:09.562162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.557040 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:26:09.563869 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:26:09.568214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e81419-45ac-474a-83f5-c6f179eb7b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75773e637af0>]}
[0m18:26:09.576763 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:09.579689 [info ] [MainThread]: 
[0m18:26:09.590681 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:26:09.593817 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:26:09.596784 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:09.602234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:26:09.608267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

            

    
        create table gold.dim_payment_method__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_method_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
          )
        ...
[0m18:26:09.604034 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:26:09.615763 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_state
[0m18:26:09.617162 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_state ............................ [RUN]
[0m18:26:09.619383 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_payment_state)
[0m18:26:09.620484 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_state
[0m18:26:09.626102 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:26:09.630623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:09.631969 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:26:09.638753 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_state"
[0m18:26:09.649203 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:26:09.650698 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:26:09.657097 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:26:09.657648 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.660115 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (compile): 18:26:09.622450 => 18:26:09.659335
[0m18:26:09.660896 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.662009 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_state
[0m18:26:09.664504 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_method"
[0m18:26:09.666938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ed3123-e518-4301-be8a-d9bb90594543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7419777dd760>]}
[0m18:26:09.668642 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:09.669972 [info ] [MainThread]: 
[0m18:26:09.682067 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

  
    
    
    
        
        insert into gold.dim_payment_method__dbt_backup
        ("payment_method_sk", "original_value", "payment_method_name")


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
  
  ...
[0m18:26:09.702965 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:26:09.718322 [debug] [Thread-1  ]: Began running node model.ck_project.dim_date
[0m18:26:09.719705 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */
EXCHANGE TABLES gold.dim_payment_method__dbt_backup AND gold.dim_payment_method 
  
  ...
[0m18:26:09.722563 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_date ..................................... [RUN]
[0m18:26:09.727683 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:09.727655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_date)
[0m18:26:09.727893 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:26:09.729128 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_date
[0m18:26:09.737036 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.743965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e42b8ba-141b-479b-87b0-02d368c4fbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b7da5730>]}
[0m18:26:09.745985 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_date"
[0m18:26:09.746009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:26:09.747231 [info ] [MainThread]: 
[0m18:26:09.760127 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (compile): 18:26:09.730044 => 18:26:09.759499
[0m18:26:09.761474 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_date
[0m18:26:09.772381 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:26:09.781180 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.781245 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:26:09.782880 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:26:09.784625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:26:09.785681 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:26:09.792053 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

            

    
        create table gold.dim_payment_state__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_state_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
          )
        ...
[0m18:26:09.795280 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    drop table if exists gold.dim_payment_method__dbt_backup 
  ...
[0m18:26:09.799400 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:09.800557 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:26:09.803321 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (execute): 18:26:09.497536 => 18:26:09.803020
[0m18:26:09.805371 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd91792f-0392-4c29-9def-7c4755cd3bcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c40b5aeb0>]}
[0m18:26:09.807429 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_method ...................... [OK in 0.35s]
[0m18:26:09.809175 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_method
[0m18:26:09.809994 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:26:09.813544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:09.814721 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:26:09.815873 [debug] [MainThread]: On list__silver: Close
[0m18:26:09.817002 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_method' was left open.
[0m18:26:09.817303 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:26:09.786483 => 18:26:09.816718
[0m18:26:09.817949 [debug] [MainThread]: On model.ck_project.dim_payment_method: Close
[0m18:26:09.818730 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:26:09.819642 [info ] [MainThread]: 
[0m18:26:09.821167 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m18:26:09.823652 [debug] [MainThread]: Command end result
[0m18:26:09.831639 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:26:09.841916 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.849585 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_state"
[0m18:26:09.862626 [info ] [MainThread]: 
[0m18:26:09.864181 [info ] [MainThread]: Completed successfully
[0m18:26:09.864825 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:26:09.866278 [info ] [MainThread]: 
[0m18:26:09.867581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:26:09.869117 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

  
    
    
    
        
        insert into gold.dim_payment_state__dbt_backup
        ("payment_state_sk", "payment_state_name", "is_final_state", "is_payment_reached_provider")

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
  
  ...
[0m18:26:09.869761 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:09.869412 after 3.67 seconds
[0m18:26:09.873155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c4aedf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c493dfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9c415aebe0>]}
[0m18:26:09.875659 [debug] [MainThread]: Flushing usage events
[0m18:26:09.878323 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

            

    
        create table gold.dim_date__dbt_backup
        
  
        
  engine = MergeTree()
        order by (date_key)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
          )
        ...
[0m18:26:09.889161 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:26:09.900810 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */
EXCHANGE TABLES gold.dim_payment_state__dbt_backup AND gold.dim_payment_state 
  
  ...
[0m18:26:09.902702 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:26:09.905539 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:09.920742 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:26:09.928573 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:26:09.929539 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.934380 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:26:09.936940 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_date"
[0m18:26:09.938909 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:26:09.819628 => 18:26:09.938232
[0m18:26:09.944874 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:26:09.946237 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:26:09.947086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e42b8ba-141b-479b-87b0-02d368c4fbc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20777c5760>]}
[0m18:26:09.948802 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.16s]
[0m18:26:09.950825 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:26:09.955905 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

  
    
    
    
        
        insert into gold.dim_date__dbt_backup
        ("date_key", "full_date", "year", "month", "day", "day_of_week", "is_weekend", "is_holiday")

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
  
  ...
[0m18:26:09.956261 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.957058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:09.958218 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:26:09.959537 [debug] [MainThread]: On list__silver: Close
[0m18:26:09.960847 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:26:09.961863 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:26:09.962736 [info ] [MainThread]: 
[0m18:26:09.963648 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m18:26:09.965258 [debug] [MainThread]: Command end result
[0m18:26:09.970972 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    drop table if exists gold.dim_payment_state__dbt_backup 
  ...
[0m18:26:09.974370 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:26:09.976791 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:09.979936 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (execute): 18:26:09.662962 => 18:26:09.979584
[0m18:26:09.982466 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e81419-45ac-474a-83f5-c6f179eb7b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75773dbe2ee0>]}
[0m18:26:09.984335 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */
EXCHANGE TABLES gold.dim_date__dbt_backup AND gold.dim_date 
  
  ...
[0m18:26:09.984440 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_state ....................... [OK in 0.36s]
[0m18:26:09.986828 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_state
[0m18:26:09.991096 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:09.992903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:09.994347 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:26:09.995371 [debug] [MainThread]: On list__gold: Close
[0m18:26:09.996717 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_state' was left open.
[0m18:26:09.997751 [debug] [MainThread]: On model.ck_project.dim_payment_state: Close
[0m18:26:09.999032 [info ] [MainThread]: 
[0m18:26:10.000222 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m18:26:10.002878 [debug] [MainThread]: Command end result
[0m18:26:10.006569 [info ] [MainThread]: 
[0m18:26:10.008257 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:26:10.009966 [info ] [MainThread]: 
[0m18:26:10.011300 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:26:10.012633 [error] [MainThread]:   Code: 81.
[0m18:26:10.013705 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:26:10.014947 [error] [MainThread]:   
[0m18:26:10.015962 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:26:10.017349 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:26:10.018602 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:26:10.021664 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:26:10.023712 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:26:10.024882 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:26:10.026061 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:26:10.026969 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:26:10.027965 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:26:10.029305 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:26:10.031602 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:26:10.032731 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:26:10.033941 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:26:10.035802 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:26:10.038118 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:26:10.040533 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:26:10.042454 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:26:10.043758 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:26:10.044956 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:26:10.046117 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:26:10.046892 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:26:10.047069 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:26:10.048515 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:26:10.049639 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:26:10.050766 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:26:10.051733 [info ] [MainThread]: 
[0m18:26:10.053192 [info ] [MainThread]: Completed successfully
[0m18:26:10.054094 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:26:10.053155 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:26:10.054854 [info ] [MainThread]: 
[0m18:26:10.056195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:26:10.055878 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:26:10.058316 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:10.057964 after 3.84 seconds
[0m18:26:10.058281 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:26:10.059376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757777f07430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75777897cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757776235d90>]}
[0m18:26:10.059544 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:26:10.060301 [debug] [MainThread]: Flushing usage events
[0m18:26:10.060860 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:26:10.062234 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:26:10.063369 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:26:10.064559 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:26:10.065800 [info ] [MainThread]: 
[0m18:26:10.067222 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:26:10.069320 [debug] [MainThread]: Command `dbt run` failed at 18:26:10.069013 after 3.69 seconds
[0m18:26:10.069329 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    drop table if exists gold.dim_date__dbt_backup 
  ...
[0m18:26:10.070543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b9b1f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b8067eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20b403eac0>]}
[0m18:26:10.071959 [debug] [MainThread]: Flushing usage events
[0m18:26:10.074331 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:26:10.077412 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (execute): 18:26:09.762553 => 18:26:10.077038
[0m18:26:10.079822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48ed3123-e518-4301-be8a-d9bb90594543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7419371a6e50>]}
[0m18:26:10.081697 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_date ................................ [OK in 0.35s]
[0m18:26:10.083667 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_date
[0m18:26:10.087502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:10.088709 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:26:10.090154 [debug] [MainThread]: On list__silver: Close
[0m18:26:10.091470 [debug] [MainThread]: Connection 'model.ck_project.dim_date' was left open.
[0m18:26:10.092556 [debug] [MainThread]: On model.ck_project.dim_date: Close
[0m18:26:10.093859 [info ] [MainThread]: 
[0m18:26:10.094914 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:26:10.096641 [debug] [MainThread]: Command end result
[0m18:26:10.127858 [info ] [MainThread]: 
[0m18:26:10.129646 [info ] [MainThread]: Completed successfully
[0m18:26:10.131390 [info ] [MainThread]: 
[0m18:26:10.132907 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:26:10.134843 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:10.134622 after 3.90 seconds
[0m18:26:10.136352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7419794c8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741977787af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7419778cbc40>]}
[0m18:26:10.137538 [debug] [MainThread]: Flushing usage events
[0m18:31:17.191832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d3c583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d46bbd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d46bbdc0>]}


============================== 18:31:17.206041 | cafece62-50ca-46e3-a980-603335b75a62 ==============================
[0m18:31:17.206041 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:31:17.208701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:31:17.412963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cafece62-50ca-46e3-a980-603335b75a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d46bbd90>]}
[0m18:31:17.459498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cafece62-50ca-46e3-a980-603335b75a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d2170dc0>]}
[0m18:31:17.462411 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:31:17.489700 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:31:17.501326 [debug] [MainThread]: Partial parsing not enabled
[0m18:31:19.808921 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:31:19.833101 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:31:19.838112 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:31:19.850621 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:31:19.855497 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:31:19.864345 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:31:19.872736 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:31:19.892548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:31:19.899281 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:31:19.918466 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:31:19.923522 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:31:19.966478 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:31:19.972089 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:31:19.989877 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:31:20.413852 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:31:20.429328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cafece62-50ca-46e3-a980-603335b75a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1f20a00>]}
[0m18:31:20.479700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cafece62-50ca-46e3-a980-603335b75a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1f20b50>]}
[0m18:31:20.482637 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:31:20.484892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cafece62-50ca-46e3-a980-603335b75a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d21dcf70>]}
[0m18:31:20.488152 [info ] [MainThread]: 
[0m18:31:20.490275 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:31:20.494716 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:31:20.510013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:20.831767 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:31:20.839532 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:31:20.847155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:31:20.849445 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:31:20.870507 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:31:20.876200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:20.911703 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:31:20.974975 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:31:20.987562 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:31:20.995531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cafece62-50ca-46e3-a980-603335b75a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1ea5670>]}
[0m18:31:20.998015 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:31:20.999756 [info ] [MainThread]: 
[0m18:31:21.037832 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:31:21.043272 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:31:21.046733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:31:21.048258 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:31:21.067059 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:31:21.098168 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:31:21.049243 => 18:31:21.097186
[0m18:31:21.099730 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:31:21.144870 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:31:21.200746 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:31:21.210160 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:31:21.212664 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:31:21.100882 => 18:31:21.211995
[0m18:31:21.219356 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:31:21.221976 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cafece62-50ca-46e3-a980-603335b75a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a1912070>]}
[0m18:31:21.224095 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.18s]
[0m18:31:21.226995 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:31:21.232425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:21.233837 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:31:21.235000 [debug] [MainThread]: On list__silver: Close
[0m18:31:21.236337 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:31:21.237401 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:31:21.238462 [info ] [MainThread]: 
[0m18:31:21.239582 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m18:31:21.261766 [debug] [MainThread]: Command end result
[0m18:31:21.306798 [info ] [MainThread]: 
[0m18:31:21.310532 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:31:21.313717 [info ] [MainThread]: 
[0m18:31:21.315653 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:31:21.317007 [error] [MainThread]:   Code: 81.
[0m18:31:21.318378 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:31:21.319729 [error] [MainThread]:   
[0m18:31:21.321003 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:31:21.322718 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:31:21.324100 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:31:21.326142 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:31:21.328124 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:31:21.330006 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:31:21.331500 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:31:21.333068 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:31:21.334573 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:31:21.336515 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:31:21.337905 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:31:21.339197 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:31:21.340232 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:31:21.341834 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:31:21.344051 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:31:21.345463 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:31:21.346763 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:31:21.347975 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:31:21.349042 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:31:21.351342 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:31:21.353085 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:31:21.354607 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:31:21.356274 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:31:21.359086 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:31:21.361400 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:31:21.362942 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:31:21.364369 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:31:21.365587 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:31:21.367009 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:31:21.368161 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:31:21.369393 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:31:21.370499 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:31:21.371775 [info ] [MainThread]: 
[0m18:31:21.373103 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:31:21.375658 [debug] [MainThread]: Command `dbt run` failed at 18:31:21.375337 after 4.24 seconds
[0m18:31:21.377082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d3c583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d2170dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1f35d00>]}
[0m18:31:21.378473 [debug] [MainThread]: Flushing usage events
[0m18:36:29.109260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b216041e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2160e6fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2160e80790>]}


============================== 18:36:29.122429 | 94dc707c-f80b-4897-83fb-a6cc7bb0ba9b ==============================
[0m18:36:29.122429 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:36:29.124473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:36:29.329034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94dc707c-f80b-4897-83fb-a6cc7bb0ba9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2160e6ffd0>]}
[0m18:36:29.383434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94dc707c-f80b-4897-83fb-a6cc7bb0ba9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b215e922ee0>]}
[0m18:36:29.386641 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:36:29.423880 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:36:29.439981 [debug] [MainThread]: Partial parsing not enabled
[0m18:36:32.404943 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:36:32.426166 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:36:32.431928 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:36:32.445733 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:36:32.452698 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:36:32.462396 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:36:32.471294 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:36:32.490957 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:36:32.496054 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:36:32.511286 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:36:32.516253 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:36:32.557174 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:36:32.562652 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:36:32.581210 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:36:33.055441 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:36:33.068545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94dc707c-f80b-4897-83fb-a6cc7bb0ba9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b215e6c2af0>]}
[0m18:36:33.190332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94dc707c-f80b-4897-83fb-a6cc7bb0ba9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b215e6c2c40>]}
[0m18:36:33.192878 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:36:33.195400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dc707c-f80b-4897-83fb-a6cc7bb0ba9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b215e99b7f0>]}
[0m18:36:33.200294 [info ] [MainThread]: 
[0m18:36:33.203282 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:36:33.207387 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:36:33.221442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:33.552238 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:36:33.559842 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:33.566758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:36:33.568715 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:36:33.590093 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:36:33.597704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:33.628536 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:36:33.684598 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:36:33.694867 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:33.701604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dc707c-f80b-4897-83fb-a6cc7bb0ba9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b215e662760>]}
[0m18:36:33.704019 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:33.705639 [info ] [MainThread]: 
[0m18:36:33.736754 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:36:33.738704 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:36:33.740886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:36:33.742240 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:36:33.760110 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:36:33.818684 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:36:33.743208 => 18:36:33.817246
[0m18:36:33.820488 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:36:33.862273 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:36:33.922290 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:36:33.933306 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:36:33.936566 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:36:33.821728 => 18:36:33.935897
[0m18:36:33.949736 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:36:33.952690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94dc707c-f80b-4897-83fb-a6cc7bb0ba9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21420a7fa0>]}
[0m18:36:33.955236 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.21s]
[0m18:36:33.959452 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:36:33.967364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:33.968876 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:36:33.969927 [debug] [MainThread]: On list__silver: Close
[0m18:36:33.971446 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:36:33.972701 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:36:33.973927 [info ] [MainThread]: 
[0m18:36:33.975250 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m18:36:33.977327 [debug] [MainThread]: Command end result
[0m18:36:34.066634 [info ] [MainThread]: 
[0m18:36:34.068969 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:36:34.071284 [info ] [MainThread]: 
[0m18:36:34.073159 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:36:34.074768 [error] [MainThread]:   Code: 81.
[0m18:36:34.076715 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:36:34.080014 [error] [MainThread]:   
[0m18:36:34.082055 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:36:34.084278 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:36:34.085885 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:36:34.087412 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:36:34.089156 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:36:34.090750 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:36:34.092730 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:36:34.094278 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:36:34.096658 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:36:34.098505 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:36:34.100403 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:36:34.102003 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:36:34.103616 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:36:34.105306 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:36:34.106980 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:36:34.108320 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:36:34.109952 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:36:34.112436 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:36:34.115207 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:36:34.116823 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:36:34.118370 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:36:34.120213 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:36:34.121383 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:36:34.122526 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:36:34.124014 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:36:34.125652 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:36:34.126773 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:36:34.128163 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:36:34.130166 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:36:34.131815 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:36:34.132993 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:36:34.133980 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:36:34.135111 [info ] [MainThread]: 
[0m18:36:34.136630 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:36:34.138536 [debug] [MainThread]: Command `dbt run` failed at 18:36:34.138296 after 5.30 seconds
[0m18:36:34.140028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b216041e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b215e922ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b215e687af0>]}
[0m18:36:34.141230 [debug] [MainThread]: Flushing usage events
[0m18:36:41.015358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27a69f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27b11afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27b11adf0>]}


============================== 18:36:41.028075 | ba65afec-0421-4bd8-b0e3-e3a7f524746f ==============================
[0m18:36:41.028075 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:36:41.029666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:36:41.166507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941d69d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941e0f7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941e0f7df0>]}
[0m18:36:41.165851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc9e2f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cca879d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cca879dc0>]}


============================== 18:36:41.180215 | 5c6986e1-8c8c-4ec0-9a10-ac9521069d98 ==============================
[0m18:36:41.180215 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:36:41.166371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0ebef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0f656e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0f667790>]}


============================== 18:36:41.181585 | b1d9bd09-2325-4d8b-b1d2-42e9c07c347c ==============================
[0m18:36:41.181585 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:36:41.181781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}


============================== 18:36:41.181883 | 607429fa-dbab-4381-81dc-82e374b1a3f2 ==============================
[0m18:36:41.181883 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:36:41.184135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:36:41.184465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:36:41.190770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba65afec-0421-4bd8-b0e3-e3a7f524746f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27b11ae50>]}
[0m18:36:41.241883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba65afec-0421-4bd8-b0e3-e3a7f524746f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b278be4eb0>]}
[0m18:36:41.245183 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:36:41.274769 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:36:41.291057 [debug] [MainThread]: Partial parsing not enabled
[0m18:36:41.393688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c6986e1-8c8c-4ec0-9a10-ac9521069d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941e0f7e50>]}
[0m18:36:41.396697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '607429fa-dbab-4381-81dc-82e374b1a3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0f656dc0>]}
[0m18:36:41.408976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1d9bd09-2325-4d8b-b1d2-42e9c07c347c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cca879d90>]}
[0m18:36:41.451847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c6986e1-8c8c-4ec0-9a10-ac9521069d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941bba8eb0>]}
[0m18:36:41.454470 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:36:41.457107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '607429fa-dbab-4381-81dc-82e374b1a3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0d11ef10>]}
[0m18:36:41.459876 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:36:41.469131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1d9bd09-2325-4d8b-b1d2-42e9c07c347c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc832fdc0>]}
[0m18:36:41.471824 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:36:41.487605 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:36:41.488742 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:36:41.500622 [debug] [MainThread]: Partial parsing not enabled
[0m18:36:41.501986 [debug] [MainThread]: Partial parsing not enabled
[0m18:36:41.501993 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:36:41.512815 [debug] [MainThread]: Partial parsing not enabled
[0m18:36:43.145344 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:36:43.166403 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:36:43.171584 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:36:43.180680 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:36:43.185772 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:36:43.195899 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:36:43.199350 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:36:43.202494 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:36:43.218024 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:36:43.218601 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:36:43.222228 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:36:43.223052 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:36:43.237389 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:36:43.239440 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:36:43.242016 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:36:43.244075 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:36:43.249084 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:36:43.253867 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:36:43.254121 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:36:43.257002 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:36:43.267657 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:36:43.269547 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:36:43.270414 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:36:43.272643 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:36:43.273081 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:36:43.273364 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:36:43.274036 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:36:43.277028 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:36:43.282230 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:36:43.283845 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:36:43.285368 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:36:43.285861 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:36:43.288611 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:36:43.288999 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:36:43.289628 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:36:43.290816 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:36:43.293804 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:36:43.300919 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:36:43.301604 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:36:43.315385 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:36:43.315789 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:36:43.318618 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:36:43.319280 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:36:43.319468 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:36:43.323787 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:36:43.329996 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:36:43.330619 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:36:43.333935 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:36:43.334378 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:36:43.337105 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:36:43.367831 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:36:43.369584 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:36:43.371597 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:36:43.375108 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:36:43.387880 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:36:43.389743 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:36:43.647134 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:36:43.657460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba65afec-0421-4bd8-b0e3-e3a7f524746f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27899aac0>]}
[0m18:36:43.705449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba65afec-0421-4bd8-b0e3-e3a7f524746f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27899ac10>]}
[0m18:36:43.706887 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:36:43.708118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba65afec-0421-4bd8-b0e3-e3a7f524746f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b278953130>]}
[0m18:36:43.712408 [info ] [MainThread]: 
[0m18:36:43.714722 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:36:43.717829 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:36:43.719198 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:36:43.729316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:43.732530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '607429fa-dbab-4381-81dc-82e374b1a3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0ceb5b20>]}
[0m18:36:43.766566 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:36:43.774732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '607429fa-dbab-4381-81dc-82e374b1a3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0ceb5c70>]}
[0m18:36:43.776857 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:36:43.778508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '607429fa-dbab-4381-81dc-82e374b1a3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0ce8e190>]}
[0m18:36:43.780747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c6986e1-8c8c-4ec0-9a10-ac9521069d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941b936ac0>]}
[0m18:36:43.782231 [info ] [MainThread]: 
[0m18:36:43.784517 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:36:43.788054 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:36:43.803137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:43.810289 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:36:43.823071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1d9bd09-2325-4d8b-b1d2-42e9c07c347c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc80b6a00>]}
[0m18:36:43.822988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c6986e1-8c8c-4ec0-9a10-ac9521069d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941b936c10>]}
[0m18:36:43.825299 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:36:43.827228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6986e1-8c8c-4ec0-9a10-ac9521069d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941b914130>]}
[0m18:36:43.831016 [info ] [MainThread]: 
[0m18:36:43.833615 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:36:43.836948 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:36:43.852963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:43.873297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d9bd09-2325-4d8b-b1d2-42e9c07c347c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc80b6b50>]}
[0m18:36:43.875435 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:36:43.877367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d9bd09-2325-4d8b-b1d2-42e9c07c347c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc839cf70>]}
[0m18:36:43.880648 [info ] [MainThread]: 
[0m18:36:43.883075 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:36:43.885888 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:36:43.897500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:44.114308 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:36:44.123189 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.130818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:36:44.134077 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:36:44.153763 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:36:44.162133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:44.171330 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.182709 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:36:44.188463 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.195519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:36:44.198085 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:36:44.214109 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:36:44.218827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:44.225929 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:36:44.229335 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.232185 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.238561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:36:44.246203 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:36:44.246445 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:36:44.261000 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:36:44.269189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:44.281842 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:36:44.286269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba65afec-0421-4bd8-b0e3-e3a7f524746f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b270dabc70>]}
[0m18:36:44.289009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:44.290877 [info ] [MainThread]: 
[0m18:36:44.294545 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:36:44.299797 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:36:44.305622 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.311206 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:36:44.312154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:36:44.314403 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:36:44.334986 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:36:44.335431 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:36:44.337034 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:36:44.339017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_merchants)
[0m18:36:44.339842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '607429fa-dbab-4381-81dc-82e374b1a3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767dfd4acb20>]}
[0m18:36:44.340546 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:36:44.342019 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:44.344321 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:36:44.344647 [info ] [MainThread]: 
[0m18:36:44.343216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:44.349677 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:36:44.354930 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.358127 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.360660 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:36:44.364699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c6986e1-8c8c-4ec0-9a10-ac9521069d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941b95d730>]}
[0m18:36:44.369073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:44.370351 [info ] [MainThread]: 
[0m18:36:44.381682 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:36:44.341520 => 18:36:44.381080
[0m18:36:44.381911 [debug] [Thread-1  ]: Began running node model.ck_project.dim_date
[0m18:36:44.383042 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:36:44.383591 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_date ..................................... [RUN]
[0m18:36:44.385716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_date)
[0m18:36:44.386710 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_date
[0m18:36:44.403453 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_date"
[0m18:36:44.407332 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_state
[0m18:36:44.409299 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_state ............................ [RUN]
[0m18:36:44.411274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_payment_state)
[0m18:36:44.412825 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_state
[0m18:36:44.423141 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:36:44.424209 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:36:44.427466 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_state"
[0m18:36:44.448076 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:36:44.456903 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (compile): 18:36:44.387415 => 18:36:44.455984
[0m18:36:44.456811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1d9bd09-2325-4d8b-b1d2-42e9c07c347c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc4513d00>]}
[0m18:36:44.458707 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_date
[0m18:36:44.459393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:44.460967 [info ] [MainThread]: 
[0m18:36:44.463357 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (compile): 18:36:44.413619 => 18:36:44.462652
[0m18:36:44.464623 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_state
[0m18:36:44.501818 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_method
[0m18:36:44.503683 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:36:44.503584 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_method ........................... [RUN]
[0m18:36:44.505629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_payment_method)
[0m18:36:44.507022 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_method
[0m18:36:44.511257 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:36:44.513285 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:36:44.383977 => 18:36:44.512781
[0m18:36:44.519881 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:36:44.522173 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba65afec-0421-4bd8-b0e3-e3a7f524746f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b270382ac0>]}
[0m18:36:44.524410 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_method"
[0m18:36:44.524626 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.18s]
[0m18:36:44.526669 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:36:44.532287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:44.533549 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:36:44.534750 [debug] [MainThread]: On list__gold: Close
[0m18:36:44.536158 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:36:44.537686 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:36:44.539033 [info ] [MainThread]: 
[0m18:36:44.540366 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m18:36:44.542771 [debug] [MainThread]: Command end result
[0m18:36:44.572340 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (compile): 18:36:44.508139 => 18:36:44.571101
[0m18:36:44.574271 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_method
[0m18:36:44.576507 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

            

    
        create table gold.dim_date__dbt_backup
        
  
        
  engine = MergeTree()
        order by (date_key)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
          )
        ...
[0m18:36:44.578601 [info ] [MainThread]: 
[0m18:36:44.580340 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:36:44.582373 [info ] [MainThread]: 
[0m18:36:44.584178 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:36:44.586114 [error] [MainThread]:   Code: 81.
[0m18:36:44.587293 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

            

    
        create table gold.dim_payment_state__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_state_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
          )
        ...
[0m18:36:44.587611 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:36:44.589437 [error] [MainThread]:   
[0m18:36:44.591109 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:36:44.593116 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:36:44.595408 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:36:44.596911 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:36:44.598253 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:36:44.599345 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:36:44.600505 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:36:44.601079 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:36:44.601862 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:36:44.603394 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:36:44.604904 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:36:44.606286 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:36:44.607213 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:36:44.607615 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:36:44.608643 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:36:44.610116 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:36:44.611349 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:36:44.612369 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:36:44.613554 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:36:44.614567 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:36:44.615948 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:36:44.617478 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:36:44.618818 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:36:44.619866 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:36:44.620311 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:36:44.620850 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:36:44.624416 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:36:44.625736 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:36:44.626099 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:36:44.627976 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:36:44.629042 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.629351 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:36:44.630403 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:36:44.631554 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:36:44.633258 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:36:44.634353 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.634394 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:36:44.635652 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:36:44.636553 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_date"
[0m18:36:44.637243 [info ] [MainThread]: 
[0m18:36:44.638607 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:36:44.640527 [debug] [MainThread]: Command `dbt run` failed at 18:36:44.640295 after 3.67 seconds
[0m18:36:44.641754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27a69f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b278be4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b27036d730>]}
[0m18:36:44.642161 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_state"
[0m18:36:44.642891 [debug] [MainThread]: Flushing usage events
[0m18:36:44.680287 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

  
    
    
    
        
        insert into gold.dim_payment_state__dbt_backup
        ("payment_state_sk", "payment_state_name", "is_final_state", "is_payment_reached_provider")

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
  
  ...
[0m18:36:44.682624 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

  
    
    
    
        
        insert into gold.dim_date__dbt_backup
        ("date_key", "full_date", "year", "month", "day", "day_of_week", "is_weekend", "is_holiday")

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
  
  ...
[0m18:36:44.693921 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

            

    
        create table gold.dim_payment_method__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_method_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
          )
        ...
[0m18:36:44.699246 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:36:44.703050 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:36:44.712152 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */
EXCHANGE TABLES gold.dim_payment_state__dbt_backup AND gold.dim_payment_state 
  
  ...
[0m18:36:44.712325 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:36:44.713741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */
EXCHANGE TABLES gold.dim_date__dbt_backup AND gold.dim_date 
  
  ...
[0m18:36:44.717216 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.717801 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.732667 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:36:44.741899 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.749699 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_method"
[0m18:36:44.764186 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:36:44.765556 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:36:44.771692 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.773528 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.786403 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    drop table if exists gold.dim_date__dbt_backup 
  ...
[0m18:36:44.789171 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    drop table if exists gold.dim_payment_state__dbt_backup 
  ...
[0m18:36:44.790807 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

  
    
    
    
        
        insert into gold.dim_payment_method__dbt_backup
        ("payment_method_sk", "original_value", "payment_method_name")


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
  
  ...
[0m18:36:44.794846 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.794238 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.799180 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (execute): 18:36:44.460144 => 18:36:44.798872
[0m18:36:44.799186 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (execute): 18:36:44.466228 => 18:36:44.798777
[0m18:36:44.801399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c6986e1-8c8c-4ec0-9a10-ac9521069d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941805a6a0>]}
[0m18:36:44.801409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '607429fa-dbab-4381-81dc-82e374b1a3f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767dfca587c0>]}
[0m18:36:44.803070 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_state ....................... [OK in 0.39s]
[0m18:36:44.803225 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_date ................................ [OK in 0.42s]
[0m18:36:44.805199 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_state
[0m18:36:44.805313 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_date
[0m18:36:44.807142 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.811337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:44.811817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:44.813811 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:36:44.814147 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:36:44.815014 [debug] [MainThread]: On list__gold: Close
[0m18:36:44.815168 [debug] [MainThread]: On list__silver: Close
[0m18:36:44.816266 [debug] [MainThread]: Connection 'model.ck_project.dim_date' was left open.
[0m18:36:44.816550 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_state' was left open.
[0m18:36:44.817259 [debug] [MainThread]: On model.ck_project.dim_date: Close
[0m18:36:44.818012 [debug] [MainThread]: On model.ck_project.dim_payment_state: Close
[0m18:36:44.818875 [info ] [MainThread]: 
[0m18:36:44.819524 [info ] [MainThread]: 
[0m18:36:44.820455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m18:36:44.821031 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */
EXCHANGE TABLES gold.dim_payment_method__dbt_backup AND gold.dim_payment_method 
  
  ...
[0m18:36:44.822568 [debug] [MainThread]: Command end result
[0m18:36:44.822100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m18:36:44.824488 [debug] [MainThread]: Command end result
[0m18:36:44.826681 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.856850 [info ] [MainThread]: 
[0m18:36:44.857924 [info ] [MainThread]: 
[0m18:36:44.859948 [info ] [MainThread]: Completed successfully
[0m18:36:44.860065 [info ] [MainThread]: Completed successfully
[0m18:36:44.862012 [info ] [MainThread]: 
[0m18:36:44.862044 [info ] [MainThread]: 
[0m18:36:44.864033 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:44.864204 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:44.865930 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:44.865667 after 3.85 seconds
[0m18:36:44.866137 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:44.865863 after 3.79 seconds
[0m18:36:44.867025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0ebef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767e0d11ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767dfcaa1f40>]}
[0m18:36:44.867225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941d69d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941ba19fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73941bb272e0>]}
[0m18:36:44.868200 [debug] [MainThread]: Flushing usage events
[0m18:36:44.868465 [debug] [MainThread]: Flushing usage events
[0m18:36:44.882330 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:36:44.889530 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:36:44.905856 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    drop table if exists gold.dim_payment_method__dbt_backup 
  ...
[0m18:36:44.911378 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:36:44.915332 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (execute): 18:36:44.575588 => 18:36:44.914994
[0m18:36:44.917260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1d9bd09-2325-4d8b-b1d2-42e9c07c347c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc42d5f10>]}
[0m18:36:44.918659 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_method ...................... [OK in 0.41s]
[0m18:36:44.920482 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_method
[0m18:36:44.924985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:44.926714 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:36:44.928601 [debug] [MainThread]: On list__gold: Close
[0m18:36:44.930369 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_method' was left open.
[0m18:36:44.931538 [debug] [MainThread]: On model.ck_project.dim_payment_method: Close
[0m18:36:44.932847 [info ] [MainThread]: 
[0m18:36:44.934226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m18:36:44.936323 [debug] [MainThread]: Command end result
[0m18:36:44.971692 [info ] [MainThread]: 
[0m18:36:44.973402 [info ] [MainThread]: Completed successfully
[0m18:36:44.974739 [info ] [MainThread]: 
[0m18:36:44.976804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:44.978540 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:44.978281 after 3.92 seconds
[0m18:36:44.980015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc9e2f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc832fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715cc80f5d00>]}
[0m18:36:44.981520 [debug] [MainThread]: Flushing usage events
[0m18:41:51.582628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df35943460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df363bcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df363bcdf0>]}


============================== 18:41:51.596506 | 439ddd32-f0b5-40bb-ae3f-ba773fd881c4 ==============================
[0m18:41:51.596506 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:41:51.600651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:41:51.778401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '439ddd32-f0b5-40bb-ae3f-ba773fd881c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df363bce50>]}
[0m18:41:51.821997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '439ddd32-f0b5-40bb-ae3f-ba773fd881c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df33e6feb0>]}
[0m18:41:51.824987 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:41:51.851149 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:41:51.866690 [debug] [MainThread]: Partial parsing not enabled
[0m18:41:54.194831 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:41:54.222388 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:41:54.233156 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:41:54.253967 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:41:54.259729 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:41:54.268211 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:41:54.275059 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:41:54.293768 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:41:54.298556 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:41:54.315078 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:41:54.320150 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:41:54.362326 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:41:54.369043 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:41:54.390625 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:41:54.806450 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:41:54.823194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '439ddd32-f0b5-40bb-ae3f-ba773fd881c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df33bf5ac0>]}
[0m18:41:54.877729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '439ddd32-f0b5-40bb-ae3f-ba773fd881c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df33bf5c10>]}
[0m18:41:54.880529 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:41:54.882726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439ddd32-f0b5-40bb-ae3f-ba773fd881c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df33bd1130>]}
[0m18:41:54.886481 [info ] [MainThread]: 
[0m18:41:54.889568 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:41:54.893680 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:41:54.906552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:55.259745 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:41:55.267635 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:41:55.273665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:41:55.275849 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:41:55.295571 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:41:55.305944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:55.338982 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:41:55.396000 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:41:55.407188 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:41:55.413612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439ddd32-f0b5-40bb-ae3f-ba773fd881c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df33ba3730>]}
[0m18:41:55.416677 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:41:55.418627 [info ] [MainThread]: 
[0m18:41:55.453331 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:41:55.455290 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:41:55.457412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:41:55.458542 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:41:55.476300 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:41:55.498001 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:41:55.459474 => 18:41:55.496907
[0m18:41:55.499962 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:41:55.541617 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:41:55.597884 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:41:55.605422 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:41:55.607904 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:41:55.500998 => 18:41:55.607400
[0m18:41:55.614750 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:41:55.616596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439ddd32-f0b5-40bb-ae3f-ba773fd881c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78def35fbe80>]}
[0m18:41:55.618445 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.16s]
[0m18:41:55.622212 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:41:55.628038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:55.629354 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:41:55.630493 [debug] [MainThread]: On list__silver: Close
[0m18:41:55.631813 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:41:55.633492 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:41:55.634797 [info ] [MainThread]: 
[0m18:41:55.636548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m18:41:55.639073 [debug] [MainThread]: Command end result
[0m18:41:55.679952 [info ] [MainThread]: 
[0m18:41:55.682464 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:41:55.684306 [info ] [MainThread]: 
[0m18:41:55.685804 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:41:55.686968 [error] [MainThread]:   Code: 81.
[0m18:41:55.688621 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:41:55.690288 [error] [MainThread]:   
[0m18:41:55.691446 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:41:55.693071 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:41:55.694235 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:41:55.695290 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:41:55.696330 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:41:55.698075 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:41:55.699620 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:41:55.700890 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:41:55.702054 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:41:55.703537 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:41:55.705060 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:41:55.706250 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:41:55.707407 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:41:55.708357 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:41:55.709356 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:41:55.710692 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:41:55.712079 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:41:55.714338 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:41:55.716299 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:41:55.717578 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:41:55.718942 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:41:55.720044 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:41:55.721108 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:41:55.722089 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:41:55.723196 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:41:55.724290 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:41:55.725443 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:41:55.726476 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:41:55.727455 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:41:55.728708 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:41:55.730052 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:41:55.731717 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:41:55.733128 [info ] [MainThread]: 
[0m18:41:55.734451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:41:55.736326 [debug] [MainThread]: Command `dbt run` failed at 18:41:55.736050 after 4.21 seconds
[0m18:41:55.737446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df35943460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df33e6feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78df33edca00>]}
[0m18:41:55.738531 [debug] [MainThread]: Flushing usage events
[0m18:47:02.871644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0ed1f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0f783fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0f783df0>]}


============================== 18:47:02.884918 | cdf8b0f6-470d-4b05-ba23-c8b223eb913e ==============================
[0m18:47:02.884918 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:47:02.886893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:03.066993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdf8b0f6-470d-4b05-ba23-c8b223eb913e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0f783e50>]}
[0m18:47:03.111132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdf8b0f6-470d-4b05-ba23-c8b223eb913e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0d224eb0>]}
[0m18:47:03.114064 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:47:03.141565 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:47:03.150957 [debug] [MainThread]: Partial parsing not enabled
[0m18:47:05.334970 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:47:05.357469 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:47:05.364287 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:47:05.376485 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:47:05.381708 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:47:05.390898 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:47:05.398387 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:47:05.418248 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:47:05.424578 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:47:05.443330 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:47:05.448141 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:47:05.486071 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:47:05.491552 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:47:05.508922 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:47:05.895997 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:47:05.911898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdf8b0f6-470d-4b05-ba23-c8b223eb913e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0cfb5ac0>]}
[0m18:47:05.959105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdf8b0f6-470d-4b05-ba23-c8b223eb913e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0cfb5c10>]}
[0m18:47:05.960492 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:05.962220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf8b0f6-470d-4b05-ba23-c8b223eb913e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0cf8d130>]}
[0m18:47:05.965532 [info ] [MainThread]: 
[0m18:47:05.969697 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:47:05.973635 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:47:05.984976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:06.301143 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:47:06.308054 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:06.314588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:47:06.316370 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:47:06.336369 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:47:06.340471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:06.354824 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:06.416858 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:47:06.456679 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:47:06.460959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdf8b0f6-470d-4b05-ba23-c8b223eb913e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bfd3edbe0>]}
[0m18:47:06.463774 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:06.465717 [info ] [MainThread]: 
[0m18:47:06.498002 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:47:06.500335 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:47:06.502987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_merchants)
[0m18:47:06.504197 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:47:06.522275 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:47:06.540942 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:47:06.504981 => 18:47:06.539900
[0m18:47:06.542381 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:47:06.580743 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:47:06.636331 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:47:06.645668 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:47:06.647999 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:47:06.543293 => 18:47:06.647336
[0m18:47:06.655943 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:47:06.657967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdf8b0f6-470d-4b05-ba23-c8b223eb913e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5bfc9b1820>]}
[0m18:47:06.659990 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.16s]
[0m18:47:06.662097 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:47:06.666972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:06.668825 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:47:06.669748 [debug] [MainThread]: On list__gold: Close
[0m18:47:06.670840 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:47:06.671936 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:47:06.673037 [info ] [MainThread]: 
[0m18:47:06.674501 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m18:47:06.676427 [debug] [MainThread]: Command end result
[0m18:47:06.720658 [info ] [MainThread]: 
[0m18:47:06.722542 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:47:06.723939 [info ] [MainThread]: 
[0m18:47:06.725375 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:47:06.726530 [error] [MainThread]:   Code: 81.
[0m18:47:06.727664 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:47:06.728787 [error] [MainThread]:   
[0m18:47:06.730329 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:47:06.731733 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:47:06.732853 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:47:06.733969 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:47:06.735661 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:47:06.737309 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:47:06.738453 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:47:06.739698 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:47:06.740778 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:47:06.741810 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:47:06.742848 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:47:06.743912 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:47:06.745282 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:47:06.746636 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:47:06.748577 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:47:06.749851 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:47:06.751118 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:47:06.752277 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:47:06.754156 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:47:06.755553 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:47:06.756783 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:47:06.757900 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:47:06.758933 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:47:06.760130 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:47:06.761442 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:47:06.762703 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:47:06.763757 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:47:06.765274 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:47:06.766625 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:47:06.768748 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:47:06.770373 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:47:06.771532 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:47:06.772627 [info ] [MainThread]: 
[0m18:47:06.773837 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:47:06.775502 [debug] [MainThread]: Command `dbt run` failed at 18:47:06.775200 after 3.95 seconds
[0m18:47:06.776843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0ed1f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0d224eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5c0d29ca00>]}
[0m18:47:06.777899 [debug] [MainThread]: Flushing usage events
[0m18:47:13.990263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb38d83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb4347d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb4347dc0>]}


============================== 18:47:14.002651 | 700754d2-3cfe-4f6b-8ab9-40530010706c ==============================
[0m18:47:14.002651 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:47:14.004510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:14.171737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '700754d2-3cfe-4f6b-8ab9-40530010706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb4347d90>]}
[0m18:47:14.185785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e925e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e9be8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e9be8df0>]}


============================== 18:47:14.198137 | 4401318e-53c7-4e82-acc7-356c8506e715 ==============================
[0m18:47:14.198137 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:47:14.200882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:14.213055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '700754d2-3cfe-4f6b-8ab9-40530010706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb1e30dc0>]}
[0m18:47:14.214839 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:47:14.239736 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:47:14.252291 [debug] [MainThread]: Partial parsing not enabled
[0m18:47:14.306643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e55331e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e553da0d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e553da0d90>]}


============================== 18:47:14.325002 | e71c2d12-df81-4df2-8aca-499d8e4a19fc ==============================
[0m18:47:14.325002 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:47:14.326614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:14.382191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4401318e-53c7-4e82-acc7-356c8506e715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e9be8dc0>]}
[0m18:47:14.442200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4401318e-53c7-4e82-acc7-356c8506e715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e7770df0>]}
[0m18:47:14.445058 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:47:14.444476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931821b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9318c72dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9318c83790>]}


============================== 18:47:14.461389 | 203971a1-5230-4543-8df1-6d6f41c38127 ==============================
[0m18:47:14.461389 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:47:14.463563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:47:14.477415 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:47:14.487147 [debug] [MainThread]: Partial parsing not enabled
[0m18:47:14.542945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e71c2d12-df81-4df2-8aca-499d8e4a19fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e553da0d60>]}
[0m18:47:14.592405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e71c2d12-df81-4df2-8aca-499d8e4a19fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e55186fd90>]}
[0m18:47:14.595343 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:47:14.623735 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:47:14.636005 [debug] [MainThread]: Partial parsing not enabled
[0m18:47:14.676734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '203971a1-5230-4543-8df1-6d6f41c38127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9318c72e20>]}
[0m18:47:14.734052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '203971a1-5230-4543-8df1-6d6f41c38127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9316722ee0>]}
[0m18:47:14.737504 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:47:14.762828 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:47:14.773254 [debug] [MainThread]: Partial parsing not enabled
[0m18:47:15.945410 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:47:15.958879 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:47:15.963015 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:47:15.971659 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:47:15.976410 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:47:15.982377 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:47:15.989569 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:47:16.008877 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:47:16.012409 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:47:16.022754 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:47:16.030038 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:47:16.034365 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:47:16.037594 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:47:16.040315 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:47:16.051129 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:47:16.054639 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:47:16.058770 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:47:16.063271 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:47:16.063932 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:47:16.066500 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:47:16.076795 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:47:16.079382 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:47:16.081351 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:47:16.093690 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:47:16.097410 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:47:16.125554 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:47:16.130004 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:47:16.140487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:47:16.161311 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:47:16.176896 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:47:16.180934 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:47:16.187694 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:47:16.191225 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:47:16.196753 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:47:16.202215 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:47:16.215202 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:47:16.219206 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:47:16.229433 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:47:16.233799 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:47:16.260659 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:47:16.264566 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:47:16.275511 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:47:16.320221 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:47:16.335630 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:47:16.340060 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:47:16.352035 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:47:16.355676 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:47:16.361331 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:47:16.366921 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:47:16.385617 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:47:16.390031 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:47:16.392099 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:47:16.402214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '700754d2-3cfe-4f6b-8ab9-40530010706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb1bdfa00>]}
[0m18:47:16.407069 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:47:16.412362 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:47:16.441210 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:47:16.445948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '700754d2-3cfe-4f6b-8ab9-40530010706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb1bdfb50>]}
[0m18:47:16.447272 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:16.448797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700754d2-3cfe-4f6b-8ab9-40530010706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb1e9cf70>]}
[0m18:47:16.451839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4401318e-53c7-4e82-acc7-356c8506e715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e7524a30>]}
[0m18:47:16.452321 [info ] [MainThread]: 
[0m18:47:16.453749 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:47:16.454452 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:47:16.458153 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:47:16.458877 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:47:16.468771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:16.475447 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:47:16.497336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4401318e-53c7-4e82-acc7-356c8506e715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e7524b80>]}
[0m18:47:16.500436 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:16.502484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4401318e-53c7-4e82-acc7-356c8506e715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e77dc730>]}
[0m18:47:16.505381 [info ] [MainThread]: 
[0m18:47:16.507224 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:47:16.509501 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:47:16.521342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:16.626234 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:47:16.640343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e71c2d12-df81-4df2-8aca-499d8e4a19fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e55159b9d0>]}
[0m18:47:16.679666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e71c2d12-df81-4df2-8aca-499d8e4a19fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e55159bb20>]}
[0m18:47:16.681709 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:16.683415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e71c2d12-df81-4df2-8aca-499d8e4a19fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e5518da6d0>]}
[0m18:47:16.686382 [info ] [MainThread]: 
[0m18:47:16.688345 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:47:16.690756 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:47:16.698935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:16.792316 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:47:16.797736 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:16.805195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:47:16.807653 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:47:16.831000 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:47:16.826883 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:47:16.833247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:16.843767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '203971a1-5230-4543-8df1-6d6f41c38127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93164dfaf0>]}
[0m18:47:16.871692 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m18:47:16.884263 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:47:16.889691 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:16.895121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '203971a1-5230-4543-8df1-6d6f41c38127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93164dfc40>]}
[0m18:47:16.897063 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:47:16.897453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__gold)
[0m18:47:16.898458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '203971a1-5230-4543-8df1-6d6f41c38127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931679c7f0>]}
[0m18:47:16.901553 [info ] [MainThread]: 
[0m18:47:16.903561 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:47:16.905255 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__silver'
[0m18:47:16.907096 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:47:16.918504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:16.920528 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:47:16.919432 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:47:16.927271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:16.931236 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:16.936716 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:16.936957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '700754d2-3cfe-4f6b-8ab9-40530010706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb1b63670>]}
[0m18:47:16.938627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:16.940134 [info ] [MainThread]: 
[0m18:47:16.976369 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:47:16.978397 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:47:16.980415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:47:16.981777 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:47:17.001304 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:47:17.006613 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:47:17.022892 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:47:16.982714 => 18:47:17.022271
[0m18:47:17.024361 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:47:17.029364 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:47:17.033965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4401318e-53c7-4e82-acc7-356c8506e715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e4369b80>]}
[0m18:47:17.035905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:17.037147 [info ] [MainThread]: 
[0m18:47:17.064214 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:47:17.064642 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:47:17.071937 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_state
[0m18:47:17.072212 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.073626 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_state ............................ [RUN]
[0m18:47:17.075255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__silver, now model.ck_project.dim_payment_state)
[0m18:47:17.076350 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_state
[0m18:47:17.078058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:47:17.080289 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:47:17.093485 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_state"
[0m18:47:17.100720 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:47:17.105948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:17.117197 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (compile): 18:47:17.077189 => 18:47:17.116478
[0m18:47:17.118576 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_state
[0m18:47:17.127554 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:47:17.130058 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:47:17.138251 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:47:17.141309 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:47:17.025457 => 18:47:17.140475
[0m18:47:17.147441 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:47:17.149879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '700754d2-3cfe-4f6b-8ab9-40530010706c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bb8958ea90>]}
[0m18:47:17.152147 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.17s]
[0m18:47:17.154723 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:47:17.159727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:17.161207 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:47:17.162351 [debug] [MainThread]: On list__silver: Close
[0m18:47:17.163550 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:47:17.164579 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:47:17.165754 [info ] [MainThread]: 
[0m18:47:17.167420 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m18:47:17.169087 [debug] [MainThread]: Command end result
[0m18:47:17.184542 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:47:17.195526 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.201496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e71c2d12-df81-4df2-8aca-499d8e4a19fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e551618640>]}
[0m18:47:17.203712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:17.205085 [info ] [MainThread]: 
[0m18:47:17.211207 [info ] [MainThread]: 
[0m18:47:17.213257 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:47:17.214497 [info ] [MainThread]: 
[0m18:47:17.215744 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:47:17.217284 [error] [MainThread]:   Code: 81.
[0m18:47:17.218547 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:47:17.219909 [error] [MainThread]:   
[0m18:47:17.221468 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:47:17.223140 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:47:17.224266 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:47:17.225341 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:47:17.226461 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:47:17.227594 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

            

    
        create table gold.dim_payment_state__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_state_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
          )
        ...
[0m18:47:17.228018 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:47:17.229366 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:47:17.230823 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:47:17.232537 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:47:17.234386 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:47:17.235684 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:47:17.236847 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:47:17.237946 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:47:17.239049 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:47:17.241037 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:47:17.242630 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:47:17.243241 [debug] [Thread-1  ]: Began running node model.ck_project.dim_payment_method
[0m18:47:17.244197 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:47:17.244937 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_payment_method ........................... [RUN]
[0m18:47:17.245440 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:47:17.246906 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:47:17.248439 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:47:17.247795 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_payment_method)
[0m18:47:17.249634 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:47:17.250100 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:47:17.250297 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_payment_method
[0m18:47:17.251130 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:47:17.252460 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:47:17.253497 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:47:17.254571 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:47:17.255574 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:47:17.256604 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:47:17.257513 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:47:17.258386 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:47:17.259792 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:47:17.261030 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:47:17.262168 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:47:17.263467 [info ] [MainThread]: 
[0m18:47:17.264604 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:47:17.267288 [debug] [MainThread]: Command `dbt run` failed at 18:47:17.266973 after 3.31 seconds
[0m18:47:17.267048 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_payment_method"
[0m18:47:17.268722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb38d83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb1e30dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72bbb1bf5d00>]}
[0m18:47:17.268839 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:47:17.270214 [debug] [MainThread]: Flushing usage events
[0m18:47:17.276063 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:47:17.277396 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.284882 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.286945 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_state"
[0m18:47:17.287942 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (compile): 18:47:17.251432 => 18:47:17.287387
[0m18:47:17.289114 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_payment_method
[0m18:47:17.291386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:47:17.293714 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:47:17.307292 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

  
    
    
    
        
        insert into gold.dim_payment_state__dbt_backup
        ("payment_state_sk", "payment_state_name", "is_final_state", "is_payment_reached_provider")

WITH st AS (
    SELECT toUInt8(1) AS payment_state_sk, 'settled'          AS payment_state_name, 1 AS is_final_state, 1 AS is_payment_reached_provider
    UNION ALL SELECT 2, 'initial',         0, 0
    UNION ALL SELECT 3, 'failed',          1, 1
    UNION ALL SELECT 4, 'voided',          1, 1
    UNION ALL SELECT 5, 'refunded',        1, 1
    UNION ALL SELECT 6, 'waiting_for_sca', 0, 0
)
SELECT
  payment_state_sk::UInt8                 AS payment_state_sk,
  payment_state_name::String              AS payment_state_name,
  is_final_state::UInt8                   AS is_final_state,
  is_payment_reached_provider::UInt8      AS is_payment_reached_provider
FROM st
  
  ...
[0m18:47:17.314295 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:47:17.318490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:17.331227 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m18:47:17.342265 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */
EXCHANGE TABLES gold.dim_payment_state__dbt_backup AND gold.dim_payment_state 
  
  ...
[0m18:47:17.347305 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:47:17.347656 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.394708 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    select name, type from system.columns where table = 'dim_payment_state'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:47:17.401338 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:47:17.401873 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.404806 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

            

    
        create table gold.dim_payment_method__dbt_backup
        
  
        
  engine = MergeTree()
        order by (payment_method_sk)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
          )
        ...
[0m18:47:17.410070 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.416407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '203971a1-5230-4543-8df1-6d6f41c38127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9316463760>]}
[0m18:47:17.417005 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_state: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_state"} */

    drop table if exists gold.dim_payment_state__dbt_backup 
  ...
[0m18:47:17.418743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:17.419958 [info ] [MainThread]: 
[0m18:47:17.421238 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.421606 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.425642 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_state (execute): 18:47:17.119704 => 18:47:17.425320
[0m18:47:17.427611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4401318e-53c7-4e82-acc7-356c8506e715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e411b610>]}
[0m18:47:17.429584 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_state ....................... [OK in 0.35s]
[0m18:47:17.431309 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_state
[0m18:47:17.437141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:17.438596 [debug] [MainThread]: Connection 'list__gold' was left open.
[0m18:47:17.439772 [debug] [MainThread]: On list__gold: Close
[0m18:47:17.440283 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:47:17.441076 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_state' was left open.
[0m18:47:17.442498 [debug] [MainThread]: On model.ck_project.dim_payment_state: Close
[0m18:47:17.443827 [info ] [MainThread]: 
[0m18:47:17.445133 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m18:47:17.446838 [debug] [MainThread]: Command end result
[0m18:47:17.448553 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.453910 [debug] [Thread-1  ]: Began running node model.ck_project.dim_date
[0m18:47:17.455390 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_date ..................................... [RUN]
[0m18:47:17.455828 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_payment_method"
[0m18:47:17.457410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_date)
[0m18:47:17.458369 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_date
[0m18:47:17.473115 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

  
    
    
    
        
        insert into gold.dim_payment_method__dbt_backup
        ("payment_method_sk", "original_value", "payment_method_name")


WITH mapping AS (
    SELECT toUInt8(1) AS payment_method_sk, CAST('1' AS Nullable(String)) AS original_value, 'Visa'         AS payment_method_name
    UNION ALL
    SELECT toUInt8(2),                       CAST('2' AS Nullable(String)),                                   'Mastercard'
    UNION ALL
    SELECT toUInt8(3),                       CAST(NULL AS Nullable(String)),                                  'ACH transfer'
)
SELECT * FROM mapping
  
  ...
[0m18:47:17.475713 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_date"
[0m18:47:17.486317 [info ] [MainThread]: 
[0m18:47:17.488278 [info ] [MainThread]: Completed successfully
[0m18:47:17.489131 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.490087 [info ] [MainThread]: 
[0m18:47:17.491707 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:47:17.493549 [debug] [MainThread]: Command `dbt run` succeeded at 18:47:17.493269 after 3.49 seconds
[0m18:47:17.494763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e925e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e7770df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7366e42c5760>]}
[0m18:47:17.494950 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (compile): 18:47:17.459040 => 18:47:17.494127
[0m18:47:17.496269 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_date
[0m18:47:17.496385 [debug] [MainThread]: Flushing usage events
[0m18:47:17.501406 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */
EXCHANGE TABLES gold.dim_payment_method__dbt_backup AND gold.dim_payment_method 
  
  ...
[0m18:47:17.507001 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.547350 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    select name, type from system.columns where table = 'dim_payment_method'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:47:17.556681 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.573584 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_payment_method: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_payment_method"} */

    drop table if exists gold.dim_payment_method__dbt_backup 
  ...
[0m18:47:17.580185 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.585476 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_payment_method (execute): 18:47:17.289973 => 18:47:17.585097
[0m18:47:17.587930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e71c2d12-df81-4df2-8aca-499d8e4a19fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e530f9bf10>]}
[0m18:47:17.589784 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_payment_method ...................... [OK in 0.34s]
[0m18:47:17.592237 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_payment_method
[0m18:47:17.598251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:17.600078 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:47:17.601575 [debug] [MainThread]: On list__silver: Close
[0m18:47:17.602624 [debug] [MainThread]: Connection 'model.ck_project.dim_payment_method' was left open.
[0m18:47:17.603515 [debug] [MainThread]: On model.ck_project.dim_payment_method: Close
[0m18:47:17.604918 [info ] [MainThread]: 
[0m18:47:17.606199 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m18:47:17.606435 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

            

    
        create table gold.dim_date__dbt_backup
        
  
        
  engine = MergeTree()
        order by (date_key)
        
        
        SETTINGS  replicated_deduplication_window=0

            empty
          as (
            

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
          )
        ...
[0m18:47:17.607883 [debug] [MainThread]: Command end result
[0m18:47:17.622443 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.648952 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date__dbt_backup'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:47:17.658432 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.660441 [info ] [MainThread]: 
[0m18:47:17.662061 [info ] [MainThread]: Completed successfully
[0m18:47:17.663411 [info ] [MainThread]: 
[0m18:47:17.664648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:47:17.666274 [debug] [MainThread]: Command `dbt run` succeeded at 18:47:17.666049 after 3.67 seconds
[0m18:47:17.667228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e55331e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e5516b5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e55171b040>]}
[0m18:47:17.667212 [debug] [Thread-1  ]: Writing runtime sql for node "model.ck_project.dim_date"
[0m18:47:17.668308 [debug] [MainThread]: Flushing usage events
[0m18:47:17.693187 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

  
    
    
    
        
        insert into gold.dim_date__dbt_backup
        ("date_key", "full_date", "year", "month", "day", "day_of_week", "is_weekend", "is_holiday")

-- Generate dates from start..end using system.numbers.
-- IMPORTANT: use single-quoted literals from Jinja vars (no tojson).
WITH
  toDate('2000-01-01') AS sd,
  toDate('2040-12-31') AS ed
SELECT
  toUInt32(toYYYYMMDD(d))           AS date_key,
  d                                 AS full_date,
  toYear(d)                         AS year,
  toMonth(d)                        AS month,
  toDayOfMonth(d)                   AS day,
  toDayOfWeek(d)                    AS day_of_week,   -- 1=Mon..7=Sun
  toUInt8(toDayOfWeek(d) IN (6,7))  AS is_weekend,
  toUInt8(0)                        AS is_holiday
FROM
(
  SELECT addDays(sd, number) AS d
  FROM system.numbers
  LIMIT dateDiff('day', sd, ed) + 1
)
ORDER BY date_key
  
  ...
[0m18:47:17.710035 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.721479 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */
EXCHANGE TABLES gold.dim_date__dbt_backup AND gold.dim_date 
  
  ...
[0m18:47:17.726475 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.770552 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    select name, type from system.columns where table = 'dim_date'
    
      and database = 'gold'
    
    order by position
  ...
[0m18:47:17.779047 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:47:17.793961 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_date: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_date"} */

    drop table if exists gold.dim_date__dbt_backup 
  ...
[0m18:47:17.799166 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:47:17.803891 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_date (execute): 18:47:17.497131 => 18:47:17.803527
[0m18:47:17.806200 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '203971a1-5230-4543-8df1-6d6f41c38127', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9305ea2e50>]}
[0m18:47:17.808113 [info ] [Thread-1  ]: 1 of 1 OK created sql table model gold.dim_date ................................ [OK in 0.35s]
[0m18:47:17.810157 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_date
[0m18:47:17.815374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:17.818468 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:47:17.819958 [debug] [MainThread]: On list__silver: Close
[0m18:47:17.821209 [debug] [MainThread]: Connection 'model.ck_project.dim_date' was left open.
[0m18:47:17.822066 [debug] [MainThread]: On model.ck_project.dim_date: Close
[0m18:47:17.824759 [info ] [MainThread]: 
[0m18:47:17.826230 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m18:47:17.828393 [debug] [MainThread]: Command end result
[0m18:47:17.871280 [info ] [MainThread]: 
[0m18:47:17.872769 [info ] [MainThread]: Completed successfully
[0m18:47:17.873811 [info ] [MainThread]: 
[0m18:47:17.874855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:47:17.876392 [debug] [MainThread]: Command `dbt run` succeeded at 18:47:17.876149 after 3.86 seconds
[0m18:47:17.877527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931821b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9316722ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f931646c220>]}
[0m18:47:17.878644 [debug] [MainThread]: Flushing usage events
[0m18:52:23.581938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7977748af3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7977752e3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7977752e3df0>]}


============================== 18:52:23.593758 | adb527bf-5680-4844-bdc0-6bb83b299c47 ==============================
[0m18:52:23.593758 [info ] [MainThread]: Running with dbt=1.5.9
[0m18:52:23.595542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:52:23.770315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adb527bf-5680-4844-bdc0-6bb83b299c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7977752e3dc0>]}
[0m18:52:23.805549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adb527bf-5680-4844-bdc0-6bb83b299c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797772d9bdf0>]}
[0m18:52:23.807941 [info ] [MainThread]: Registered adapter: clickhouse=1.5.2
[0m18:52:23.833429 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m18:52:23.842384 [debug] [MainThread]: Partial parsing not enabled
[0m18:52:25.592018 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_date.sql
[0m18:52:25.609265 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_date.sql
[0m18:52:25.614129 [debug] [MainThread]: 1603: static parser failed on gold/dim/dim_merchants.sql
[0m18:52:25.623729 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/dim/dim_merchants.sql
[0m18:52:25.629164 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_method.sql
[0m18:52:25.636743 [debug] [MainThread]: 1699: static parser successfully parsed gold/dim/dim_payment_state.sql
[0m18:52:25.643418 [debug] [MainThread]: 1603: static parser failed on gold/fact/fact_transactions.sql
[0m18:52:25.662070 [debug] [MainThread]: 1602: parser fallback to jinja rendering on gold/fact/fact_transactions.sql
[0m18:52:25.667969 [debug] [MainThread]: 1603: static parser failed on silver/silver_link_transactions.sql
[0m18:52:25.683731 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_link_transactions.sql
[0m18:52:25.689515 [debug] [MainThread]: 1603: static parser failed on silver/silver_merchants.sql
[0m18:52:25.730684 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_merchants.sql
[0m18:52:25.736647 [debug] [MainThread]: 1603: static parser failed on silver/silver_payments.sql
[0m18:52:25.758151 [debug] [MainThread]: 1602: parser fallback to jinja rendering on silver/silver_payments.sql
[0m18:52:26.153645 [warn ] [MainThread]: [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ck_project.bronze
[0m18:52:26.165345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adb527bf-5680-4844-bdc0-6bb83b299c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797772b42a30>]}
[0m18:52:26.208129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adb527bf-5680-4844-bdc0-6bb83b299c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797772b42b80>]}
[0m18:52:26.209707 [info ] [MainThread]: Found 8 models, 20 tests, 0 snapshots, 0 analyses, 349 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m18:52:26.211153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adb527bf-5680-4844-bdc0-6bb83b299c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797772e1c730>]}
[0m18:52:26.214942 [info ] [MainThread]: 
[0m18:52:26.217348 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:52:26.220242 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:52:26.230860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:26.550389 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:52:26.557237 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:52:26.564404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__silver)
[0m18:52:26.566363 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__gold'
[0m18:52:26.586703 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__silver: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__silver"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'silver'
      

  ...
[0m18:52:26.592085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:26.623966 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m18:52:26.669406 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__gold: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "connection_name": "list__gold"} */
select
      t.name as name,
      t.database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'gold'
      

  ...
[0m18:52:26.678402 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:52:26.684920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adb527bf-5680-4844-bdc0-6bb83b299c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797772ae36a0>]}
[0m18:52:26.686810 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:26.688082 [info ] [MainThread]: 
[0m18:52:26.725001 [debug] [Thread-1  ]: Began running node model.ck_project.dim_merchants
[0m18:52:26.727110 [info ] [Thread-1  ]: 1 of 1 START sql table model gold.dim_merchants ................................ [RUN]
[0m18:52:26.729234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__gold, now model.ck_project.dim_merchants)
[0m18:52:26.730397 [debug] [Thread-1  ]: Began compiling node model.ck_project.dim_merchants
[0m18:52:26.751437 [debug] [Thread-1  ]: Writing injected SQL for node "model.ck_project.dim_merchants"
[0m18:52:26.770532 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (compile): 18:52:26.731616 => 18:52:26.769762
[0m18:52:26.771813 [debug] [Thread-1  ]: Began executing node model.ck_project.dim_merchants
[0m18:52:26.816454 [debug] [Thread-1  ]: Creating new relation dim_merchants
[0m18:52:26.876542 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ck_project.dim_merchants: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        ...
[0m18:52:26.884026 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "ck_project", "target_name": "dev", "node_id": "model.ck_project.dim_merchants"} */

            

    
        create table gold.dim_merchants
        
  
        
  engine = MergeTree()
        order by (merchant_sk)
        
        
        SETTINGS  allow_nullable_key=1,  replicated_deduplication_window=0

            empty
          as (
            

-- Build a current (Type-0/1 style) merchant dimension from Silver.
-- We pick the latest attributes per merchant_id using argMax over a timestamp that
-- prefers updated_at, falling back to _snapshot_date.

WITH staged AS (
  SELECT
      merchant_id,
      merchant_name,
      state                     AS merchant_state,
      acquirer_id,
      updated_at,
      _snapshot_date,
      coalesce(updated_at, toDateTime(_snapshot_date)) AS ts
  FROM silver.merchants     -- <-- use your silver MODEL NAME here
  WHERE merchant_id IS NOT NULL
),

agg AS (
  SELECT
      toUInt64(merchant_id)                                              AS merchant_id,
      argMax(merchant_name,   ts)                                        AS merchant_name,
      argMax(merchant_state,  ts)                                        AS merchant_state,
      argMax(acquirer_id,     ts)                                        AS acquirer_id,
      max(ts)                                                            AS scd_start_ts,
      argMax(updated_at,      ts)                                        AS updated_at_raw
  FROM staged
  GROUP BY merchant_id
)

SELECT
    cityHash64(merchant_id)               AS merchant_sk,        
    merchant_id,
    merchant_name,
    merchant_state,
    acquirer_id,
    toDate(scd_start_ts)                  AS scd_start_date,    
    toDate('9999-12-31')                  AS scd_end_date,
    updated_at_raw
FROM agg
ORDER BY merchant_sk
          )
        
[0m18:52:26.886314 [debug] [Thread-1  ]: Timing info for model.ck_project.dim_merchants (execute): 18:52:26.772527 => 18:52:26.885777
[0m18:52:26.891684 [debug] [Thread-1  ]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
  Code: 81.
  DB::Exception: Database silver does not exist. Stack trace:
  
  0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
  1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
  2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
  3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
  4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
  5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
  6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
  7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
  8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
  9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
  13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
  14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
  15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
  16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
  17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
  18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
  19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
  20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
  21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
  22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
  23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
  24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
  25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
  26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
  27. DB::TCPHandler::run() @ 0x0000000019e4f119
  28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
  29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
  30. Poco::PooledThread::run() @ 0x000000001ef15b87
  31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:52:26.910602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adb527bf-5680-4844-bdc0-6bb83b299c47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797762744cd0>]}
[0m18:52:26.912567 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model gold.dim_merchants ....................... [ERROR in 0.18s]
[0m18:52:26.915207 [debug] [Thread-1  ]: Finished running node model.ck_project.dim_merchants
[0m18:52:26.921946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:26.923168 [debug] [MainThread]: Connection 'list__silver' was left open.
[0m18:52:26.924803 [debug] [MainThread]: On list__silver: Close
[0m18:52:26.926190 [debug] [MainThread]: Connection 'model.ck_project.dim_merchants' was left open.
[0m18:52:26.927469 [debug] [MainThread]: On model.ck_project.dim_merchants: Close
[0m18:52:26.928596 [info ] [MainThread]: 
[0m18:52:26.930445 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m18:52:26.933146 [debug] [MainThread]: Command end result
[0m18:52:26.985767 [info ] [MainThread]: 
[0m18:52:26.989402 [info ] [MainThread]: Completed with 1 error and 0 warnings:
[0m18:52:26.990792 [info ] [MainThread]: 
[0m18:52:26.992529 [error] [MainThread]: Database Error in model dim_merchants (models/gold/dim/dim_merchants.sql)
[0m18:52:26.993805 [error] [MainThread]:   Code: 81.
[0m18:52:26.995430 [error] [MainThread]:   DB::Exception: Database silver does not exist. Stack trace:
[0m18:52:26.996467 [error] [MainThread]:   
[0m18:52:26.998423 [error] [MainThread]:   0. DB::Exception::Exception(DB::Exception::MessageMasked&&, int, bool) @ 0x00000000137a855f
[0m18:52:26.999935 [error] [MainThread]:   1. DB::Exception::Exception(String&&, int, String, bool) @ 0x000000000cae7e8e
[0m18:52:27.004421 [error] [MainThread]:   2. DB::Exception::Exception(PreformattedMessage&&, int) @ 0x000000000cae7940
[0m18:52:27.006144 [error] [MainThread]:   3. DB::Exception::Exception<String>(int, FormatStringHelperImpl<std::type_identity<String>::type>, String&&) @ 0x000000000cae74ab
[0m18:52:27.007903 [error] [MainThread]:   4. DB::DatabaseCatalog::getDatabase(String const&) const @ 0x00000000181f2a4a
[0m18:52:27.009238 [error] [MainThread]:   5. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x0000000018109f71
[0m18:52:27.010426 [error] [MainThread]:   6. DB::IdentifierResolver::tryResolveTableIdentifier(DB::Identifier const&, std::shared_ptr<DB::Context const> const&) @ 0x0000000017a91618
[0m18:52:27.011758 [error] [MainThread]:   7. DB::QueryAnalyzer::tryResolveIdentifier(DB::IdentifierLookup const&, DB::IdentifierResolveScope&, DB::IdentifierResolveContext) @ 0x000000001784563c
[0m18:52:27.013029 [error] [MainThread]:   8. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782bebb
[0m18:52:27.014727 [error] [MainThread]:   9. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:52:27.016153 [error] [MainThread]:   10. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:52:27.017682 [error] [MainThread]:   11. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:52:27.019072 [error] [MainThread]:   12. DB::QueryAnalyzer::resolveExpressionNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, bool, bool, bool) @ 0x0000000017837221
[0m18:52:27.020373 [error] [MainThread]:   13. DB::QueryAnalyzer::resolveQueryJoinTreeNode(std::shared_ptr<DB::IQueryTreeNode>&, DB::IdentifierResolveScope&, DB::QueryExpressionsAliasVisitor&) @ 0x000000001785ae58
[0m18:52:27.021733 [error] [MainThread]:   14. DB::QueryAnalyzer::resolveQuery(std::shared_ptr<DB::IQueryTreeNode> const&, DB::IdentifierResolveScope&) @ 0x000000001782d021
[0m18:52:27.023077 [error] [MainThread]:   15. DB::QueryAnalyzer::resolve(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::IQueryTreeNode> const&, std::shared_ptr<DB::Context const>) @ 0x000000001782a87a
[0m18:52:27.024276 [error] [MainThread]:   16. DB::QueryAnalysisPass::run(std::shared_ptr<DB::IQueryTreeNode>&, std::shared_ptr<DB::Context const>) @ 0x0000000017829edc
[0m18:52:27.025523 [error] [MainThread]:   17. DB::QueryTreePassManager::run(std::shared_ptr<DB::IQueryTreeNode>) @ 0x000000001787d276
[0m18:52:27.026623 [error] [MainThread]:   18. DB::buildQueryTreeAndRunPasses(std::shared_ptr<DB::IAST> const&, DB::SelectQueryOptions const&, std::shared_ptr<DB::Context const> const&, std::shared_ptr<DB::IStorage> const&) (.llvm.8096503222789336007) @ 0x00000000183bd40d
[0m18:52:27.027822 [error] [MainThread]:   19. DB::InterpreterSelectQueryAnalyzer::InterpreterSelectQueryAnalyzer(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&, std::vector<String, std::allocator<String>> const&) @ 0x00000000183bb32a
[0m18:52:27.028943 [error] [MainThread]:   20. DB::InterpreterSelectQueryAnalyzer::getSampleBlock(std::shared_ptr<DB::IAST> const&, std::shared_ptr<DB::Context const> const&, DB::SelectQueryOptions const&) @ 0x00000000183bd86a
[0m18:52:27.030041 [error] [MainThread]:   21. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&, DB::LoadingStrictnessLevel) const @ 0x00000000182e49d3
[0m18:52:27.031059 [error] [MainThread]:   22. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x00000000182ed2c5
[0m18:52:27.032319 [error] [MainThread]:   23. DB::InterpreterCreateQuery::execute() @ 0x0000000018303978
[0m18:52:27.033625 [error] [MainThread]:   24. DB::executeQueryImpl(char const*, char const*, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum, std::unique_ptr<DB::ReadBuffer, std::default_delete<DB::ReadBuffer>>&, std::shared_ptr<DB::IAST>&, std::shared_ptr<DB::ImplicitTransactionControlExecutor>) @ 0x0000000018780440
[0m18:52:27.034812 [error] [MainThread]:   25. DB::executeQuery(String const&, std::shared_ptr<DB::Context>, DB::QueryFlags, DB::QueryProcessingStage::Enum) @ 0x00000000187786cb
[0m18:52:27.035860 [error] [MainThread]:   26. DB::TCPHandler::runImpl() @ 0x0000000019e2d3db
[0m18:52:27.036902 [error] [MainThread]:   27. DB::TCPHandler::run() @ 0x0000000019e4f119
[0m18:52:27.038010 [error] [MainThread]:   28. Poco::Net::TCPServerConnection::start() @ 0x000000001ef4ed07
[0m18:52:27.039115 [error] [MainThread]:   29. Poco::Net::TCPServerDispatcher::run() @ 0x000000001ef4f199
[0m18:52:27.040095 [error] [MainThread]:   30. Poco::PooledThread::run() @ 0x000000001ef15b87
[0m18:52:27.041236 [error] [MainThread]:   31. Poco::ThreadImpl::runnableEntry(void*) @ 0x000000001ef13f81
[0m18:52:27.042359 [info ] [MainThread]: 
[0m18:52:27.043533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:52:27.045093 [debug] [MainThread]: Command `dbt run` failed at 18:52:27.044882 after 3.51 seconds
[0m18:52:27.046178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7977748af3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797772d9bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797762721bb0>]}
[0m18:52:27.047136 [debug] [MainThread]: Flushing usage events
